UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu;window.UE=baidu.editor={};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE.version="1.2.5.0";var dom=UE.dom={};var browser=UE.browser=function(){var d=navigator.userAgent.toLowerCase(),b=window.opera,c={ie:!!window.ActiveXObject,opera:(!!b&&b.version),webkit:(d.indexOf(" applewebkit/")>-1),mac:(d.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};c.gecko=(navigator.product=="Gecko"&&!c.webkit&&!c.opera);var a=0;if(c.ie){a=parseFloat(d.match(/msie (\d+)/)[1]);c.ie9Compat=document.documentMode==9;c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode==8;c.ie7Compat=((a==7&&!document.documentMode)||document.documentMode==7);c.ie6Compat=(a<7||c.quirks)}if(c.gecko){var e=d.match(/rv:([\d\.]+)/);if(e){e=e[1].split(".");a=e[0]*10000+(e[1]||0)*100+(e[2]||0)*1}}if(/chrome\/(\d+\.\d)/i.test(d)){c.chrome=+RegExp["\x241"]}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(d)&&!/chrome/i.test(d)){c.safari=+(RegExp["\x241"]||RegExp["\x242"])}if(c.opera){a=parseFloat(b.version())}if(c.webkit){a=parseFloat(d.match(/ applewebkit\/(\d+)/)[1])}c.version=a;c.isCompatible=!c.mobile&&((c.ie&&a>=6)||(c.gecko&&a>=10801)||(c.opera&&a>=9.5)||(c.air&&a>=1)||(c.webkit&&a>=522)||false);return c}();var ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera;var utils=UE.utils={each:function(f,e,d){if(f==null){return}if(f.length===+f.length){for(var c=0,a=f.length;c<a;c++){if(e.call(d,f[c],c,f)===false){return false}}}else{for(var b in f){if(f.hasOwnProperty(b)){if(e.call(d,f[b],b,f)===false){return false}}}}},makeInstance:function(b){var a=new Function();a.prototype=b;b=new a;a.prototype=null;return b},extend:function(d,e,a){if(e){for(var c in e){if(!a||!d.hasOwnProperty(c)){d[c]=e[c]}}}return d},inherits:function(d,b){var a=d.prototype,c=utils.makeInstance(b.prototype);utils.extend(c,a,true);d.prototype=c;return(c.constructor=d)},bind:function(b,a){return function(){return b.apply(a,arguments)}},defer:function(b,a,c){var d;return function(){if(c){clearTimeout(d)}d=setTimeout(b,a)}},indexOf:function(d,b,c){var a=-1;c=this.isNumber(c)?c:0;this.each(d,function(e,f){if(f>=c&&e===b){a=f;return false}});return a},removeItem:function(d,c){for(var b=0,a=d.length;b<a;b++){if(d[b]===c){d.splice(b,1);b--}}},trim:function(a){return a.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(c){if(!c){return{}}c=utils.isArray(c)?c:c.split(",");for(var b=0,a,d={};a=c[b++];){d[a.toUpperCase()]=d[a]=1}return d},unhtml:function(b,a){return b?b.replace(a||/[&<">]/g,function(c){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;"}[c]}):""},html:function(a){return a?a.replace(/&((g|l|quo)t|amp);/g,function(b){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">"}[b]}):""},cssStyleToDomStyle:function(){var b=document.createElement("div").style,a={"float":b.cssFloat!=undefined?"cssFloat":b.styleFloat!=undefined?"styleFloat":"float"};return function(c){return a[c]||(a[c]=c.toLowerCase().replace(/-./g,function(d){return d.charAt(1).toUpperCase()}))}}(),loadFile:function(){var a=[];function b(h,g){try{for(var d=0,c;c=a[d++];){if(c.doc===h&&c.url==(g.src||g.href)){return c}}}catch(f){return null}}return function(i,h,e){var f=b(i,h);if(f){if(f.ready){e&&e()}else{f.funs.push(e)}return}a.push({doc:i,url:h.src||h.href,funs:[e]});if(!i.body){var d=[];for(var g in h){if(g=="tag"){continue}d.push(g+'="'+h[g]+'"')}i.write("<"+h.tag+" "+d.join(" ")+" ></"+h.tag+">");return}if(h.id&&i.getElementById(h.id)){return}var c=i.createElement(h.tag);delete h.tag;for(var g in h){c.setAttribute(g,h[g])}c.onload=c.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){f=b(i,h);if(f.funs.length>0){f.ready=1;for(var j;j=f.funs.pop();){j()}}c.onload=c.onreadystatechange=null}};c.onerror=function(){throw Error("The load "+(h.href||h.src)+" fails,check the url settings of file editor_config.js ")};i.getElementsByTagName("head")[0].appendChild(c)}}(),isEmptyObject:function(b){if(b==null){return true}if(this.isArray(b)||this.isString(b)){return b.length===0}for(var a in b){if(b.hasOwnProperty(a)){return false}}return true},fixColor:function(b,d){if(/color/i.test(b)&&/rgba?/.test(d)){var e=d.split(",");if(e.length>3){return""}d="#";for(var c=0,a;a=e[c++];){a=parseInt(a.replace(/[^\d]/gi,""),10).toString(16);d+=a.length==1?"0"+a:a}d=d.toUpperCase()}return d},optCss:function(e){var d,c,a;e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(i,g,f,h){if(h.split(" ").length==1){switch(g){case"padding":!d&&(d={});d[f]=h;return"";case"margin":!c&&(c={});c[f]=h;return"";case"border":return h=="initial"?"":i}}return i});function b(m,h){if(!m){return""}var i=m.top,f=m.bottom,g=m.left,j=m.right,n="";if(!i||!g||!f||!j){for(var k in m){n+=";"+h+"-"+k+":"+m[k]+";"}}else{n+=";"+h+":"+(i==f&&f==g&&g==j?i:i==f&&g==j?(i+" "+g):g==j?(i+" "+g+" "+f):(i+" "+j+" "+f+" "+g))+";"}return n}e+=b(d,"padding")+b(c,"margin");return e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(g,f){return f?f+";;":";"})},clone:function(c,d){var b;d=d||{};for(var a in c){if(c.hasOwnProperty(a)){b=c[a];if(typeof b=="object"){d[a]=utils.isArray(b)?[]:{};utils.clone(c[a],d[a])}else{d[a]=b}}}return d},transUnitToPx:function(b){if(!/(pt|cm)/.test(b)){return b}var a;b.replace(/([\d.]+)(\w+)/,function(e,c,d){b=c;a=d});switch(a){case"cm":b=parseFloat(b)*25;break;case"pt":b=Math.round(parseFloat(b)*96/72)}return b+(b?"px":"")},domReady:function(){var a=[];function b(d){d.isReady=true;for(var c;c=a.pop();c()){}}return function(c,e){e=e||window;var d=e.document;c&&a.push(c);if(d.readyState==="complete"){b(d)}else{d.isReady&&b(d);if(browser.ie){(function(){if(d.isReady){return}try{d.documentElement.doScroll("left")}catch(f){setTimeout(arguments.callee,0);return}b(d)})();e.attachEvent("onload",function(){b(d)})}else{d.addEventListener("DOMContentLoaded",function(){d.removeEventListener("DOMContentLoaded",arguments.callee,false);b(d)},false);e.addEventListener("load",function(){b(d)},false)}}}}(),cssRule:browser.ie?function(d,e,f){var a,c;f=f||document;if(f.indexList){a=f.indexList}else{a=f.indexList={}}var b;if(!a[d]){if(e===undefined){return""}b=f.createStyleSheet("",c=f.styleSheets.length);a[d]=c}else{b=f.styleSheets[a[d]]}if(e===undefined){return b.cssText}b.cssText=e||""}:function(b,c,e){e=e||document;var a=e.getElementsByTagName("head")[0],d;if(!(d=e.getElementById(b))){if(c===undefined){return""}d=e.createElement("style");d.id=b;a.appendChild(d)}if(c===undefined){return d.innerHTML}if(c!==""){d.innerHTML=c}else{a.removeChild(d)}}};utils.each(["String","Function","Array","Number","RegExp"],function(a){UE.utils["is"+a]=function(b){return Object.prototype.toString.apply(b)=="[object "+a+"]"}});var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(b,d){b=utils.trim(b).split(" ");for(var a=0,c;c=b[a++];){getListener(this,c,true).push(d)}},removeListener:function(b,d){b=utils.trim(b).split(" ");for(var a=0,c;c=b[a++];){utils.removeItem(getListener(this,c)||[],d)}},fireEvent:function(d){d=utils.trim(d).split(" ");for(var c=0,f;f=d[c++];){var e=getListener(this,f),g,b,a;if(e){a=e.length;while(a--){if(!e[a]){continue}b=e[a].apply(this,arguments);if(b===true){return b}if(b!==undefined){g=b}}}if(b=this["on"+f.toLowerCase()]){g=b.apply(this,arguments)}}return g}};function getListener(d,b,c){var a;b=b.toLowerCase();return((a=(d.__allListeners||c&&(d.__allListeners={})))&&(a[b]||c&&(a[b]=[])))}UE.ajax=function(){var a="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP");a="ActiveXObject('Msxml2.XMLHTTP')"}catch(d){try{new ActiveXObject("Microsoft.XMLHTTP");a="ActiveXObject('Microsoft.XMLHTTP')"}catch(d){}}var c=new Function("return new "+a);function b(f){var g=[];for(var e in f){if(e=="method"||e=="timeout"||e=="async"){continue}if(!((typeof f[e]).toLowerCase()=="function"||(typeof f[e]).toLowerCase()=="object")){g.push(encodeURIComponent(e)+"="+encodeURIComponent(f[e]))}}return g.join("&")}return{request:function(f,h){var l=c(),i=false,g={method:"POST",timeout:5000,async:true,data:{},onsuccess:function(){},onerror:function(){}};if(typeof f==="object"){h=f;f=h.url}if(!l||!f){return}var k=h?utils.extend(g,h):g;var n=b(k);if(!utils.isEmptyObject(k.data)){n+=(n?"&":"")+b(k.data)}var m=setTimeout(function(){if(l.readyState!=4){i=true;l.abort();clearTimeout(m)}},k.timeout);var e=k.method.toUpperCase();var j=f+(f.indexOf("?")==-1?"?":"&")+(e=="POST"?"":n+"&noCache="+ +new Date);l.open(e,j,k.async);l.onreadystatechange=function(){if(l.readyState==4){if(!i&&l.status==200){k.onsuccess(l)}else{k.onerror(l)}}};if(e=="POST"){l.setRequestHeader("Content-Type","application/x-www-form-urlencoded");l.send(n)}else{l.send(null)}}}}();var filterWord=UE.filterWord=function(){function c(d){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig.test(d)}function a(d){d=d.replace(/[\d.]+\w+/g,function(e){return utils.transUnitToPx(e)});return d}function b(d){return d.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(j){if(browser.opera){return""}try{var g=j.match(/width:([ \d.]*p[tx])/i)[1],f=j.match(/height:([ \d.]*p[tx])/i)[1],i=j.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+a(g)+'" height="'+a(f)+'" src="'+i+'" />'}catch(h){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)[\w-]+\2/ig,"").replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(l,q,j,f){var g=[],p=f.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g);for(var k=0,o;o=p[k];k++){var e,m,h=o.split(":");if(h.length==2){e=h[0].toLowerCase();m=h[1].toLowerCase();if(/^(background)\w*/.test(e)&&m.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(e)&&/^0\w+$/.test(m)){continue}switch(e){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":if(!/<table/.test(q)){g[k]=e.replace(/^mso-|-alt$/g,"")+":"+a(m)}continue;case"horiz-align":g[k]="text-align:"+m;continue;case"vert-align":g[k]="vertical-align:"+m;continue;case"font-color":case"mso-foreground":g[k]="color:"+m;continue;case"mso-background":case"mso-highlight":g[k]="background:"+m;continue;case"mso-default-height":g[k]="min-height:"+a(m);continue;case"mso-default-width":g[k]="min-width:"+a(m);continue;case"mso-padding-between-alt":g[k]="border-collapse:separate;border-spacing:"+a(m);continue;case"text-line-through":if((m=="single")||(m=="double")){g[k]="text-decoration:line-through"}continue;case"mso-zero-height":if(m=="yes"){g[k]="display:none"}continue;case"background":if(m=="initial"){}break;case"margin":if(!/[1-9]/.test(m)){continue}}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(e)||/text\-indent|padding|margin/.test(e)&&/\-[\d.]+/.test(m)){continue}g[k]=e+":"+h[1]}}return q+(g.length?' style="'+g.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(e){return utils.transUnitToPx(e)})}return function(d){return(c(d)?b(d):d).replace(/>[ \t\r\n]*</g,"><")}}();var dtd=dom.dtd=(function(){function W(B){for(var A in B){B[A.toUpperCase()]=B[A]}return B}function a(E){var B=arguments;for(var D=1;D<B.length;D++){var A=B[D];for(var C in A){if(!E.hasOwnProperty(C)){E[C]=A[C]}}}return E}var z=W({isindex:1,fieldset:1}),y=W({input:1,button:1,select:1,textarea:1,label:1}),x=a(W({a:1}),y),v=a({iframe:1},x),u=W({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),t=W({ins:1,del:1,script:1,style:1}),s=a(W({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),t),r=a(W({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),s),q=a(W({p:1}),r),p=a(W({iframe:1}),r,y),n=W({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),m=a(W({a:0}),p),k=W({tr:1}),j=W({"#":1}),i=a(W({param:1}),n),h=a(W({form:1}),z,v,u,q),g=W({li:1}),f=W({style:1,script:1}),e=W({base:1,link:1,meta:1,title:1}),d=a(e,f),c=W({head:1,body:1}),b=W({html:1});var l=W({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),o=W({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return W({$nonBodyContent:a(b,c,e),$block:l,$inline:m,$body:a(W({script:1,style:1}),l),$cdata:W({script:1,style:1}),$empty:o,$nonChild:W({iframe:1,textarea:1}),$listItem:W({dd:1,dt:1,li:1}),$list:W({ul:1,ol:1,dl:1}),$isNotEmpty:W({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:W({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:W({p:1,div:1}),$tableContent:W({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:W({pre:1,script:1,style:1,textarea:1}),html:c,head:d,style:j,script:j,body:h,base:{},link:{},meta:{},title:j,col:{},tr:W({td:1,th:1}),img:{},embed:{},colgroup:W({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:h,td:h,br:{},th:h,center:h,kbd:m,button:a(q,u),basefont:{},h5:m,h4:m,samp:m,h6:m,ol:g,h1:m,h3:m,option:j,h2:m,form:a(z,v,u,q),select:W({optgroup:1,option:1}),font:m,ins:m,menu:g,abbr:m,label:m,table:W({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:m,tfoot:k,cite:m,li:h,input:{},iframe:h,strong:m,textarea:j,noframes:h,big:m,small:m,span:W({"#":1,br:1}),hr:m,dt:m,sub:m,optgroup:W({option:1}),param:{},bdo:m,"var":m,div:h,object:i,sup:m,dd:h,strike:m,area:{},dir:g,map:a(W({area:1,form:1,p:1}),z,t,u),applet:i,dl:W({dt:1,dd:1}),del:m,isindex:{},fieldset:a(W({legend:1}),n),thead:k,ul:g,acronym:m,b:m,a:a(W({a:1}),p),blockquote:a(W({td:1,tr:1,tbody:1,li:1}),h),caption:m,i:m,u:m,tbody:k,s:m,address:a(v,q),tt:m,legend:m,q:m,pre:a(s,x),p:a(W({a:1}),m),em:m,dfn:m})})();function getDomNode(g,h,b,a,e,f){var d=a&&g[h],c;!d&&(d=g[b]);while(!d&&(c=(c||g).parentNode)){if(c.tagName=="BODY"||f&&!f(c)){return null}d=c[b]}if(d&&e&&!e(d)){return getDomNode(d,h,b,false,e)}return d}var attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]);var domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&browser.version=="6"?"\ufeff":"\u200B",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(f,d){if(f===d){return 0}var b,e=[f],c=[d];b=f;while(b=b.parentNode){if(b===d){return 10}e.push(b)}b=d;while(b=b.parentNode){if(b===f){return 20}c.push(b)}e.reverse();c.reverse();if(e[0]!==c[0]){return 1}var a=-1;while(a++,e[a]===c[a]){}f=e[a];d=c[a];while(f=f.nextSibling){if(f===d){return 4}}return 2},getNodeIndex:function(c,b){var d=c,a=0;while(d=d.previousSibling){if(b&&d.nodeType==3){if(d.nodeType!=d.nextSibling.nodeType){a++}continue}a++}return a},inDoc:function(a,b){return domUtils.getPosition(a,b)==10},findParent:function(b,c,a){if(b&&!domUtils.isBody(b)){b=a?b:b.parentNode;while(b){if(!c||c(b)||domUtils.isBody(b)){return c&&!c(b)&&domUtils.isBody(b)?null:b}b=b.parentNode}}return null},findParentByTagName:function(c,a,b,d){a=utils.listToMap(utils.isArray(a)?a:[a]);return domUtils.findParent(c,function(e){return a[e.tagName]&&!(d&&d(e))},b)},findParents:function(d,c,e,b){var a=c&&(e&&e(d)||!e)?[d]:[];while(d=domUtils.findParent(d,e)){a.push(d)}return b?a:a.reverse()},insertAfter:function(b,a){return b.parentNode.insertBefore(a,b.nextSibling)},remove:function(b,c){var a=b.parentNode,d;if(a){if(c&&b.hasChildNodes()){while(d=b.firstChild){a.insertBefore(d,b)}}a.removeChild(b)}return b},getNextDomNode:function(c,a,d,b){return getDomNode(c,"firstChild","nextSibling",a,d,b)},isBookmarkNode:function(a){return a.nodeType==1&&a.id&&/^_baidu_bookmark_/i.test(a.id)},getWindow:function(a){var b=a.ownerDocument||a;return b.defaultView||b.parentWindow},getCommonAncestor:function(f,d){if(f===d){return f}var e=[f],c=[d],b=f,a=-1;while(b=b.parentNode){if(b===d){return b}e.push(b)}b=d;while(b=b.parentNode){if(b===f){return b}c.push(b)}e.reverse();c.reverse();while(a++,e[a]===c[a]){}return a==0?null:e[a-1]},clearEmptySibling:function(d,b,c){function a(g,e){var f;while(g&&!domUtils.isBookmarkNode(g)&&(domUtils.isEmptyInlineElement(g)||!new RegExp("[^\t\n\r"+domUtils.fillChar+"]").test(g.nodeValue))){f=g[e];domUtils.remove(g);g=f}}!b&&a(d.nextSibling,"nextSibling");!c&&a(d.previousSibling,"previousSibling")},split:function(d,f){var e=d.ownerDocument;if(browser.ie&&f==d.nodeValue.length){var c=e.createTextNode("");return domUtils.insertAfter(d,c)}var a=d.splitText(f);if(browser.ie8){var b=e.createTextNode("");domUtils.insertAfter(a,b);domUtils.remove(b)}return a},isWhitespace:function(a){return !new RegExp("[^ \t\n\r"+domUtils.fillChar+"]").test(a.nodeValue)},getXY:function(b){var a=0,c=0;while(b.offsetParent){c+=b.offsetTop;a+=b.offsetLeft;b=b.offsetParent}return{x:a,y:c}},on:function(e,g,f){var d=utils.isArray(g)?g:[g],a=d.length;if(a){while(a--){g=d[a];if(e.addEventListener){e.addEventListener(g,f,false)}else{if(!f._d){f._d={els:[]}}var c=g+f.toString(),b=utils.indexOf(f._d.els,e);if(!f._d[c]||b==-1){if(b==-1){f._d.els.push(e)}if(!f._d[c]){f._d[c]=function(h){return f.call(h.srcElement,h||window.event)}}e.attachEvent("on"+g,f._d[c])}}}}e=null},un:function(f,h,g){var d=utils.isArray(h)?h:[h],a=d.length;if(a){while(a--){h=d[a];if(f.removeEventListener){f.removeEventListener(h,g,false)}else{var c=h+g.toString();try{f.detachEvent("on"+h,g._d?g._d[c]:g)}catch(i){}if(g._d&&g._d[c]){var b=utils.indexOf(g._d.els,f);if(b!=-1){g._d.els.splice(b,1)}g._d.els.length==0&&delete g._d[c]}}}}},isSameElement:function(d,c){if(d.tagName!=c.tagName){return false}var e=d.attributes,g=c.attributes;if(!ie&&e.length!=g.length){return false}var a,j,h=0,b=0;for(var f=0;a=e[f++];){if(a.nodeName=="style"){if(a.specified){h++}if(domUtils.isSameStyle(d,c)){continue}else{return false}}if(ie){if(a.specified){h++;j=g.getNamedItem(a.nodeName)}else{continue}}else{j=c.attributes[a.nodeName]}if(!j.specified||a.nodeValue!=j.nodeValue){return false}}if(ie){for(f=0;j=g[f++];){if(j.specified){b++}}if(h!=b){return false}}return true},isSameStyle:function(g,e){var b=g.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),a=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){b=g.style;a=e.style;if(b.length!=a.length){return false}for(var f in b){if(/^(\d+|csstext)$/i.test(f)){continue}if(b[f]!=a[f]){return false}}return true}if(!b||!a){return b==a}b=b.split(";");a=a.split(";");if(b.length!=a.length){return false}for(var d=0,c;c=b[d++];){if(utils.indexOf(a,c)==-1){return false}}return true},isBlockElm:function(a){return a.nodeType==1&&(dtd.$block[a.tagName]||styleBlock[domUtils.getComputedStyle(a,"display")])&&!dtd.$nonChild[a.tagName]},isBody:function(a){return a&&a.nodeType==1&&a.tagName.toLowerCase()=="body"},breakParent:function(e,c){var b,g=e,f=e,a,d;do{g=g.parentNode;if(a){b=g.cloneNode(false);b.appendChild(a);a=b;b=g.cloneNode(false);b.appendChild(d);d=b}else{a=g.cloneNode(false);d=a.cloneNode(false)}while(b=f.previousSibling){a.insertBefore(b,a.firstChild)}while(b=f.nextSibling){d.appendChild(b)}f=g}while(c!==g);b=c.parentNode;b.insertBefore(a,c);b.insertBefore(d,c);b.insertBefore(e,d);domUtils.remove(c);return e},isEmptyInlineElement:function(a){if(a.nodeType!=1||!dtd.$removeEmpty[a.tagName]){return 0}a=a.firstChild;while(a){if(domUtils.isBookmarkNode(a)){return 0}if(a.nodeType==1&&!domUtils.isEmptyInlineElement(a)||a.nodeType==3&&!domUtils.isWhitespace(a)){return 0}a=a.nextSibling}return 1},trimWhiteTextNode:function(b){function a(c){var d;while((d=b[c])&&d.nodeType==3&&domUtils.isWhitespace(d)){b.removeChild(d)}}a("firstChild");a("lastChild")},mergeChild:function(c,b,g){var f=domUtils.getElementsByTagName(c,c.tagName.toLowerCase());for(var e=0,k;k=f[e++];){if(!k.parentNode||domUtils.isBookmarkNode(k)){continue}if(k.tagName.toLowerCase()=="span"){if(c===k.parentNode){domUtils.trimWhiteTextNode(c);if(c.childNodes.length==1){c.style.cssText=k.style.cssText+";"+c.style.cssText;domUtils.remove(k,true);continue}}k.style.cssText=c.style.cssText+";"+k.style.cssText;if(g){var a=g.style;if(a){a=a.split(";");for(var d=0,h;h=a[d++];){k.style[utils.cssStyleToDomStyle(h.split(":")[0])]=h.split(":")[1]}}}if(domUtils.isSameStyle(k,c)){domUtils.remove(k,true)}continue}if(domUtils.isSameElement(c,k)){domUtils.remove(k,true)}}},getElementsByTagName:function(e,a,b){if(b&&utils.isString(b)){var j=b;b=function(i){return domUtils.hasClass(i,j)}}a=utils.trim(a).replace(/[ ]{2,}/g," ").split(" ");var g=[];for(var d=0,c;c=a[d++];){var h=e.getElementsByTagName(c);for(var f=0,k;k=h[f++];){if(!b||b(k)){g.push(k)}}}return g},mergeToParent:function(b){var a=b.parentNode;while(a&&dtd.$removeEmpty[a.tagName]){if(a.tagName==b.tagName||a.tagName=="A"){domUtils.trimWhiteTextNode(a);if(a.tagName=="SPAN"&&!domUtils.isSameStyle(a,b)||(a.tagName=="A"&&b.tagName=="SPAN")){if(a.childNodes.length>1||a!==b.parentNode){b.style.cssText=a.style.cssText+";"+b.style.cssText;a=a.parentNode;continue}else{a.style.cssText+=";"+b.style.cssText;if(a.tagName=="A"){a.style.textDecoration="underline"}}}if(a.tagName!="A"){a===b.parentNode&&domUtils.remove(b,true);break}}a=a.parentNode}},mergeSibling:function(c,b,a){function d(g,h,f){var e;if((e=f[g])&&!domUtils.isBookmarkNode(e)&&e.nodeType==1&&domUtils.isSameElement(f,e)){while(e.firstChild){if(h=="firstChild"){f.insertBefore(e.lastChild,f.firstChild)}else{f.appendChild(e.firstChild)}}domUtils.remove(e)}}!b&&d("previousSibling","firstChild",c);!a&&d("nextSibling","lastChild",c)},unSelectable:ie||browser.opera?function(c){c.onselectstart=function(){return false};c.onclick=c.onkeyup=c.onkeydown=function(){return false};c.unselectable="on";c.setAttribute("unselectable","on");for(var b=0,a;a=c.all[b++];){switch(a.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:a.unselectable="on";c.setAttribute("unselectable","on")}}}:function(a){a.style.MozUserSelect=a.style.webkitUserSelect=a.style.KhtmlUserSelect="none"},removeAttributes:function(c,d){d=utils.isArray(d)?d:utils.trim(d).replace(/[ ]{2,}/g," ").split(" ");for(var b=0,a;a=d[b++];){a=attrFix[a]||a;switch(a){case"className":c[a]="";break;case"style":c.style.cssText="";!browser.ie&&c.removeAttributeNode(c.getAttributeNode("style"))}c.removeAttribute(a)}},createElement:function(c,a,b){return domUtils.setAttributes(c.createElement(a),b)},setAttributes:function(c,b){for(var a in b){if(b.hasOwnProperty(a)){var d=b[a];switch(a){case"class":c.className=d;break;case"style":c.style.cssText=c.style.cssText+";"+d;break;case"innerHTML":c[a]=d;break;case"value":c.value=d;break;default:c.setAttribute(attrFix[a]||a,d)}}}return c},getComputedStyle:function(c,b){var g="width height top left";if(g.indexOf(b)>-1){return c["offset"+b.replace(/^\w/,function(e){return e.toUpperCase()})]+"px"}if(c.nodeType==3){c=c.parentNode}if(browser.ie&&browser.version<9&&b=="font-size"&&!c.style.fontSize&&!dtd.$empty[c.tagName]&&!dtd.$nonChild[c.tagName]){var d=c.ownerDocument.createElement("span");d.style.cssText="padding:0;border:0;font-family:simsun;";d.innerHTML=".";c.appendChild(d);var a=d.offsetHeight;c.removeChild(d);d=null;return a+"px"}try{var f=domUtils.getStyle(c,b)||(window.getComputedStyle?domUtils.getWindow(c).getComputedStyle(c,"").getPropertyValue(b):(c.currentStyle||c.style)[utils.cssStyleToDomStyle(b)])}catch(h){return""}return utils.transUnitToPx(utils.fixColor(b,f))},removeClasses:function(e,d){d=utils.isArray(d)?d:utils.trim(d).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=e.className;b=d[c++];){a=a.replace(new RegExp("\\b"+b+"\\b"),"")}a=utils.trim(a).replace(/[ ]{2,}/g," ");if(a){e.className=a}else{domUtils.removeAttributes(e,["class"])}},addClass:function(e,d){if(!e){return}d=utils.trim(d).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=e.className;b=d[c++];){if(!new RegExp("\\b"+b+"\\b").test(a)){e.className+=" "+b}}},hasClass:function(d,e){if(utils.isRegExp(e)){return e.test(d.className)}e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=d.className;b=e[c++];){if(!new RegExp("\\b"+b+"\\b","i").test(a)){return false}}return c-1==e.length},preventDefault:function(a){a.preventDefault?a.preventDefault():(a.returnValue=false)},removeStyle:function(b,a){if(browser.ie&&browser.version>8){b.style.cssText=b.style.cssText.replace(new RegExp(a+"s*:s*[^;]+;?"),"")}else{if(b.style.removeProperty){b.style.removeProperty(a)}else{b.style.removeAttribute(utils.cssStyleToDomStyle(a))}}if(!b.style.cssText){domUtils.removeAttributes(b,["style"])}},getStyle:function(b,a){var c=b.style[utils.cssStyleToDomStyle(a)];return utils.fixColor(a,c)},setStyle:function(b,a,c){b.style[utils.cssStyleToDomStyle(a)]=c},setStyles:function(b,c){for(var a in c){if(c.hasOwnProperty(a)){domUtils.setStyle(b,a,c[a])}}},removeDirtyAttr:function(d){for(var c=0,b,a=d.getElementsByTagName("*");b=a[c++];){b.removeAttribute("_moz_dirty")}d.removeAttribute("_moz_dirty")},getChildCount:function(c,a){var b=0,d=c.firstChild;a=a||function(){return 1};while(d){if(a(d)){b++}d=d.nextSibling}return b},isEmptyNode:function(a){return !a.firstChild||domUtils.getChildCount(a,function(b){return !domUtils.isBr(b)&&!domUtils.isBookmarkNode(b)&&!domUtils.isWhitespace(b)})==0},clearSelectedArr:function(a){var b;while(b=a.pop()){domUtils.removeAttributes(b,["class"])}},scrollToView:function(c,i,a){var b=function(){var j=i.document,k=j.compatMode=="CSS1Compat";return{width:(k?j.documentElement.clientWidth:j.body.clientWidth)||0,height:(k?j.documentElement.clientHeight:j.body.clientHeight)||0}},h=function(k){if("pageXOffset" in k){return{x:k.pageXOffset||0,y:k.pageYOffset||0}}else{var j=k.document;return{x:j.documentElement.scrollLeft||j.body.scrollLeft||0,y:j.documentElement.scrollTop||j.body.scrollTop||0}}};var f=b().height,g=f*-1+a;g+=(c.offsetHeight||0);var d=domUtils.getXY(c);g+=d.y;var e=h(i).y;if(g>e||g<e-f){i.scrollTo(0,g+(g<0?-20:20))}},isBr:function(a){return a.nodeType==1&&a.tagName=="BR"},isFillChar:function(a,b){return a.nodeType==3&&!a.nodeValue.replace(new RegExp((b?"^":"")+domUtils.fillChar),"").length},isStartInblock:function(b){var f=b.cloneRange(),a=0,g=f.startContainer,c;if(g.nodeType==1&&g.childNodes[f.startOffset]){g=g.childNodes[f.startOffset];var e=g.previousSibling;while(e&&domUtils.isFillChar(e)){g=e;e=e.previousSibling}}if(this.isFillChar(g,true)&&f.startOffset==1){f.setStartBefore(g);g=f.startContainer}while(g&&domUtils.isFillChar(g)){c=g;g=g.previousSibling}if(c){f.setStartBefore(c);g=f.startContainer}if(g.nodeType==1&&domUtils.isEmptyNode(g)&&f.startOffset==1){f.setStart(g,0).collapse(true)}while(!f.startOffset){g=f.startContainer;if(domUtils.isBlockElm(g)||domUtils.isBody(g)){a=1;break}var e=f.startContainer.previousSibling,d;if(!e){f.setStartBefore(f.startContainer)}else{while(e&&domUtils.isFillChar(e)){d=e;e=e.previousSibling}if(d){f.setStartBefore(d)}else{f.setStartBefore(f.startContainer)}}}return a&&!domUtils.isBody(f.startContainer)?1:0},isEmptyBlock:function(b){var a=new RegExp("[ \t\r\n"+domUtils.fillChar+"]","g");if(b[browser.ie?"innerText":"textContent"].replace(a,"").length>0){return 0}for(var c in dtd.$isNotEmpty){if(b.getElementsByTagName(c).length){return 0}}return 1},setViewportOffset:function(a,g){var f=parseInt(a.style.left)|0;var e=parseInt(a.style.top)|0;var c=a.getBoundingClientRect();var d=g.left-c.left;var b=g.top-c.top;if(d){a.style.left=f+d+"px"}if(b){a.style.top=e+b+"px"}},fillNode:function(c,b){var a=browser.ie?c.createTextNode(domUtils.fillChar):c.createElement("br");b.innerHTML="";b.appendChild(a)},moveChild:function(c,a,b){while(c.firstChild){if(b&&a.firstChild){a.insertBefore(c.lastChild,a.firstChild)}else{a.appendChild(c.firstChild)}}},hasNoAttributes:function(a){return browser.ie?/^<\w+\s*?>/.test(a.outerHTML):a.attributes.length==0},isCustomeNode:function(a){return a.nodeType==1&&a.getAttribute("_ue_custom_node_")},isTagNode:function(b,a){return b.nodeType==1&&new RegExp(b.tagName,"i").test(a)},filterNodeList:function(d,c,b){var a=[];if(!utils.isFunction(c)){var e=c;c=function(f){return utils.indexOf(utils.isArray(e)?e:e.split(" "),f.tagName.toLowerCase())!=-1}}utils.each(d,function(f){c(f)&&a.push(f)});return a.length==0?null:a.length==1||!b?a[0]:a},isInNodeEndBoundary:function(a,b){var c=a.startContainer;if(c.nodeType==3&&a.startOffset!=c.nodeValue.length){return 0}if(c.nodeType==1&&a.startOffset!=c.childNodes.length){return 0}while(c!==b){if(c.nextSibling){return 0}c=c.parentNode}return 1},isBoundaryNode:function(c,a){var b;while(!domUtils.isBody(c)){b=c;c=c.parentNode;if(b!==c[a]){return false}}return true}};var fillCharReg=new RegExp(domUtils.fillChar,"g");(function(){var f=0,g=domUtils.fillChar,c;function b(k){k.collapsed=k.startContainer&&k.endContainer&&k.startContainer===k.endContainer&&k.startOffset==k.endOffset}function j(k){return !k.collapsed&&k.startContainer.nodeType==1&&k.startContainer===k.endContainer&&k.endOffset-k.startOffset==1}function a(l,m,n,k){if(m.nodeType==1&&(dtd.$empty[m.tagName]||dtd.$nonChild[m.tagName])){n=domUtils.getNodeIndex(m)+(l?0:1);m=m.parentNode}if(l){k.startContainer=m;k.startOffset=n;if(!k.endContainer){k.collapse(true)}}else{k.endContainer=m;k.endOffset=n;if(!k.startContainer){k.collapse(false)}}b(k);return k}function i(q,u){var o=q.startContainer,n=q.endContainer,x=q.startOffset,p=q.endOffset,D=q.document,k=D.createDocumentFragment(),r,t;if(o.nodeType==1){o=o.childNodes[x]||(r=o.appendChild(D.createTextNode("")))}if(n.nodeType==1){n=n.childNodes[p]||(t=n.appendChild(D.createTextNode("")))}if(o===n&&o.nodeType==3){k.appendChild(D.createTextNode(o.substringData(x,p-x)));if(u){o.deleteData(x,p-x);q.collapse(true)}return k}var s,z,B=k,A=domUtils.findParents(o,true),l=domUtils.findParents(n,true);for(var y=0;A[y]==l[y];){y++}for(var v=y,C;C=A[v];v++){s=C.nextSibling;if(C==o){if(!r){if(q.startContainer.nodeType==3){B.appendChild(D.createTextNode(o.nodeValue.slice(x)));if(u){o.deleteData(x,o.nodeValue.length-x)}}else{B.appendChild(!u?o.cloneNode(true):o)}}}else{z=C.cloneNode(false);B.appendChild(z)}while(s){if(s===n||s===l[v]){break}C=s.nextSibling;B.appendChild(!u?s.cloneNode(true):s);s=C}B=z}B=k;if(!A[y]){B.appendChild(A[y-1].cloneNode(false));B=B.firstChild}for(var v=y,m;m=l[v];v++){s=m.previousSibling;if(m==n){if(!t&&q.endContainer.nodeType==3){B.appendChild(D.createTextNode(n.substringData(0,p)));if(u){n.deleteData(0,p)}}}else{z=m.cloneNode(false);B.appendChild(z)}if(v!=y||!A[y]){while(s){if(s===o){break}m=s.previousSibling;B.insertBefore(!u?s.cloneNode(true):s,B.firstChild);s=m}}B=z}if(u){q.setStartBefore(!l[y]?l[y-1]:!A[y]?A[y-1]:l[y]).collapse(true)}r&&domUtils.remove(r);t&&domUtils.remove(t);return k}var d=dom.Range=function(k){var l=this;l.startContainer=l.startOffset=l.endContainer=l.endOffset=null;l.document=k;l.collapsed=true};function e(n,k){try{if(c&&domUtils.inDoc(c,n)){if(!c.nodeValue.replace(fillCharReg,"").length){var l=c.parentNode;domUtils.remove(c);while(l&&domUtils.isEmptyInlineElement(l)&&(browser.safari?!(domUtils.getPosition(l,k)&domUtils.POSITION_CONTAINS):!l.contains(k))){c=l.parentNode;domUtils.remove(l);l=c}}else{c.nodeValue=c.nodeValue.replace(fillCharReg,"")}}}catch(m){}}function h(m,k){var l;m=m[k];while(m&&domUtils.isFillChar(m)){l=m[k];domUtils.remove(m);m=l}}d.prototype={cloneContents:function(){return this.collapsed?null:i(this,0)},deleteContents:function(){var k;if(!this.collapsed){i(this,1)}if(browser.webkit){k=this.startContainer;if(k.nodeType==3&&!k.nodeValue.length){this.setStartBefore(k).collapse(true);domUtils.remove(k)}}return this},extractContents:function(){return this.collapsed?null:i(this,2)},setStart:function(k,l){return a(true,k,l,this)},setEnd:function(k,l){return a(false,k,l,this)},setStartAfter:function(k){return this.setStart(k.parentNode,domUtils.getNodeIndex(k)+1)},setStartBefore:function(k){return this.setStart(k.parentNode,domUtils.getNodeIndex(k))},setEndAfter:function(k){return this.setEnd(k.parentNode,domUtils.getNodeIndex(k)+1)},setEndBefore:function(k){return this.setEnd(k.parentNode,domUtils.getNodeIndex(k))},setStartAtFirst:function(k){return this.setStart(k,0)},setStartAtLast:function(k){return this.setStart(k,k.nodeType==3?k.nodeValue.length:k.childNodes.length)},setEndAtFirst:function(k){return this.setEnd(k,0)},setEndAtLast:function(k){return this.setEnd(k,k.nodeType==3?k.nodeValue.length:k.childNodes.length)},selectNode:function(k){return this.setStartBefore(k).setEndAfter(k)},selectNodeContents:function(k){return this.setStart(k,0).setEndAtLast(k)},cloneRange:function(){var k=this;return new d(k.document).setStart(k.startContainer,k.startOffset).setEnd(k.endContainer,k.endOffset)},collapse:function(k){var l=this;if(k){l.endContainer=l.startContainer;l.endOffset=l.startOffset}else{l.startContainer=l.endContainer;l.startOffset=l.endOffset}l.collapsed=true;return l},shrinkBoundary:function(m){var l=this,o,n=l.collapsed;function k(p){return p.nodeType==1&&!domUtils.isBookmarkNode(p)&&!dtd.$empty[p.tagName]&&!dtd.$nonChild[p.tagName]}while(l.startContainer.nodeType==1&&(o=l.startContainer.childNodes[l.startOffset])&&k(o)){l.setStart(o,0)}if(n){return l.collapse(true)}if(!m){while(l.endContainer.nodeType==1&&l.endOffset>0&&(o=l.endContainer.childNodes[l.endOffset-1])&&k(o)){l.setEnd(o,o.childNodes.length)}}return l},getCommonAncestor:function(l,m){var n=this,o=n.startContainer,k=n.endContainer;if(o===k){if(l&&j(this)){o=o.childNodes[n.startOffset];if(o.nodeType==1){return o}}return m&&o.nodeType==3?o.parentNode:o}return domUtils.getCommonAncestor(o,k)},trimBoundary:function(l){this.txtToElmBoundary();var p=this.startContainer,o=this.startOffset,n=this.collapsed,k=this.endContainer;if(p.nodeType==3){if(o==0){this.setStartBefore(p)}else{if(o>=p.nodeValue.length){this.setStartAfter(p)}else{var m=domUtils.split(p,o);if(p===k){this.setEnd(m,this.endOffset-o)}else{if(p.parentNode===k){this.endOffset+=1}}this.setStartBefore(m)}}if(n){return this.collapse(true)}}if(!l){o=this.endOffset;k=this.endContainer;if(k.nodeType==3){if(o==0){this.setEndBefore(k)}else{o<k.nodeValue.length&&domUtils.split(k,o);this.setEndAfter(k)}}}return this},txtToElmBoundary:function(){function k(m,o){var l=m[o+"Container"],n=m[o+"Offset"];if(l.nodeType==3){if(!n){m["set"+o.replace(/(\w)/,function(p){return p.toUpperCase()})+"Before"](l)}else{if(n>=l.nodeValue.length){m["set"+o.replace(/(\w)/,function(p){return p.toUpperCase()})+"After"](l)}}}}if(!this.collapsed){k(this,"start");k(this,"end")}return this},insertNode:function(m){var o=m,l=1;if(m.nodeType==11){o=m.firstChild;l=m.childNodes.length}this.trimBoundary(true);var p=this.startContainer,n=this.startOffset;var k=p.childNodes[n];if(k){p.insertBefore(m,k)}else{p.appendChild(m)}if(o.parentNode===this.endContainer){this.endOffset=this.endOffset+l}return this.setStartBefore(o)},setCursor:function(l,k){return this.collapse(!l).select(k)},createBookmark:function(m,n){var k,l=this.document.createElement("span");l.style.cssText="display:none;line-height:0px;";l.appendChild(this.document.createTextNode("\u200D"));l.id="_baidu_bookmark_start_"+(n?"":f++);if(!this.collapsed){k=l.cloneNode(true);k.id="_baidu_bookmark_end_"+(n?"":f++)}this.insertNode(l);if(k){this.collapse().insertNode(k).setEndBefore(k)}this.setStartAfter(l);return{start:m?l.id:l,end:k?m?k.id:k:null,id:m}},moveToBookmark:function(l){var m=l.id?this.document.getElementById(l.start):l.start,k=l.end&&l.id?this.document.getElementById(l.end):l.end;this.setStartBefore(m);domUtils.remove(m);if(k){this.setEndBefore(k);domUtils.remove(k)}else{this.collapse(true)}return this},enlarge:function(l,o){var k=domUtils.isBody,p,n,m=this.document.createTextNode("");if(l){n=this.startContainer;if(n.nodeType==1){if(n.childNodes[this.startOffset]){p=n=n.childNodes[this.startOffset]}else{n.appendChild(m);p=n=m}}else{p=n}while(1){if(domUtils.isBlockElm(n)){n=p;while((p=n.previousSibling)&&!domUtils.isBlockElm(p)){n=p}this.setStartBefore(n);break}p=n;n=n.parentNode}n=this.endContainer;if(n.nodeType==1){if(p=n.childNodes[this.endOffset]){n.insertBefore(m,p)}else{n.appendChild(m)}p=n=m}else{p=n}while(1){if(domUtils.isBlockElm(n)){n=p;while((p=n.nextSibling)&&!domUtils.isBlockElm(p)){n=p}this.setEndAfter(n);break}p=n;n=n.parentNode}if(m.parentNode===this.endContainer){this.endOffset--}domUtils.remove(m)}if(!this.collapsed){while(this.startOffset==0){if(o&&o(this.startContainer)){break}if(k(this.startContainer)){break}this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(o&&o(this.endContainer)){break}if(k(this.endContainer)){break}this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer)}while(!domUtils.isBody(this.endContainer)&&!this.endOffset){this.setEndBefore(this.endContainer)}}return this},applyInlineStyle:function(m,y,t){if(this.collapsed){return this}this.trimBoundary().enlarge(false,function(C){return C.nodeType==1&&domUtils.isBlockElm(C)}).adjustmentBoundary();var u=this.createBookmark(),p=u.end,A=function(C){return C.nodeType==1?C.tagName.toLowerCase()!="br":!domUtils.isWhitespace(C)},s=domUtils.getNextDomNode(u.start,false,A),n,o,r=this.cloneRange();while(s&&(domUtils.getPosition(s,p)&domUtils.POSITION_PRECEDING)){if(s.nodeType==3||dtd[m][s.tagName]){r.setStartBefore(s);n=s;while(n&&(n.nodeType==3||dtd[m][n.tagName])&&n!==p){o=n;n=domUtils.getNextDomNode(n,n.nodeType==1,null,function(C){return dtd[m][C.tagName]})}var z=r.setEndAfter(o).extractContents(),v;if(t&&t.length>0){var k,x;x=k=t[0].cloneNode(false);for(var q=1,B;B=t[q++];){k.appendChild(B.cloneNode(false));k=k.firstChild}v=k}else{v=r.document.createElement(m)}if(y){domUtils.setAttributes(v,y)}v.appendChild(z);r.insertNode(t?x:v);var l;if(m=="span"&&y.style&&/text\-decoration/.test(y.style)&&(l=domUtils.findParentByTagName(v,"a",true))){domUtils.setAttributes(l,y);domUtils.remove(v,true);v=l}else{domUtils.mergeSibling(v);domUtils.clearEmptySibling(v)}domUtils.mergeChild(v,y);s=domUtils.getNextDomNode(v,false,A);domUtils.mergeToParent(v);if(n===p){break}}else{s=domUtils.getNextDomNode(s,true,A)}}return this.moveToBookmark(u)},removeInlineStyle:function(k){if(this.collapsed){return this}k=utils.isArray(k)?k:[k];this.shrinkBoundary().adjustmentBoundary();var r=this.startContainer,l=this.endContainer;while(1){if(r.nodeType==1){if(utils.indexOf(k,r.tagName.toLowerCase())>-1){break}if(r.tagName.toLowerCase()=="body"){r=null;break}}r=r.parentNode}while(1){if(l.nodeType==1){if(utils.indexOf(k,l.tagName.toLowerCase())>-1){break}if(l.tagName.toLowerCase()=="body"){l=null;break}}l=l.parentNode}var n=this.createBookmark(),q,p;if(r){p=this.cloneRange().setEndBefore(n.start).setStartBefore(r);q=p.extractContents();p.insertNode(q);domUtils.clearEmptySibling(r,true);r.parentNode.insertBefore(n.start,r)}if(l){p=this.cloneRange().setStartAfter(n.end).setEndAfter(l);q=p.extractContents();p.insertNode(q);domUtils.clearEmptySibling(l,false,true);l.parentNode.insertBefore(n.end,l.nextSibling)}var o=domUtils.getNextDomNode(n.start,false,function(s){return s.nodeType==1}),m;while(o&&o!==n.end){m=domUtils.getNextDomNode(o,true,function(s){return s.nodeType==1});if(utils.indexOf(k,o.tagName.toLowerCase())>-1){domUtils.remove(o,true)}o=m}return this.moveToBookmark(n)},getClosedNode:function(){var l;if(!this.collapsed){var k=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(j(k)){var m=k.startContainer.childNodes[k.startOffset];if(m&&m.nodeType==1&&(dtd.$empty[m.tagName]||dtd.$nonChild[m.tagName])){l=m}}}return l},select:browser.ie?function(l,u){var q;if(!this.collapsed){this.shrinkBoundary()}var m=this.getClosedNode();if(m&&!u){try{q=this.document.body.createControlRange();q.addElement(m);q.select()}catch(r){}return this}var s=this.createBookmark(),k=s.start,n;q=this.document.body.createTextRange();q.moveToElementText(k);q.moveStart("character",1);if(!this.collapsed){var p=this.document.body.createTextRange();n=s.end;p.moveToElementText(n);q.setEndPoint("EndToEnd",p)}else{if(!l&&this.startContainer.nodeType!=3){var t=this.document.createTextNode(g),o=this.document.createElement("span");o.appendChild(this.document.createTextNode(g));k.parentNode.insertBefore(o,k);k.parentNode.insertBefore(t,k);e(this.document,t);c=t;h(o,"previousSibling");h(k,"nextSibling");q.moveStart("character",-1);q.collapse(true)}}this.moveToBookmark(s);o&&domUtils.remove(o);try{q.select()}catch(r){}return this}:function(k){function l(t){function s(v,x,u){if(v.nodeType==3&&v.nodeValue.length<x){t[u+"Offset"]=v.nodeValue.length}}s(t.startContainer,t.startOffset,"start");s(t.endContainer,t.endOffset,"end")}var p=domUtils.getWindow(this.document),o=p.getSelection(),n;browser.gecko?this.document.body.focus():p.focus();if(o){o.removeAllRanges();if(this.collapsed&&!k){var r=this.startContainer,q=r;if(r.nodeType==1){q=r.childNodes[this.startOffset]}if(!(r.nodeType==3&&this.startOffset)&&(q?(!q.previousSibling||q.previousSibling.nodeType!=3):(!r.lastChild||r.lastChild.nodeType!=3))){n=this.document.createTextNode(g);this.insertNode(n);e(this.document,n);h(n,"previousSibling");h(n,"nextSibling");c=n;this.setStart(n,browser.webkit?1:0).collapse(true)}}var m=this.document.createRange();if(this.collapsed&&browser.opera&&this.startContainer.nodeType==1){var q=this.startContainer.childNodes[this.startOffset];if(!q){q=this.startContainer.lastChild;if(q&&domUtils.isBr(q)){this.setStartBefore(q).collapse(true)}}else{while(q&&domUtils.isBlockElm(q)){if(q.nodeType==1&&q.childNodes[0]){q=q.childNodes[0]}else{break}}q&&this.setStartBefore(q).collapse(true)}}l(this);m.setStart(this.startContainer,this.startOffset);m.setEnd(this.endContainer,this.endOffset);o.addRange(m)}return this},scrollToView:function(m,n){m=m?window:domUtils.getWindow(this.document);var l=this,k=l.document.createElement("span");k.innerHTML="&nbsp;";l.cloneRange().insertNode(k);domUtils.scrollToView(k,m,n);domUtils.remove(k);return l},inFillChar:function(){var k=this.startContainer;if(this.collapsed&&k.nodeType==3&&k.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1==k.nodeValue.length){return true}return false},createAddress:function(n,m){var o={},l=this;function k(p){var r=p?l.startContainer:l.endContainer;var x=domUtils.findParents(r,true,function(z){return !domUtils.isBody(z)}),v=[];for(var t=0,y;y=x[t++];){v.push(domUtils.getNodeIndex(y,m))}var q=0;if(m){if(r.nodeType==3){var s=r;while(s=s.previousSibling){if(s.nodeType==3){q+=s.nodeValue.replace(fillCharReg,"").length}else{break}}q+=(p?l.startOffset:l.endOffset)-(fillCharReg.test(r.nodeValue)?1:0)}else{r=r.childNodes[p?l.startOffset:l.endOffset];if(r){q=domUtils.getNodeIndex(r,m)}else{r=p?l.startContainer:l.endContainer;var u=r.firstChild;while(u){if(domUtils.isFillChar(u)){u=u.nextSibling;continue}q++;if(u.nodeType==3){while(u&&u.nodeType==3){u=u.nextSibling}}else{u=u.nextSibling}}}}}else{q=p?l.startOffset:l.endOffset}if(q<0){q=0}v.push(q);return v}o.startAddress=k(true);if(!n){o.endAddress=l.collapsed?[].concat(o.startAddress):k()}return o},moveToAddress:function(n,l){var k=this;function m(r,q){var u=k.document.body,o,v;for(var t=0,s,p=r.length;t<p;t++){s=r[t];o=u;u=u.childNodes[s];if(!u){v=s;break}}if(q){if(u){k.setStartBefore(u)}else{k.setStart(o,v)}}else{if(u){k.setEndBefore(u)}else{k.setEnd(o,v)}}}m(n.startAddress,true);!l&&n.endAddress&&m(n.endAddress);return k},equals:function(k){for(var l in this){if(this.hasOwnProperty(l)){if(this[l]!==k[l]){return false}}}return true}}})();(function(){function d(p,g){var h=domUtils.getNodeIndex;p=p.duplicate();p.collapse(g);var t=p.parentElement();if(!t.hasChildNodes()){return{container:t,offset:0}}var s=t.children,j,l=p.duplicate(),u=0,o=s.length-1,q=-1,f;while(u<=o){q=Math.floor((u+o)/2);j=s[q];l.moveToElementText(j);var n=l.compareEndPoints("StartToStart",p);if(n>0){o=q-1}else{if(n<0){u=q+1}else{return{container:t,offset:h(j)}}}}if(q==-1){l.moveToElementText(t);l.setEndPoint("StartToStart",p);f=l.text.replace(/(\r\n|\r)/g,"\n").length;s=t.childNodes;if(!f){j=s[s.length-1];return{container:j,offset:j.nodeValue.length}}var m=s.length;while(f>0){f-=s[--m].nodeValue.length}return{container:s[m],offset:-f}}l.collapse(n>0);l.setEndPoint(n>0?"StartToStart":"EndToStart",p);f=l.text.replace(/(\r\n|\r)/g,"\n").length;if(!f){return dtd.$empty[j.tagName]||dtd.$nonChild[j.tagName]?{container:t,offset:h(j)+(n>0?0:1)}:{container:j,offset:n>0?0:j.childNodes.length}}while(f>0){try{var k=j;j=j[n>0?"previousSibling":"nextSibling"];f-=j.nodeValue.length}catch(r){return{container:t,offset:h(k)}}}return{container:j,offset:n>0?-f:j.nodeValue.length+f}}function c(g,f){if(g.item){f.selectNode(g.item(0))}else{var e=d(g,true);f.setStart(e.container,e.offset);if(g.compareEndPoints("StartToEnd",g)!=0){e=d(g,false);f.setEnd(e.container,e.offset)}}return f}function b(h){var g;try{g=h.getNative().createRange()}catch(i){return null}var f=g.item?g.item(0):g.parentElement();if((f.ownerDocument||f)===h.document){return g}return null}var a=dom.Selection=function(g){var f=this,e;f.document=g;if(ie){e=domUtils.getWindow(g).frameElement;domUtils.on(e,"beforedeactivate",function(){f._bakIERange=f.getIERange()});domUtils.on(e,"activate",function(){try{if(!b(f)&&f._bakIERange){f._bakIERange.select()}}catch(h){}f._bakIERange=null})}e=g=null};a.prototype={getNative:function(){var g=this.document;try{return !g?null:ie?g.selection:domUtils.getWindow(g).getSelection()}catch(f){return null}},getIERange:function(){var e=b(this);if(!e){if(this._bakIERange){return this._bakIERange}}return e},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath){return this._cachedStartElementPath}var e=this.getStart();if(e){return domUtils.findParents(e,true,null,true)}return[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return browser.ie&&b(this)||!browser.ie&&this.getNative().rangeCount?true:false}catch(f){return false}},getRange:function(){var i=this;function h(e){var o=i.document.body.firstChild,n=e.collapsed;while(o&&o.firstChild){e.setStart(o,0);o=o.firstChild}if(!e.startContainer){e.setStart(i.document.body,0)}if(n){e.collapse(true)}}if(i._cachedRange!=null){return this._cachedRange}var g=new baidu.editor.dom.Range(i.document);if(ie){var k=i.getIERange();if(k){try{c(k,g)}catch(l){h(g)}}else{h(g)}}else{var j=i.getNative();if(j&&j.rangeCount){var f=j.getRangeAt(0);var m=j.getRangeAt(j.rangeCount-1);g.setStart(f.startContainer,f.startOffset).setEnd(m.endContainer,m.endOffset);if(g.collapsed&&domUtils.isBody(g.startContainer)&&!g.startOffset){h(g)}}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document)){return this._bakRange}h(g)}}return this._bakRange=g},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement}var e=ie?this.getIERange():this.getRange(),h,i,f,g;if(ie){if(!e){return this.document.body.firstChild}if(e.item){return e.item(0)}h=e.duplicate();h.text.length>0&&h.moveStart("character",1);h.collapse(1);i=h.parentElement();g=f=e.parentElement();while(f=f.parentNode){if(f==i){i=g;break}}}else{e.shrinkBoundary();i=e.startContainer;if(i.nodeType==1&&i.hasChildNodes()){i=i.childNodes[Math.min(i.childNodes.length-1,e.startOffset)]}if(i.nodeType==3){return i.parentNode}}return i},getText:function(){var e,f;if(this.isFocus()&&(e=this.getNative())){f=browser.ie?e.createRange():e.getRangeAt(0);return browser.ie?f.text:f.toString()}return""},clearRange:function(){this.getNative()[browser.ie?"empty":"removeAllRanges"]()}}})();(function(){var d=0,b;function c(m){var l=m.getElementsByTagName("img"),k;for(var j=0,h;h=l[j++];){if(k=h.getAttribute("orgSrc")){h.src=k;h.removeAttribute("orgSrc")}}var g=m.getElementsByTagName("a");for(var j=0,f;f=g[j++];j++){if(f.getAttribute("data_ue_src")){f.setAttribute("href",f.getAttribute("data_ue_src"))}}}function e(l,k){var f;if(k.textarea){if(utils.isString(k.textarea)){for(var h=0,j,g=domUtils.getElementsByTagName(l,"textarea");j=g[h++];){if(j.id=="ueditor_textarea_"+k.options.textarea){f=j;break}}}else{f=k.textarea}}if(!f){l.appendChild(f=domUtils.createElement(document,"textarea",{name:k.options.textarea,id:"ueditor_textarea_"+k.options.textarea,style:"display:none"}));k.textarea=f}f.value=k.hasContents()?(k.options.allHtmlEnabled?k.getAllHtml():k.getContent(null,null,true)):""}var a=UE.Editor=function(f){var g=this;g.uid=d++;EventBase.call(g);g.commands={};g.options=utils.extend(utils.clone(f||{}),UEDITOR_CONFIG,true);g.shortcutkeys={};g.setOpt({isShow:true,initialContent:"\u6b22\u8fce\u4f7f\u7528ueditor!",autoClearinitialContent:false,iframeCssUrl:g.options.UEDITOR_HOME_URL+"themes/iframe.css",textarea:"editorValue",focus:false,initialFrameWidth:1000,initialFrameHeight:g.options.minFrameHeight||320,minFrameWidth:800,minFrameHeight:220,autoClearEmptyNode:true,fullscreen:false,readonly:false,zIndex:999,imagePopup:true,enterTag:"p",pageBreakTag:"_baidu_page_break_tag_",customDomain:false,lang:"zh-cn",langPath:g.options.UEDITOR_HOME_URL+"lang/",theme:"default",themePath:g.options.UEDITOR_HOME_URL+"themes/",allHtmlEnabled:false,scaleEnabled:false,tableNativeEditInFF:false});utils.loadFile(document,{src:g.options.langPath+g.options.lang+"/"+g.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){for(var h in UE.plugins){UE.plugins[h].call(g)}g.langIsReady=true;g.fireEvent("langReady")});UE.instants["ueditorInstant"+g.uid]=g};a.prototype={ready:function(f){var g=this;if(f){g.isReady?f.apply(g):g.addListener("ready",f)}},setOpt:function(f,h){var g={};if(utils.isString(f)){g[f]=h}else{g=f}utils.extend(this.options,g,true)},destroy:function(){var i=this;i.fireEvent("destroy");var g=i.container.parentNode;var f=i.textarea;if(!f){f=document.createElement("textarea");g.parentNode.insertBefore(f,g)}else{f.style.display=""}f.style.width=g.offsetWidth+"px";f.style.height=g.offsetHeight+"px";f.value=i.getContent();f.id=i.key;g.innerHTML="";domUtils.remove(g);var h=i.key;for(var j in i){if(i.hasOwnProperty(j)){delete this[j]}}UE.delEditor(h)},render:function(g){var j=this,h=j.options;if(utils.isString(g)){g=document.getElementById(g)}if(g){var f=ie&&browser.version<9,i=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml'"+(!f?" class='view'":"")+"><head>"+(h.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(h.iframeCssUrl)+"'/>":"")+"<style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:100%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}"+(h.initialStyle||"")+"</style></head><body"+(f?" class='view'":"")+"></body>";if(h.customDomain&&document.domain!=location.hostname){i+="<script>window.parent.UE.instants['ueditorInstant"+j.uid+"']._setup(document);<\/script></html>";g.appendChild(domUtils.createElement(document,"iframe",{id:"baidu_editor_"+j.uid,width:"100%",height:"100%",frameborder:"0",src:'javascript:void(function(){document.open();document.domain="'+document.domain+'";document.write("'+i+'");document.close();}())'}))}else{g.innerHTML='<iframe id="baidu_editor_'+this.uid+'"width="100%" height="100%" scroll="no" frameborder="0" ></iframe>';var k=g.firstChild.contentWindow.document;k.open();k.write(i+"</html>");k.close();j._setup(k)}g.style.overflow="hidden"}},_setup:function(k){var i=this,f=i.options;if(ie){k.body.disabled=true;k.body.contentEditable=true;k.body.disabled=false}else{k.body.contentEditable=true;k.body.spellcheck=false}i.document=k;i.window=k.defaultView||k.parentWindow;i.iframe=i.window.frameElement;i.body=k.body;i.setHeight(Math.max(f.minFrameHeight,f.initialFrameHeight));i.selection=new dom.Selection(k);var l;if(browser.gecko&&(l=this.selection.getNative())){l.removeAllRanges()}this._initEvents();if(f.initialContent){if(f.autoClearinitialContent){var g=i.execCommand;i.execCommand=function(){i.fireEvent("firstBeforeExecCommand");return g.apply(i,arguments)};this._setDefaultContent(f.initialContent)}else{this.setContent(f.initialContent,false,true)}}for(var h=this.iframe.parentNode;!domUtils.isBody(h);h=h.parentNode){if(h.tagName=="FORM"){domUtils.on(h,"submit",function(){e(this,i)});break}}if(domUtils.isEmptyNode(i.body)){i.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"}if(f.focus){setTimeout(function(){i.focus();!i.options.autoClearinitialContent&&i._selectionChange()},0)}if(!i.container){i.container=this.iframe.parentNode}if(f.fullscreen&&i.ui){i.ui.setFullScreen(true)}try{i.document.execCommand("2D-position",false,false)}catch(j){}try{i.document.execCommand("enableInlineTableEditing",false,false)}catch(j){}try{i.document.execCommand("enableObjectResizing",false,false)}catch(j){}i._bindshortcutKeys();i.isReady=1;i.fireEvent("ready");f.onready&&f.onready.call(i);if(!browser.ie){domUtils.on(i.window,["blur","focus"],function(m){if(m.type=="blur"){i._bakRange=i.selection.getRange();try{i.selection.getNative().removeAllRanges()}catch(m){}}else{try{i._bakRange&&i._bakRange.select()}catch(m){}}})}if(browser.gecko&&browser.version<=10902){i.body.contentEditable=false;setTimeout(function(){i.body.contentEditable=true},100);setInterval(function(){i.body.style.height=i.iframe.offsetHeight-20+"px"},100)}!f.isShow&&i.setHide();f.readonly&&i.setDisabled()},sync:function(h){var g=this,f=h?document.getElementById(h):domUtils.findParent(g.iframe.parentNode,function(i){return i.tagName=="FORM"},true);f&&e(f,g)},setHeight:function(f){if(f!==parseInt(this.iframe.parentNode.style.height)){this.iframe.parentNode.style.height=f+"px"}this.document.body.style.height=f-20+"px"},addshortcutkey:function(g,f){var h={};if(f){h[g]=f}else{h=g}utils.extend(this.shortcutkeys,h)},_bindshortcutKeys:function(){var g=this,f=this.shortcutkeys;g.addListener("keydown",function(n,m){var p=m.keyCode||m.which;for(var k in f){var l=f[k].split(",");for(var q=0,h;h=l[q++];){h=h.split(":");var o=h[0],j=h[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(o.toLowerCase())||/^(\d+)$/.test(o)){if(((RegExp.$1=="ctrl"?(m.ctrlKey||m.metaKey):0)&&(RegExp.$2!=""?m[RegExp.$2.slice(1)+"Key"]:1)&&p==RegExp.$3)||p==RegExp.$1){g.execCommand(k,j);domUtils.preventDefault(m)}}}}})},getContent:function(i,n,f){var m=this;if(i&&utils.isFunction(i)){n=i;i=""}if(n?!n():!this.hasContents()){return""}var k=m.selection.getRange(),o=k.createAddress();m.fireEvent("beforegetcontent",i);var g=new RegExp(domUtils.fillChar,"g"),j=m.body.innerHTML.replace(g,"").replace(/>[\t\r\n]*?</g,"><");m.fireEvent("aftergetcontent",i);try{k.moveToAddress(o).select(true)}catch(l){}if(m.serialize){var h=m.serialize.parseHTML(j);h=m.serialize.transformOutput(h);j=m.serialize.toHTML(h)}if(ie&&f){j=j.replace(/<p>\s*?<\/p>/g,"<p>&nbsp;</p>")}else{j=j.replace(/(&nbsp;)+/g,function(r){for(var q=0,t=[],p=r.split(";").length-1;q<p;q++){t.push(q%2==0?" ":"&nbsp;")}return t.join("")})}return j},getAllHtml:function(){var h=this,g=[],f="";h.fireEvent("getAllHtml",g);if(browser.ie&&browser.version>8){var i="";utils.each(h.document.styleSheets,function(j){i+=(j.href?'<link rel="stylesheet" type="text/css" href="'+j.href+'" />':"<style>"+j.cssText+"</style>")});utils.each(h.document.getElementsByTagName("script"),function(j){i+=j.outerHTML})}return"<html><head>"+(h.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+h.options.charset+'"/>':"")+(i||h.document.getElementsByTagName("head")[0].innerHTML)+g.join("\n")+"</head><body "+(ie&&browser.version<9?'class="view"':"")+">"+h.getContent(null,null,true)+"</body></html>"},getPlainTxt:function(){var g=new RegExp(domUtils.fillChar,"g"),f=this.body.innerHTML.replace(/[\n\r]/g,"");f=f.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(i,h,j){return dtd.$block[j]?"\n":h?h:""});return f.replace(g,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var f=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(f,"").replace(/\u00a0/g," ")},setContent:function(l,o,j){var q=this,n=utils.extend({a:1,A:1},dtd.$inline,true),k;l=l.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>(?:(\s|&nbsp;)*?)</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(s,p,t){if(p){k=t}else{p=k}return !n[p]&&!n[t]?s.replace(/>[ \t\r\n]*?</,"><"):s});l={html:l};q.fireEvent("beforesetcontent",l);l=l.html;var r=this.serialize;if(r){var i=r.parseHTML(l);i=r.transformInput(i);i=r.filter(i);l=r.toHTML(i)}this.body.innerHTML=(o?this.getContent():"")+l.replace(new RegExp("[\r"+domUtils.fillChar+"]*","g"),"");if(browser.ie&&browser.version<7){c(this.document.body)}if(q.options.enterTag=="p"){var g=this.body.firstChild,h;if(!g||g.nodeType==1&&(dtd.$cdata[g.tagName]||domUtils.isCustomeNode(g))&&g===this.body.lastChild){this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML}else{var f=q.document.createElement("p");while(g){while(g&&(g.nodeType==3||g.nodeType==1&&dtd.p[g.tagName]&&!dtd.$cdata[g.tagName])){h=g.nextSibling;f.appendChild(g);g=h}if(f.firstChild){if(!g){q.body.appendChild(f);break}else{g.parentNode.insertBefore(f,g);f=q.document.createElement("p")}}g=g.nextSibling}}}q.fireEvent("aftersetcontent");q.fireEvent("contentchange");!j&&q._selectionChange();q._bakRange=q._bakIERange=null;var m;if(browser.gecko&&(m=this.selection.getNative())){m.removeAllRanges()}},focus:function(i){try{var g=this,f=g.selection.getRange();if(i){f.setStartAtLast(g.body.lastChild).setCursor(false,true)}else{f.select(true)}}catch(h){}},_initEvents:function(){var g=this,k=g.document,j=g.window;g._proxyDomEvent=utils.bind(g._proxyDomEvent,g);domUtils.on(k,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],g._proxyDomEvent);domUtils.on(j,["focus","blur"],g._proxyDomEvent);domUtils.on(k,["mouseup","keydown"],function(l){if(l.type=="keydown"&&(l.ctrlKey||l.metaKey||l.shiftKey||l.altKey)){return}if(l.button==2){return}g._selectionChange(250,l)});var f=0,h=browser.ie?g.body:g.document,i;domUtils.on(h,"dragstart",function(){f=1});domUtils.on(h,browser.webkit?"dragover":"drop",function(){return browser.webkit?function(){clearTimeout(i);i=setTimeout(function(){if(!f){var p=g.selection,l=p.getRange();if(l){var m=l.getCommonAncestor();if(m&&g.serialize){var o=g.serialize,n=o.filter(o.transformInput(o.parseHTML(o.word(m.innerHTML))));m.innerHTML=o.toHTML(n)}}}f=0},200)}:function(l){if(!f){l.preventDefault?l.preventDefault():(l.returnValue=false)}f=0}}())},_proxyDomEvent:function(f){return this.fireEvent(f.type.replace(/^on/,""),f)},_selectionChange:function(i,f){var l=this;var k=false;var j,h;if(browser.ie&&browser.version<9&&f&&f.type=="mouseup"){var g=this.selection.getRange();if(!g.collapsed){k=true;j=f.clientX;h=f.clientY}}clearTimeout(b);b=setTimeout(function(){if(!l.selection.getNative()){return}var n;if(k&&l.selection.getNative().type=="None"){n=l.document.body.createTextRange();try{n.moveToPoint(j,h)}catch(m){n=null}}var o;if(n){o=l.selection.getIERange;l.selection.getIERange=function(){return n}}l.selection.cache();if(o){l.selection.getIERange=o}if(l.selection._cachedRange&&l.selection._cachedStartElement){l.fireEvent("beforeselectionchange");l.fireEvent("selectionchange",!!f);l.fireEvent("afterselectionchange");l.selection.clear()}},i||50)},_callCmdFn:function(j,g){var f=g[0].toLowerCase(),i,h;i=this.commands[f]||UE.commands[f];h=i&&i[j];if((!i||!h)&&j=="queryCommandState"){return 0}else{if(h){return h.apply(this,g)}}},execCommand:function(g){g=g.toLowerCase();var h=this,f,i=h.commands[g]||UE.commands[g];if(!i||!i.execCommand){return null}if(!i.notNeedUndo&&!h.__hasEnterExecCommand){h.__hasEnterExecCommand=true;if(h.queryCommandState(g)!=-1){h.fireEvent("beforeexeccommand",g);f=this._callCmdFn("execCommand",arguments);!h._ignoreContentChange&&h.fireEvent("contentchange");h.fireEvent("afterexeccommand",g)}h.__hasEnterExecCommand=false}else{f=this._callCmdFn("execCommand",arguments);!h._ignoreContentChange&&h.fireEvent("contentchange")}!h._ignoreContentChange&&h._selectionChange();return f},queryCommandState:function(f){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(f){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(g){if(g){for(var j=0,h;h=g[j++];){if(this.document.getElementsByTagName(h).length>0){return true}}}if(!domUtils.isEmptyBlock(this.body)){return true}g=["div"];for(j=0;h=g[j++];){var f=domUtils.getElementsByTagName(this.document,h);for(var l=0,k;k=f[l++];){if(domUtils.isCustomeNode(k)){return true}}}return false},reset:function(){this.fireEvent("reset")},setEnabled:function(){var g=this,f;if(g.body.contentEditable=="false"){g.body.contentEditable=true;f=g.selection.getRange();try{f.moveToBookmark(g.lastBk);delete g.lastBk}catch(h){f.setStartAtFirst(g.body).collapse(true)}f.select(true);if(g.bkqueryCommandState){g.queryCommandState=g.bkqueryCommandState;delete g.bkqueryCommandState}g.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(f){var g=this;f=f?utils.isArray(f)?f:[f]:[];if(g.body.contentEditable=="true"){if(!g.lastBk){g.lastBk=g.selection.getRange().createBookmark(true)}g.body.contentEditable=false;g.bkqueryCommandState=g.queryCommandState;g.queryCommandState=function(h){if(utils.indexOf(f,h)!=-1){return g.bkqueryCommandState.apply(g,arguments)}return -1};g.fireEvent("selectionchange")}},disable:function(f){return this.setDisabled(f)},_setDefaultContent:function(){function f(){var g=this;if(g.document.getElementById("initContent")){g.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";g.removeListener("firstBeforeExecCommand focus",f);setTimeout(function(){g.focus();g._selectionChange()},0)}}return function(g){var h=this;h.body.innerHTML='<p id="initContent">'+g+"</p>";if(browser.ie&&browser.version<7){c(h.body)}h.addListener("firstBeforeExecCommand focus",f)}}(),setShow:function(){var g=this,f=g.selection.getRange();if(g.container.style.display=="none"){try{f.moveToBookmark(g.lastBk);delete g.lastBk}catch(h){f.setStartAtFirst(g.body).collapse(true)}setTimeout(function(){f.select(true)},100);g.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var f=this;if(!f.lastBk){f.lastBk=f.selection.getRange().createBookmark(true)}f.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(h){var j=UE.I18N[this.options.lang];if(!j){throw Error("not import language file")}h=(h||"").split(".");for(var g=0,f;f=h[g++];){j=j[f];if(!j){break}}return j},getContentLength:function(g,f){var k=this.getContent().length;if(g){f=(f||[]).concat(["hr","img","iframe"]);k=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var j=0,h;h=f[j++];){k+=this.document.getElementsByTagName(h).length}}return k}};utils.inherits(a,EventBase)})();UE.plugins.keystrokes=function(){var a=this;a.addListener("keydown",function(b,m){var g=m.keyCode||m.which,e=a.selection.getRange();if(!e.collapsed&&!(m.ctrlKey||m.metaKey||m.shiftKey||m.altKey||g==9)){var t=e.startContainer;if(domUtils.isFillChar(t)){e.setStartBefore(t)}t=e.endContainer;if(domUtils.isFillChar(t)){e.setEndAfter(t)}e.txtToElmBoundary();if(e.endContainer&&e.endContainer.nodeType==1){t=e.endContainer.childNodes[e.endOffset];if(t&&domUtils.isBr(t)){e.setEndAfter(t)}}if(e.startOffset==0){t=e.startContainer;if(domUtils.isBoundaryNode(t,"firstChild")){t=e.endContainer;if(e.endOffset==(t.nodeType==3?t.nodeValue.length:t.childNodes.length)&&domUtils.isBoundaryNode(t,"lastChild")){a.fireEvent("saveScene");a.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";e.setStart(a.body.firstChild,0).setCursor(false,true);browser.ie&&a._selectionChange();domUtils.preventDefault(m);return}}}}if(g==8){var d,c;if(e.inFillChar()){d=e.startContainer;e.setStartBefore(d).shrinkBoundary(true).collapse(true);if(domUtils.isFillChar(d)){domUtils.remove(d)}else{d.nodeValue=d.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"")}}if(d=e.getClosedNode()){a.fireEvent("saveScene");e.setStartBefore(d);domUtils.remove(d);e.setCursor();a.fireEvent("saveScene");domUtils.preventDefault(m);return}if(!browser.ie){d=domUtils.findParentByTagName(e.startContainer,"table",true);c=domUtils.findParentByTagName(e.endContainer,"table",true);if(d&&!c||!d&&c||d!==c){m.preventDefault();return}}}if(g==9){var h={ol:1,ul:1,table:1};if(a.fireEvent("tabkeydown")){domUtils.preventDefault(m);return}range=a.selection.getRange();a.fireEvent("saveScene");for(var s=0,k="",n=a.options.tabSize||4,q=a.options.tabNode||"&nbsp;";s<n;s++){k+=q}var r=a.document.createElement("span");r.innerHTML=k+domUtils.fillChar;if(range.collapsed){range.insertNode(r.cloneNode(true).firstChild).setCursor(true)}else{d=domUtils.findParent(range.startContainer,l);c=domUtils.findParent(range.endContainer,l);if(d&&c&&d===c){range.deleteContents();range.insertNode(r.cloneNode(true).firstChild).setCursor(true)}else{var f=range.createBookmark(),l=function(i){return domUtils.isBlockElm(i)&&!h[i.tagName.toLowerCase()]};range.enlarge(true);var o=range.createBookmark(),p=domUtils.getNextDomNode(o.start,false,l);while(p&&!(domUtils.getPosition(p,o.end)&domUtils.POSITION_FOLLOWING)){p.insertBefore(r.cloneNode(true).firstChild,p.firstChild);p=domUtils.getNextDomNode(p,false,l)}range.moveToBookmark(o).moveToBookmark(f).select()}}domUtils.preventDefault(m)}if(browser.gecko&&g==46){range=a.selection.getRange();if(range.collapsed){d=range.startContainer;if(domUtils.isEmptyBlock(d)){var j=d.parentNode;while(domUtils.getChildCount(j)==1&&!domUtils.isBody(j)){d=j;j=j.parentNode}if(d===j.lastChild){m.preventDefault()}return}}}});a.addListener("keyup",function(e,c){var f=c.keyCode||c.which,b;if(f==8){b=a.selection.getRange();if(b.collapsed&&domUtils.isBody(b.startContainer)){var d=domUtils.createElement(a.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});b.insertNode(d).setStart(d,0).setCursor(false,true)}if(browser.chrome&&b.collapsed&&b.startContainer.nodeType==1&&domUtils.isEmptyBlock(b.startContainer)){b.select(true)}}})};UE.plugins.fiximgclick=function(){var a=this;if(browser.webkit){a.addListener("click",function(c,d){if(d.target.tagName=="IMG"){var b=new dom.Range(a.document);b.selectNode(d.target).select()}})}};UE.plugins.enterkey=function(){var b,c=this,a=c.options.enterTag;c.addListener("keyup",function(l,m){var n=m.keyCode||m.which;if(n==13){var k=c.selection.getRange(),g=k.startContainer,d;if(!browser.ie){if(/h\d/i.test(b)){if(browser.gecko){var j=domUtils.findParentByTagName(g,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],true);if(!j){c.document.execCommand("formatBlock",false,"<p>");d=1}}else{if(g.nodeType==1){var i=c.document.createTextNode(""),e;k.insertNode(i);e=domUtils.findParentByTagName(i,"div",true);if(e){var f=c.document.createElement("p");while(e.firstChild){f.appendChild(e.firstChild)}e.parentNode.insertBefore(f,e);domUtils.remove(e);k.setStartBefore(i).setCursor();d=1}domUtils.remove(i)}}if(c.undoManger&&d){c.undoManger.save()}}browser.opera&&k.select()}setTimeout(function(){c.selection.getRange().scrollToView(c.autoHeightEnabled,c.autoHeightEnabled?domUtils.getXY(c.iframe).y:0)},50)}});c.addListener("keydown",function(i,k){var m=k.keyCode||k.which;if(m==13){if(c.undoManger){c.undoManger.save()}b="";var f=c.selection.getRange();if(!f.collapsed){var d=f.startContainer,e=f.endContainer,g=domUtils.findParentByTagName(d,"td",true),h=domUtils.findParentByTagName(e,"td",true);if(g&&h&&g!==h||!g&&h||g&&!h){k.preventDefault?k.preventDefault():(k.returnValue=false);return}}if(a=="p"){if(!browser.ie){d=domUtils.findParentByTagName(f.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],true);if(!d&&!browser.opera){c.document.execCommand("formatBlock",false,"<p>");if(browser.gecko){f=c.selection.getRange();d=domUtils.findParentByTagName(f.startContainer,"p",true);d&&domUtils.removeDirtyAttr(d)}}else{b=d.tagName;d.tagName.toLowerCase()=="p"&&browser.gecko&&domUtils.removeDirtyAttr(d)}}}else{k.preventDefault?k.preventDefault():(k.returnValue=false);if(!f.collapsed){f.deleteContents();d=f.startContainer;if(d.nodeType==1&&(d=d.childNodes[f.startOffset])){while(d.nodeType==1){if(dtd.$empty[d.tagName]){f.setStartBefore(d).setCursor();if(c.undoManger){c.undoManger.save()}return false}if(!d.firstChild){var l=f.document.createElement("br");d.appendChild(l);f.setStart(d,0).setCursor();if(c.undoManger){c.undoManger.save()}return false}d=d.firstChild}if(d===f.startContainer.childNodes[f.startOffset]){l=f.document.createElement("br");f.insertNode(l).setCursor()}else{f.setStart(d,0).setCursor()}}else{l=f.document.createElement("br");f.insertNode(l).setStartAfter(l).setCursor()}}else{l=f.document.createElement("br");f.insertNode(l);var j=l.parentNode;if(j.lastChild===l){l.parentNode.insertBefore(l.cloneNode(true),l);f.setStartBefore(l)}else{f.setStartAfter(l)}f.setCursor()}}}})};UE.plugins.contextmenu=function(){var c=this,e=c.getLang("contextMenu"),d,a=c.options.contextMenu||[{label:e.selectall,cmdName:"selectall"},{label:e.deletecode,cmdName:"highlightcode",icon:"deletehighlightcode"},{label:e.cleardoc,cmdName:"cleardoc",exec:function(){if(confirm(e.confirmclear)){this.execCommand("cleardoc")}}},"-",{label:e.unlink,cmdName:"unlink"},"-",{group:e.paragraph,icon:"justifyjustify",subMenu:[{label:e.justifyleft,cmdName:"justify",value:"left"},{label:e.justifyright,cmdName:"justify",value:"right"},{label:e.justifycenter,cmdName:"justify",value:"center"},{label:e.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:e.table,icon:"table",subMenu:[{label:e.inserttable,cmdName:"inserttable"},{label:e.deletetable,cmdName:"deletetable"},"-",{label:e.deleterow,cmdName:"deleterow"},{label:e.deletecol,cmdName:"deletecol"},{label:e.insertcol,cmdName:"insertcol"},{label:e.insertcolnext,cmdName:"insertcolnext"},{label:e.insertrow,cmdName:"insertrow"},{label:e.insertrownext,cmdName:"insertrownext"},"-",{label:e.insertcaption,cmdName:"insertcaption"},{label:e.deletecaption,cmdName:"deletecaption"},{label:e.inserttitle,cmdName:"inserttitle"},{label:e.deletetitle,cmdName:"deletetitle"},"-",{label:e.mergecells,cmdName:"mergecells"},{label:e.mergeright,cmdName:"mergeright"},{label:e.mergedown,cmdName:"mergedown"},"-",{label:e.splittorows,cmdName:"splittorows"},{label:e.splittocols,cmdName:"splittocols"},{label:e.splittocells,cmdName:"splittocells"},"-",{label:e.averageDiseRow,cmdName:"averagedistributerow"},{label:e.averageDisCol,cmdName:"averagedistributecol"},"-",{label:e.edittd,cmdName:"edittd",exec:function(){if(UE.ui.edittd){new UE.ui.edittd(this)}this.getDialog("edittd").open()}},{label:e.edittable,cmdName:"edittable",exec:function(){if(UE.ui.edittable){new UE.ui.edittable(this)}this.getDialog("edittable").open()}}]},{group:e.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:e.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",label:e.tableleft,value:["float","left"]},{cmdName:"tablealignment",label:e.tablecenter,value:["margin","0 auto"]},{cmdName:"tablealignment",label:e.tableright,value:["float","right"]}]},"-",{label:e.insertparagraphbefore,cmdName:"insertparagraph",value:true},{label:e.insertparagraphafter,cmdName:"insertparagraph"},{label:e.copy,cmdName:"copy",exec:function(){alert(e.copymsg)},query:function(){return 0}},{label:e.paste,cmdName:"paste",exec:function(){alert(e.pastemsg)},query:function(){return 0}},{label:e.highlightcode,cmdName:"highlightcode",exec:function(){if(UE.ui.highlightcode){new UE.ui.highlightcode(this)}this.ui._dialogs.highlightcodeDialog.open()}}];if(!a.length){return}var b=UE.ui.uiUtils;c.addListener("contextmenu",function(m,o){var h=b.getViewportOffsetByEvent(o);c.fireEvent("beforeselectionchange");if(d){d.destroy()}for(var j=0,f,p=[];f=a[j];j++){var n;(function(s){if(s=="-"){if((n=p[p.length-1])&&n!=="-"){p.push("-")}}else{if(s.hasOwnProperty("group")){for(var r=0,q,i=[];q=s.subMenu[r];r++){(function(u){if(u=="-"){if((n=i[i.length-1])&&n!=="-"){i.push("-")}else{i.splice(i.length-1)}}else{if((c.commands[u.cmdName]||UE.commands[u.cmdName]||u.query)&&(u.query?u.query():c.queryCommandState(u.cmdName))>-1){i.push({label:u.label||c.getLang("contextMenu."+u.cmdName+(u.value||""))||"",className:"edui-for-"+u.cmdName,onclick:u.exec?function(){u.exec.call(c)}:function(){c.execCommand(u.cmdName,u.value)}})}}})(q)}if(i.length){function t(){switch(s.icon){case"table":return c.getLang("contextMenu.table");case"justifyjustify":return c.getLang("contextMenu.paragraph");case"aligntd":return c.getLang("contextMenu.aligntd");case"aligntable":return c.getLang("contextMenu.aligntable");default:return""}}p.push({label:t(),className:"edui-for-"+s.icon,subMenu:{items:i,editor:c}})}}else{if((c.commands[s.cmdName]||UE.commands[s.cmdName]||s.query)&&(s.query?s.query.call(c):c.queryCommandState(s.cmdName))>-1){if(s.cmdName=="highlightcode"){if(c.queryCommandState(s.cmdName)==1&&s.icon!="deletehighlightcode"){return}if(c.queryCommandState(s.cmdName)!=1&&s.icon=="deletehighlightcode"){return}}p.push({label:s.label||c.getLang("contextMenu."+s.cmdName),className:"edui-for-"+(s.icon?s.icon:s.cmdName+(s.value||"")),onclick:s.exec?function(){s.exec.call(c)}:function(){c.execCommand(s.cmdName,s.value)}})}}}})(f)}if(p[p.length-1]=="-"){p.pop()}d=new UE.ui.Menu({items:p,editor:c});d.render();d.showAt(h);domUtils.preventDefault(o);if(browser.ie){var g;try{g=c.selection.getNative().createRange()}catch(l){return}if(g.item){var k=new dom.Range(c.document);k.selectNode(g.item(0)).select(true,true)}}})};(function(){function a(f){var d=this.document;if(d.getElementById("baidu_pastebin")){return}var c=this.selection.getRange(),b=c.createBookmark(),e=d.createElement("div");e.id="baidu_pastebin";browser.webkit&&e.appendChild(d.createTextNode(domUtils.fillChar+domUtils.fillChar));d.body.appendChild(e);b.start.style.display="";e.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(b.start).y+"px";c.selectNodeContents(e).select(true);setTimeout(function(){if(browser.webkit){for(var g=0,h=d.querySelectorAll("#baidu_pastebin"),k;k=h[g++];){if(domUtils.isEmptyNode(k)){domUtils.remove(k)}else{e=k;break}}}try{e.parentNode.removeChild(e)}catch(j){}c.moveToBookmark(b).select(true);f(e)},0)}UE.plugins.paste=function(){var h=this;var g={flag:""};var f=h.options.pasteplain===true;var b={flag:""};h.commands.pasteplain={queryCommandState:function(){return f},execCommand:function(){f=!f|0},notNeedUndo:1};var e,i,c;function d(s){var r;if(s.firstChild){var v=domUtils.getElementsByTagName(s,"span");for(var z=0,m;m=v[z++];){if(m.id=="_baidu_cut_start"||m.id=="_baidu_cut_end"){domUtils.remove(m)}}if(browser.webkit){var t=s.querySelectorAll("div br");for(var z=0,k;k=t[z++];){var q=k.parentNode;if(q.tagName=="DIV"&&q.childNodes.length==1){q.innerHTML="<p><br/></p>";w;domUtils.remove(q)}}var y=s.querySelectorAll("#baidu_pastebin");for(var z=0,A;A=y[z++];){var D=h.document.createElement("p");A.parentNode.insertBefore(D,A);while(A.firstChild){D.appendChild(A.firstChild)}domUtils.remove(A)}var j=s.querySelectorAll("meta");for(var z=0,p;p=j[z++];){domUtils.remove(p)}var t=s.querySelectorAll("br");for(z=0;p=t[z++];){if(/^apple-/.test(p)){domUtils.remove(p)}}utils.each(domUtils.getElementsByTagName(s,"span",function(E){if(E.style.cssText){E.style.cssText=E.style.cssText.replace(/white-space[^;]+;/g,"");if(!E.style.cssText){domUtils.removeAttributes(E,"style");if(domUtils.hasNoAttributes(E)){return 1}}}return 0}),function(E){domUtils.remove(E,true)})}if(browser.gecko){var u=s.querySelectorAll("[_moz_dirty]");for(z=0;p=u[z++];){p.removeAttribute("_moz_dirty")}}if(!browser.ie){var o=s.querySelectorAll("span.Apple-style-span");for(var z=0,p;p=o[z++];){domUtils.remove(p,true)}}r=s.innerHTML.replace(/>(?:(\s|&nbsp;)*?)</g,"><");var B=h.serialize;if(B){try{r=UE.filterWord(r);var x=B.transformInput(B.parseHTML(r),g);x=B.filter(x,f?{whiteList:{p:{br:1,BR:1,$:{}},br:{"$":{}},div:{br:1,BR:1,"$":{}},li:{"$":{}},tr:{td:1,"$":{}},td:{"$":{}}},blackList:{style:1,script:1,object:1}}:null,!f?b:null);if(browser.webkit){var l=x.children.length,n;while((n=x.children[l-1])&&n.tag=="br"){x.children.splice(l-1,1);l=x.children.length}}r=B.toHTML(x,f);e=B.filter(x,{whiteList:{p:{br:1,BR:1,$:{}},br:{"$":{}},div:{br:1,BR:1,"$":{},table:1,ul:1,ol:1},li:{"$":{}},ul:{li:1,"$":{}},ol:{li:1,"$":{}},tr:{td:1,"$":{}},td:{"$":{}},table:{tr:1,tbody:1,td:1,"$":{}},tbody:{tr:1,td:1,"$":{}},h1:{"$":{}},h2:{"$":{}},h3:{"$":{}},h4:{"$":{}},h5:{"$":{}},h6:{"$":{}}},blackList:{style:1,script:1,object:1}});e=B.toHTML(e,true)}catch(C){}}r={html:r,txtContent:e};h.fireEvent("beforepaste",r);if(r.html){i=r.html;c=h.selection.getRange().createAddress(true);h.execCommand("insertHtml",i,true);h.fireEvent("afterpaste")}}}h.addListener("pasteTransfer",function(m,j){if(c&&e&&i&&e!=i){var k=h.selection.getRange();k.moveToAddress(c,true).deleteContents();k.select(true);h.__hasEnterExecCommand=true;var l=i;if(j===2){l=l.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(p,o,r,q){r=r.toLowerCase();if({img:1}[r]){return p}q=q.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(u,s,t){if({src:1,href:1,name:1}[s.toLowerCase()]){return s+"="+t+" "}return""});if({span:1,div:1}[r]){return""}else{return"<"+o+r+" "+utils.trim(q)+">"}})}else{if(j){l=e}}h.execCommand("inserthtml",l,true);h.__hasEnterExecCommand=false;var n=h.selection.getRange().createAddress(true);c.endAddress=n.startAddress}});h.addListener("ready",function(){domUtils.on(h.body,"cut",function(){var j=h.selection.getRange();if(!j.collapsed&&h.undoManger){h.undoManger.save()}});domUtils.on(h.body,browser.ie||browser.opera?"keydown":"paste",function(j){if((browser.ie||browser.opera)&&((!j.ctrlKey&&!j.metaKey)||j.keyCode!="86")){return}a.call(h,function(k){d(k)})})})}})();var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.ui={};(function(){var d=baidu.editor.browser,c=baidu.editor.dom.domUtils;var g="$EDITORUI";var f=window[g]={};var a="ID"+g;var i=0;var b=baidu.editor.ui.uiUtils={uid:function(j){return(j?j[a]||(j[a]=++i):++i)},hook:function(j,l){var k;if(j&&j._callbacks){k=j}else{k=function(){var p;if(j){p=j.apply(this,arguments)}var o=k._callbacks;var m=o.length;while(m--){var n=o[m].apply(this,arguments);if(p===undefined){p=n}}return p};k._callbacks=[]}k._callbacks.push(l);return k},createElementByHtml:function(j){var k=document.createElement("div");k.innerHTML=j;k=k.firstChild;k.parentNode.removeChild(k);return k},getViewportElement:function(){return(d.ie&&d.quirks)?document.body:document.documentElement},getClientRect:function(j){var n;try{n=j.getBoundingClientRect()}catch(m){n={left:0,top:0,height:0,width:0}}var k={left:Math.round(n.left),top:Math.round(n.top),height:Math.round(n.bottom-n.top),width:Math.round(n.right-n.left)};var l;while((l=j.ownerDocument)!==document&&(j=c.getWindow(l).frameElement)){n=j.getBoundingClientRect();k.left+=n.left;k.top+=n.top}k.bottom=k.top+k.height;k.right=k.left+k.width;return k},getViewportRect:function(){var k=b.getViewportElement();var l=(window.innerWidth||k.clientWidth)|0;var j=(window.innerHeight||k.clientHeight)|0;return{left:0,top:0,height:j,width:l,bottom:j,right:l}},setViewportOffset:function(j,m){var k;var l=b.getFixedLayer();if(j.parentNode===l){j.style.left=m.left+"px";j.style.top=m.top+"px"}else{c.setViewportOffset(j,m)}},getEventOffset:function(j){var k=j.target||j.srcElement;var l=b.getClientRect(k);var m=b.getViewportOffsetByEvent(j);return{left:m.left-l.left,top:m.top-l.top}},getViewportOffsetByEvent:function(k){var l=k.target||k.srcElement;var j=c.getWindow(l).frameElement;var n={left:k.clientX,top:k.clientY};if(j&&l.ownerDocument!==document){var m=b.getClientRect(j);n.left+=m.left;n.top+=m.top}return n},setGlobal:function(k,j){f[k]=j;return g+'["'+k+'"]'},unsetGlobal:function(j){delete f[j]},copyAttributes:function(o,n){var l=n.attributes;var j=l.length;while(j--){var m=l[j];if(m.nodeName!="style"&&m.nodeName!="class"&&(!d.ie||m.specified)){o.setAttribute(m.nodeName,m.nodeValue)}}if(n.className){c.addClass(o,n.className)}if(n.style.cssText){o.style.cssText+=";"+n.style.cssText}},removeStyle:function(k,j){if(k.style.removeProperty){k.style.removeProperty(j)}else{if(k.style.removeAttribute){k.style.removeAttribute(j)}else{throw""}}},contains:function(k,j){return k&&j&&(k===j?false:(k.contains?k.contains(j):k.compareDocumentPosition(j)&16))},startDrag:function(r,n,p){var p=p||document;var m=r.clientX;var l=r.clientY;function k(t){var s=t.clientX-m;var u=t.clientY-l;n.ondragmove(s,u);if(t.stopPropagation){t.stopPropagation()}else{t.cancelBubble=true}}if(p.addEventListener){function q(s){p.removeEventListener("mousemove",k,true);p.removeEventListener("mouseup",k,true);window.removeEventListener("mouseup",q,true);n.ondragstop()}p.addEventListener("mousemove",k,true);p.addEventListener("mouseup",q,true);window.addEventListener("mouseup",q,true);r.preventDefault()}else{var o=r.srcElement;o.setCapture();function j(){o.releaseCapture();o.detachEvent("onmousemove",k);o.detachEvent("onmouseup",j);o.detachEvent("onlosecaptrue",j);n.ondragstop()}o.attachEvent("onmousemove",k);o.attachEvent("onmouseup",j);o.attachEvent("onlosecaptrue",j);r.returnValue=false}n.ondragstart()},getFixedLayer:function(){var j=document.getElementById("edui_fixedlayer");if(j==null){j=document.createElement("div");j.id="edui_fixedlayer";document.body.appendChild(j);if(d.ie&&d.version<=8){j.style.position="absolute";h();setTimeout(e)}else{j.style.position="fixed"}j.style.left="0";j.style.top="0";j.style.width="0";j.style.height="0"}return j},makeUnselectable:function(k){if(d.opera||(d.ie&&d.version<9)){k.unselectable="on";if(k.hasChildNodes()){for(var j=0;j<k.childNodes.length;j++){if(k.childNodes[j].nodeType==1){b.makeUnselectable(k.childNodes[j])}}}}else{if(k.style.MozUserSelect!==undefined){k.style.MozUserSelect="none"}else{if(k.style.WebkitUserSelect!==undefined){k.style.WebkitUserSelect="none"}else{if(k.style.KhtmlUserSelect!==undefined){k.style.KhtmlUserSelect="none"}}}}}};function e(){var j=document.getElementById("edui_fixedlayer");b.setViewportOffset(j,{left:0,top:0})}function h(j){c.on(window,"scroll",e);c.on(window,"resize",baidu.editor.utils.defer(e,0,true))}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.EventBase,d=baidu.editor.ui.UIBase=function(){};d.prototype={className:"",uiName:"",initOptions:function(f){var g=this;for(var e in f){g[e]=f[e]}this.id=this.id||"edui"+b.uid()},initUIBase:function(){this._globalKey=a.unhtml(b.setGlobal(this.id,this))},render:function(n){var j=this.renderHtml();var e=b.createElementByHtml(j);var l=domUtils.getElementsByTagName(e,"*");var g="edui-"+(this.theme||this.editor.options.theme);var k=document.getElementById("edui_fixedlayer");for(var h=0,f;f=l[h++];){domUtils.addClass(f,g)}domUtils.addClass(e,g);if(k){k.className="";domUtils.addClass(k,g)}var m=this.getDom();if(m!=null){m.parentNode.replaceChild(e,m);b.copyAttributes(e,m)}else{if(typeof n=="string"){n=document.getElementById(n)}n=n||b.getFixedLayer();domUtils.addClass(n,g);n.appendChild(e)}this.postRender()},getDom:function(e){if(!e){return document.getElementById(this.id)}else{return document.getElementById(this.id+"_"+e)}},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var f="edui-"+this.uiName;return(e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?f+"-":"").replace(/%%/g,(this.uiName?f:"")+" "+this.className).replace(/\$\$/g,this._globalKey))},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();if(e){baidu.editor.dom.domUtils.remove(e)}b.unsetGlobal(this.id)}};a.inherits(d,c)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase,c=baidu.editor.ui.Separator=function(d){this.initOptions(d);this.initSeparator()};c.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};a.inherits(c,b)})();(function(){var b=baidu.editor.utils,a=baidu.editor.dom.domUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.uiUtils;var e=baidu.editor.ui.Mask=function(f){this.initOptions(f);this.initUIBase()};e.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var f=this;a.on(window,"resize",function(){setTimeout(function(){if(!f.isHidden()){f._fill()}})})},show:function(f){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=f},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_fill:function(){var f=this.getDom();var g=c.getViewportRect();f.style.width=g.width+"px";f.style.height=g.height+"px"}};b.inherits(e,d)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,h=baidu.editor.ui.UIBase,g=baidu.editor.ui.Popup=function(i){this.initOptions(i);this.initPopup()};var b=[];function f(j,m){var n=[];for(var l=0;l<b.length;l++){var k=b[l];if(!k.isHidden()){if(k.queryAutoHide(m)!==false){if(j&&/scroll/ig.test(j.type)&&k.className=="edui-wordpastepop"){return}k.hide()}}}}g.postHide=f;var d=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];g.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,canSideUp:true,initPopup:function(){this.initUIBase();b.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){if(this.content){if(typeof this.content=="string"){return this.content}return this.content.renderHtml()}else{return""}},_UIBase_postRender:h.prototype.postRender,postRender:function(){if(this.content instanceof h){this.content.postRender()}this.fireEvent("postRenderAfter");this.hide(true);this._UIBase_postRender()},_doAutoRender:function(){if(!this.getDom()&&this.autoRender){this.render()}},mesureSize:function(){var i=this.getDom("content");return e.getClientRect(i)},fitSize:function(){var i=this.getDom("body");i.style.width="";i.style.height="";var j=this.mesureSize();i.style.width=j.width+"px";i.style.height=j.height+"px";return j},showAnchor:function(j,i){this.showAnchorRect(e.getClientRect(j),i)},showAnchorRect:function(p,m,n){this._doAutoRender();var k=e.getViewportRect();this._show();var j=this.fitSize();var q,l,i,o;if(m){q=this.canSideLeft&&(p.right+j.width>k.right&&p.left>j.width);l=this.canSideUp&&(p.top+j.height>k.bottom&&p.bottom>j.height);i=(q?p.left-j.width:p.right);o=(l?p.bottom-j.height:p.top)}else{q=this.canSideLeft&&(p.right+j.width>k.right&&p.left>j.width);l=this.canSideUp&&(p.top+j.height>k.bottom&&p.bottom>j.height);i=(q?p.right-j.width:p.left);o=(l?p.top-j.height:p.bottom)}var r=this.getDom();e.setViewportOffset(r,{left:i,top:o});a.removeClasses(r,d);r.className+=" "+d[(l?1:0)*2+(q?1:0)];if(this.editor){r.style.zIndex=this.editor.container.style.zIndex*1+10;baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=r.style.zIndex-1}},showAt:function(l){var k=l.left;var j=l.top;var i={left:k,top:j,right:k,bottom:j,height:0,width:0};this.showAnchorRect(i,false,true)},_show:function(){if(this._hidden){var i=this.getDom();i.style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(i){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=true;if(!i){this.fireEvent("hide")}}},queryAutoHide:function(i){return !i||!e.contains(this.getDom(),i)}};c.inherits(g,h);a.on(document,"mousedown",function(i){var j=i.target||i.srcElement;f(i,j)});a.on(window,"scroll",function(i,j){f(i,j)})})();(function(){var a=baidu.editor.utils,c=baidu.editor.ui.UIBase,b=baidu.editor.ui.ColorPicker=function(f){this.initOptions(f);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase()};b.prototype={getHtmlTpl:function(){return e(this.noColorText,this.editor)},_onTableClick:function(f){var h=f.target||f.srcElement;var g=h.getAttribute("data-color");if(g){this.fireEvent("pickcolor",g)}},_onTableOver:function(f){var h=f.target||f.srcElement;var g=h.getAttribute("data-color");if(g){this.getDom("preview").style.backgroundColor=g}},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};a.inherits(b,c);var d=("ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,").split(",");function e(f,j){var h='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+f+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+j.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >';for(var g=0;g<d.length;g++){if(g&&g%10===0){h+="</tr>"+(g==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+j.getLang("standardColor")+"</td></tr>":"")+"<tr"+(g==60?' class="edui-colorpicker-tablefirstrow"':"")+">"}h+=g<70?'<td style="padding: 0 2px;"><a hidefocus title="'+d[g]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+d[g]+'" style="background-color:#'+d[g]+";border:solid #ccc;"+(g<10||g>=60?"border-width:1px;":g>=10&&g<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':""}h+="</tr></table></div>";return h}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase;var d=baidu.editor.ui.TablePicker=function(e){this.initOptions(e);this.initTablePicker()};d.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this;return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:c.prototype.render,render:function(e){this._UIBase_render(e);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(i,h){var f=this.getDom("overlay").style;var g=this.lengthOfCellSide;f.width=i*g+"px";f.height=h*g+"px";var e=this.getDom("label");e.innerHTML=i+this.editor.getLang("t_col")+" x "+h+this.editor.getLang("t_row");this.numCols=i;this.numRows=h},_onMouseOver:function(f,g){var e=f.relatedTarget||f.fromElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility=""}},_onMouseOut:function(f,g){var e=f.relatedTarget||f.toElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(e,g){var f=this.getDom("overlay").style;var k=b.getEventOffset(e);var i=this.lengthOfCellSide;var j=Math.ceil(k.left/i);var h=Math.ceil(k.top/i);this._track(j,h)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}};a.inherits(d,c)})();(function(){var c=baidu.editor.browser,a=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils;var d='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(c.ie?(' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"'):(' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"'));baidu.editor.ui.Stateful={alwalysHoverable:false,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return d})},Stateful_onMouseEnter:function(e,f){this.target=f;if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(e,f){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseEnter(f,g)}},Stateful_onMouseOut:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseLeave(f,g)}},Stateful_onMouseDown:function(e,f){if(!this.isDisabled()){this.addState("active")}},Stateful_onMouseUp:function(e,f){if(!this.isDisabled()){this.removeState("active")}},Stateful_postRender:function(){if(this.disabled&&!this.hasState("disabled")){this.addState("disabled")}},hasState:function(e){return a.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){if(!this.hasState(e)){this.getStateDom().className+=" edui-state-"+e}},removeState:function(e){if(this.hasState(e)){a.removeClasses(this.getStateDom(),["edui-state-"+e])}},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){if(!this.isDisabled()&&e){this.addState("checked")}else{this.removeState("checked")}},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){if(e){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else{this.removeState("disabled")}}}})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Stateful,a=baidu.editor.ui.Button=function(e){this.initOptions(e);this.initButton()};a.prototype={uiName:"button",label:"",title:"",showIcon:true,showText:true,initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled)},_onClick:function(){if(!this.isDisabled()){this.fireEvent("click")}}};b.inherits(a,d);b.extend(a.prototype,c)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,f=baidu.editor.ui.UIBase,d=baidu.editor.ui.Stateful,b=baidu.editor.ui.SplitButton=function(g){this.initOptions(g);this.initSplitButton()};b.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var h=this;if(this.popup!=null){var g=this.popup;this.popup=null;this.setPopup(g)}},_UIBase_postRender:f.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},setPopup:function(g){if(this.popup===g){return}if(this.popup!=null){this.popup.dispose()}g.addListener("show",c.bind(this._onPopupShow,this));g.addListener("hide",c.bind(this._onPopupHide,this));g.addListener("postrender",c.bind(function(){g.getDom("body").appendChild(e.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(e.getClientRect(this.getDom()).width-2)+'px"></div>'));g.getDom().className+=" "+this.className},this));this.popup=g},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var g=e.getClientRect(this.getDom());g.top-=this.popup.SHADOW_RADIUS;g.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(g)},_onArrowClick:function(h,g){if(!this.isDisabled()){this.showPopup()}},_onButtonClick:function(){if(!this.isDisabled()){this.fireEvent("buttonclick")}}};c.inherits(b,f);c.extend(b.prototype,d,true)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.ColorPicker,f=baidu.editor.ui.Popup,a=baidu.editor.ui.SplitButton,e=baidu.editor.ui.ColorButton=function(g){this.initOptions(g);this.initColorButton()};e.prototype={initColorButton:function(){var g=this;this.popup=new f({content:new d({noColorText:g.editor.getLang("clearColor"),editor:g.editor,onpickcolor:function(i,h){g._onPickColor(h)},onpicknocolor:function(i,h){g._onPickNoColor(h)}}),editor:g.editor});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(c.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(g){this.getDom("colorlump").style.backgroundColor=g;this.color=g},_onPickColor:function(g){if(this.fireEvent("pickcolor",g)!==false){this.setColor(g);this.popup.hide()}},_onPickNoColor:function(g){if(this.fireEvent("picknocolor")!==false){this.popup.hide()}}};b.inherits(e,a)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Popup,d=baidu.editor.ui.TablePicker,a=baidu.editor.ui.SplitButton,e=baidu.editor.ui.TableButton=function(f){this.initOptions(f);this.initTableButton()};e.prototype={initTableButton:function(){var f=this;this.popup=new c({content:new d({editor:f.editor,onpicktable:function(g,i,h){f._onPickTable(i,h)}}),editor:f.editor});this.initSplitButton()},_onPickTable:function(g,f){if(this.fireEvent("picktable",g,f)!==false){this.popup.hide()}}};b.inherits(e,a)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase;var c=baidu.editor.ui.AutoTypeSetPicker=function(d){this.initOptions(d);this.initAutoTypeSetPicker()};c.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,d=e.options.autotypeset,f=e.getLang("autoTypeSet");return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap colspan="2"><input type="checkbox" name="mergeEmptyline" '+(d.mergeEmptyline?"checked":"")+">"+f.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(d.removeEmptyline?"checked":"")+">"+f.delLine+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="removeClass" '+(d.removeClass?"checked":"")+">"+f.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(d.indent?"checked":"")+">"+f.indent+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="textAlign" '+(d.textAlign?"checked":"")+">"+f.alignment+'</td><td colspan="2" id="textAlignValue"><input type="radio" name="textAlignValue" value="left" '+((d.textAlign&&d.textAlign=="left")?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="textAlignValue" value="center" '+((d.textAlign&&d.textAlign=="center")?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="textAlignValue" value="right" '+((d.textAlign&&d.textAlign=="right")?"checked":"")+">"+e.getLang("justifyright")+' </tr><tr><td nowrap colspan="2"><input type="checkbox" name="imageBlockLine" '+(d.imageBlockLine?"checked":"")+">"+f.imageFloat+'</td><td nowrap colspan="2" id="imageBlockLineValue"><input type="radio" name="imageBlockLineValue" value="none" '+((d.imageBlockLine&&d.imageBlockLine=="none")?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="imageBlockLineValue" value="left" '+((d.imageBlockLine&&d.imageBlockLine=="left")?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="imageBlockLineValue" value="center" '+((d.imageBlockLine&&d.imageBlockLine=="center")?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="imageBlockLineValue" value="right" '+((d.imageBlockLine&&d.imageBlockLine=="right")?"checked":"")+">"+e.getLang("justifyright")+'</tr><tr><td nowrap colspan="2"><input type="checkbox" name="clearFontSize" '+(d.clearFontSize?"checked":"")+">"+f.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(d.clearFontFamily?"checked":"")+">"+f.removeFontFamily+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="removeEmptyNode" '+(d.removeEmptyNode?"checked":"")+">"+f.removeHtml+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="pasteFilter" '+(d.pasteFilter?"checked":"")+">"+f.pasteFilter+'</td></tr><tr><td nowrap colspan="4" align="right"><button >'+f.run+"</button></td></tr></table></div></div>"},_UIBase_render:b.prototype.render};a.inherits(c,b)})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.Popup,e=baidu.editor.ui.AutoTypeSetPicker,a=baidu.editor.ui.SplitButton,f=baidu.editor.ui.AutoTypeSetButton=function(g){this.initOptions(g);this.initAutoTypeSetButton()};function c(r){var h=r.editor.options.autotypeset,v=r.getDom(),p=domUtils.getElementsByTagName(v,"input");for(var m=p.length-1,u;u=p[m--];){if(u.getAttribute("type")=="checkbox"){var s=u.getAttribute("name");h[s]&&delete h[s];if(u.checked){var n=document.getElementById(s+"Value");if(n){if(/input/ig.test(n.tagName)){h[s]=n.value}else{var g=n.getElementsByTagName("input");for(var k=g.length-1,t;t=g[k--];){if(t.checked){h[s]=t.value;break}}}}else{h[s]=true}}}}var q=domUtils.getElementsByTagName(v,"select");for(var m=0,l;l=q[m++];){var o=l.getAttribute("name");h[o]=h[o]?l.value:""}r.editor.options.autotypeset=h}f.prototype={initAutoTypeSetButton:function(){var h=this;this.popup=new d({content:new e({editor:h.editor}),editor:h.editor,hide:function(){if(!this._hidden&&this.getDom()){c(this);this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide")}}});var g=0;this.popup.addListener("postRenderAfter",function(){var j=this;if(g){return}var i=this.getDom(),k=i.getElementsByTagName("button")[0];k.onclick=function(){c(j);h.editor.execCommand("autotypeset");j.hide()};g=1});this.initSplitButton()}};b.inherits(f,a)})();(function(){var a=baidu.editor.utils,e=baidu.editor.ui.Popup,c=baidu.editor.ui.Stateful,d=baidu.editor.ui.UIBase;var b=baidu.editor.ui.CellAlignPicker=function(f){this.initOptions(f);this.initCellAlignPicker()};b.prototype={initCellAlignPicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);"><tr><td index="0" stateful><div class="edui-icon edui-left"></div></td><td index="1" stateful><div class="edui-icon edui-center"></div></td><td index="2" stateful><div class="edui-icon edui-right"></div></td></tr><tr><td index="3" stateful><div class="edui-icon edui-left"></div></td><td index="4" stateful><div class="edui-icon edui-center"></div></td><td index="5" stateful><div class="edui-icon edui-right"></div></td></tr><tr><td index="6" stateful><div class="edui-icon edui-left"></div></td><td index="7" stateful><div class="edui-icon edui-center"></div></td><td index="8" stateful><div class="edui-icon edui-right"></div></td></tr></table></div></div>'},getStateDom:function(){return this.target},_onClick:function(f){var g=f.target||f.srcElement;if(/icon/.test(g.className)){this.items[g.parentNode.getAttribute("index")].onclick();e.postHide(f)}},_UIBase_render:d.prototype.render};a.inherits(b,d);a.extend(b.prototype,c,true)})();(function(){var a=baidu.editor.utils,c=baidu.editor.ui.Stateful,b=baidu.editor.ui.uiUtils,e=baidu.editor.ui.UIBase;var d=baidu.editor.ui.PastePicker=function(f){this.initOptions(f);this.initPastePicker()};d.prototype={initPastePicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(f){this.editor.ui._isTransfer=true;this.editor.fireEvent("pasteTransfer",f)},_onClick:function(i){var g=domUtils.getNextDomNode(i),f=b.getViewportRect().height,h=b.getClientRect(g);if((h.top+h.height)>f){g.style.top=(-h.height-i.offsetHeight)+"px"}else{g.style.top=""}if(/hidden/ig.test(domUtils.getComputedStyle(g,"visibility"))){g.style.visibility="visible";domUtils.addClass(i,"edui-state-opened")}else{g.style.visibility="hidden";domUtils.removeClasses(i,"edui-state-opened")}},_UIBase_render:e.prototype.render};a.inherits(d,e);a.extend(d.prototype,c,true)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Toolbar=function(e){this.initOptions(e);this.initToolbar()};c.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(e){this.items.push(e)},getHtmlTpl:function(){var f=[];for(var e=0;e<this.items.length;e++){f[e]=this.items[e].renderHtml()}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+f.join("")+"</div>"},postRender:function(){var f=this.getDom();for(var e=0;e<this.items.length;e++){this.items[e].postRender()}b.makeUnselectable(f)},_onMouseDown:function(){return false}};a.inherits(c,d)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup,a=baidu.editor.ui.Stateful,j=baidu.editor.ui.CellAlignPicker,e=baidu.editor.ui.Menu=function(k){this.initOptions(k);this.initMenu()};var f={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return true}};e.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var k=0;k<this.items.length;k++){var l=this.items[k];if(l=="-"){this.items[k]=this.getSeparator()}else{if(!(l instanceof g)){l.editor=this.editor;l.theme=this.editor.options.theme;this.items[k]=this.createItem(l)}}}},getSeparator:function(){return f},createItem:function(k){return new g(k)},_Popup_getContentHtmlTpl:i.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0){return this._Popup_getContentHtmlTpl()}var m=[];for(var k=0;k<this.items.length;k++){var l=this.items[k];m[k]=l.renderHtml()}return('<div class="%%-body">'+m.join("")+"</div>")},_Popup_postRender:i.prototype.postRender,postRender:function(){var m=this;for(var k=0;k<this.items.length;k++){var l=this.items[k];l.ownerMenu=this;l.postRender()}d.on(this.getDom(),"mouseover",function(o){o=o||event;var n=o.relatedTarget||o.fromElement;var p=m.getDom();if(!b.contains(p,n)&&p!==n){m.fireEvent("over")}});this._Popup_postRender()},queryAutoHide:function(l){if(l){if(b.contains(this.getDom(),l)){return false}for(var k=0;k<this.items.length;k++){var m=this.items[k];if(m.queryAutoHide(l)===false){return false}}}},clearItems:function(){for(var k=0;k<this.items.length;k++){var l=this.items[k];clearTimeout(l._showingTimer);clearTimeout(l._closingTimer);if(l.subMenu){l.subMenu.destroy()}}this.items=[]},destroy:function(){if(this.getDom()){d.remove(this.getDom())}this.clearItems()},dispose:function(){this.destroy()}};h.inherits(e,i);var g=baidu.editor.ui.MenuItem=function(k){this.initOptions(k);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof e)){if(k.className&&k.className.indexOf("aligntd")!=-1){var l=this;this.subMenu=new i({content:new j(this.subMenu),parentMenu:l,editor:l.editor,destroy:function(){if(this.getDom()){d.remove(this.getDom())}}});this.subMenu.addListener("postRenderAfter",function(){d.on(this.getDom(),"mouseover",function(){l.addState("opened")})})}else{this.subMenu=new e(this.subMenu)}}};g.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var k=this;this.addListener("over",function(){k.ownerMenu.fireEvent("submenuover",k);if(k.subMenu){k.delayShowSubMenu()}});if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){k.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(k._closingTimer);k._closingTimer=null;k.addState("opened")});this.ownerMenu.addListener("hide",function(){k.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(m,l){if(l!==k){k.delayHideSubMenu()}});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(l){if(l&&b.contains(k.getDom(),l)){return false}return this._bakQueryAutoHide(l)}}this.getDom().style.tabIndex="-1";b.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var k=this;if(!k.isDisabled()){k.addState("opened");clearTimeout(k._showingTimer);clearTimeout(k._closingTimer);k._closingTimer=null;k._showingTimer=setTimeout(function(){k.showSubMenu()},250)}},delayHideSubMenu:function(){var k=this;if(!k.isDisabled()){k.removeState("opened");clearTimeout(k._showingTimer);if(!k._closingTimer){k._closingTimer=setTimeout(function(){if(!k.hasState("opened")){k.hideSubMenu()}k._closingTimer=null},400)}}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(k){if(this.subMenu&&this.hasState("opened")){return this.subMenu.queryAutoHide(k)}},_onClick:function(k,l){if(this.hasState("disabled")){return}if(this.fireEvent("click",k,l)!==false){if(this.subMenu){this.showSubMenu()}else{i.postHide(k)}}},showSubMenu:function(){var k=b.getClientRect(this.getDom());k.right-=5;k.left+=2;k.width-=7;k.top-=4;k.bottom+=4;k.height+=8;this.subMenu.showAnchorRect(k,true,true)},hideSubMenu:function(){this.subMenu.hide()}};h.inherits(g,c);h.extend(g.prototype,a,true)})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,c=baidu.editor.ui.Combox=function(f){this.initOptions(f);this.initCombox()};c.prototype={uiName:"combox",initCombox:function(){var h=this;this.items=this.items||[];for(var f=0;f<this.items.length;f++){var g=this.items[f];g.uiName="listitem";g.index=f;g.onclick=function(){h.selectByIndex(this.index)}}this.popup=new e({items:this.items,uiName:"list",editor:this.editor});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var f=d.getClientRect(this.getDom());f.top+=1;f.bottom-=1;f.height-=2;this.popup.showAnchorRect(f)},getValue:function(){return this.value},setValue:function(g){var f=this.indexByValue(g);if(f!=-1){this.selectedIndex=f;this.setLabel(this.items[f].label);this.value=this.items[f].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(g));this.value=g}},setLabel:function(f){this.getDom("button_body").innerHTML=f;this.label=f},getLabelForUnknowValue:function(f){return f},indexByValue:function(g){for(var f=0;f<this.items.length;f++){if(g==this.items[f].value){return f}}return -1},getItem:function(f){return this.items[f]},selectByIndex:function(f){if(f<this.items.length&&this.fireEvent("select",f)!==false){this.selectedIndex=f;this.value=this.items[f].value;this.setLabel(this.items[f].label)}}};b.inherits(c,a)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,a=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Mask,b=baidu.editor.ui.UIBase,f=baidu.editor.ui.Button,g=baidu.editor.ui.Dialog=function(j){this.initOptions(h.extend({autoReset:true,draggable:true,onok:function(){},oncancel:function(){},onclose:function(l,k){return k?this.onok():this.oncancel()}},j));this.initDialog()};var c;var i;g.prototype={draggable:false,uiName:"dialog",initDialog:function(){var k=this,l=this.editor.options.theme;this.initUIBase();this.modalMask=(c||(c=new e({className:"edui-dialog-modalmask",theme:l})));this.dragMask=(i||(i=new e({className:"edui-dialog-dragmask",theme:l})));this.closeButton=new f({className:"edui-dialog-closebutton",title:k.closeDialog,theme:l,onclick:function(){k.close(false)}});if(this.buttons){for(var j=0;j<this.buttons.length;j++){if(!(this.buttons[j] instanceof f)){this.buttons[j]=new f(this.buttons[j])}}}},fitSize:function(){var j=this.getDom("body");var k=this.mesureSize();j.style.width=k.width+"px";j.style.height=k.height+"px";return k},safeSetOffset:function(p){var l=this;var j=l.getDom();var o=a.getViewportRect();var k=a.getClientRect(j);var n=p.left;if(n+k.width>o.right){n=o.right-k.width}var m=p.top;if(m+k.height>o.bottom){m=o.bottom-k.height}j.style.left=Math.max(n,0)+"px";j.style.top=Math.max(m,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var o=a.getViewportRect();var j=this.fitSize();var n=this.getDom("titlebar").offsetHeight|0;var m=o.width/2-j.width/2;var l=o.height/2-(j.height-n)/2-n;var k=this.getDom();this.safeSetOffset({left:Math.max(m|0,0),top:Math.max(l|0,0)});if(!d.hasClass(k,"edui-state-centered")){k.className+=" edui-state-centered"}this._show()},getContentHtml:function(){var j="";if(typeof this.content=="string"){j=this.content}else{if(this.iframeUrl){j='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'}}return j},getHtmlTpl:function(){var k="";if(this.buttons){var l=[];for(var j=0;j<this.buttons.length;j++){l[j]=this.buttons[j].renderHtml()}k='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+l.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+k+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var k=this;this.addListener("show",function(){k.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){k.modalMask.hide()});if(this.buttons){for(var j=0;j<this.buttons.length;j++){this.buttons[j].postRender()}}d.on(window,"resize",function(){setTimeout(function(){if(!k.isHidden()){k.safeSetOffset(a.getClientRect(k.getDom()))}})});this._hide()},mesureSize:function(){var j=this.getDom("body");var k=a.getClientRect(this.getDom("content")).width;var l=j.style;l.width=k;return a.getClientRect(j)},_onTitlebarMouseDown:function(j,k){if(this.draggable){var m;var n=a.getViewportRect();var l=this;a.startDrag(j,{ondragstart:function(){m=a.getClientRect(l.getDom());l.getDom("contmask").style.visibility="visible";l.dragMask.show(l.getDom().style.zIndex-1)},ondragmove:function(o,r){var q=m.left+o;var p=m.top+r;l.safeSetOffset({left:q,top:p})},ondragstop:function(){l.getDom("contmask").style.visibility="hidden";d.removeClasses(l.getDom(),["edui-state-centered"]);l.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent("show");baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){this.getDom().style.display="none";this.getDom().style.zIndex="";this._hidden=true;this.fireEvent("hide")}},open:function(){if(this.autoReset){try{this.reset()}catch(k){this.render();this.open()}}this.showAtCenter();if(this.iframeUrl){try{this.getDom("iframe").focus()}catch(j){}}},_onCloseButtonClick:function(j,k){this.close(false)},close:function(j){if(this.fireEvent("close",j)!==false){this._hide()}}};h.inherits(g,b)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,d=baidu.editor.ui.MenuButton=function(e){this.initOptions(e);this.initMenuButton()};d.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton";this.popup=new c({items:e.items,className:e.className,editor:e.editor});this.popup.addListener("show",function(){var g=this;for(var f=0;f<g.items.length;f++){g.items[f].removeState("checked");if(g.items[f].value==e._value){g.items[f].addState("checked");this.value=e._value}}});this.initSplitButton()},setValue:function(e){this._value=e}};b.inherits(d,a)})();(function(){var o=baidu.editor.utils;var k=baidu.editor.ui;var e=k.Dialog;k.buttons={};k.Dialog=function(i){var l=new e(i);l.addListener("hide",function(){if(l.editor){var u=l.editor;try{if(browser.gecko){var v=u.window.scrollY,p=u.window.scrollX;u.body.focus();u.window.scrollTo(p,v)}else{u.focus()}}catch(r){}}});return l};var f={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",highlightcode:"~/dialogs/highlightcode/highlightcode.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html"};var j=["undo","redo","formatmatch","bold","italic","underline","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable"];for(var g=0,t;t=j[g++];){t=t.toLowerCase();k[t]=function(i){return function(l){var p=new k.Button({className:"edui-for-"+i,title:l.options.labelMap[i]||l.getLang("labelMap."+i)||"",onclick:function(){l.execCommand(i)},theme:l.options.theme,showText:false});k.buttons[i]=p;l.addListener("selectionchange",function(u,r,x){var v=l.queryCommandState(i);if(v==-1){p.setDisabled(true);p.setChecked(false)}else{if(!x){p.setDisabled(false);p.setChecked(v)}}});return p}}(t)}k.cleardoc=function(i){var l=new k.Button({className:"edui-for-cleardoc",title:i.options.labelMap.cleardoc||i.getLang("labelMap.cleardoc")||"",theme:i.options.theme,onclick:function(){if(confirm(i.getLang("confirmClear"))){i.execCommand("cleardoc")}}});k.buttons.cleardoc=l;i.addListener("selectionchange",function(){l.setDisabled(i.queryCommandState("cleardoc")==-1)});return l};var n={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var b in n){(function(r,u){for(var p=0,l;l=u[p++];){(function(i){k[r.replace("float","")+i]=function(v){var x=new k.Button({className:"edui-for-"+r.replace("float","")+i,title:v.options.labelMap[r.replace("float","")+i]||v.getLang("labelMap."+r.replace("float","")+i)||"",theme:v.options.theme,onclick:function(){v.execCommand(r,i)}});k.buttons[r]=x;v.addListener("selectionchange",function(z,y,A){x.setDisabled(v.queryCommandState(r)==-1);x.setChecked(v.queryCommandValue(r)==i&&!A)});return x}})(l)}})(b,n[b])}for(var g=0,t;t=["backcolor","forecolor"][g++];){k[t]=function(i){return function(l){var p=new k.ColorButton({className:"edui-for-"+i,color:"default",title:l.options.labelMap[i]||l.getLang("labelMap."+i)||"",editor:l,onpickcolor:function(u,r){l.execCommand(i,r)},onpicknocolor:function(){l.execCommand(i,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){l.execCommand(i,this.color)}});k.buttons[i]=p;l.addListener("selectionchange",function(){p.setDisabled(l.queryCommandState(i)==-1)});return p}}(t)}var h={noOk:["searchreplace","help","spechars","webapp"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","highlightcode","insertframe","edittip","edittable","edittd","scrawl","template","music","background"]};for(var b in h){(function(r,u){for(var p=0,l;l=u[p++];){if(browser.opera&&l==="searchreplace"){continue}(function(i){k[i]=function(y,x,A){x=x||(y.options.iframeUrlMap||{})[i]||f[i];A=y.options.labelMap[i]||y.getLang("labelMap."+i)||"";var v;if(x){v=new k.Dialog(o.extend({iframeUrl:y.ui.mapUrl(x),editor:y,className:"edui-for-"+i,title:A,closeDialog:y.getLang("closeDialog")},r=="ok"?{buttons:[{className:"edui-okbutton",label:y.getLang("ok"),editor:y,onclick:function(){v.close(true)}},{className:"edui-cancelbutton",label:y.getLang("cancel"),editor:y,onclick:function(){v.close(false)}}]}:{}));y.ui._dialogs[i+"Dialog"]=v}var z=new k.Button({className:"edui-for-"+i,title:A,onclick:function(){if(v){switch(i){case"wordimage":y.execCommand("wordimage","word_img");if(y.word_img){v.render();v.open()}break;case"scrawl":if(y.queryCommandState("scrawl")!=-1){v.render();v.open()}break;default:v.render();v.open()}}},theme:y.options.theme,disabled:i=="scrawl"&&y.queryCommandState("scrawl")==-1});k.buttons[i]=z;y.addListener("selectionchange",function(){var B={edittable:1};if(i in B){return}var C=y.queryCommandState(i);if(z.getDom()){z.setDisabled(C==-1);z.setChecked(C)}});return z}})(l.toLowerCase())}})(b,h[b])}k.snapscreen=function(p,l,u){u=p.options.labelMap.snapscreen||p.getLang("labelMap.snapscreen")||"";var r=new k.Button({className:"edui-for-snapscreen",title:u,onclick:function(){p.execCommand("snapscreen")},theme:p.options.theme});k.buttons.snapscreen=r;l=l||(p.options.iframeUrlMap||{})["snapscreen"]||f.snapscreen;if(l){var i=new k.Dialog({iframeUrl:p.ui.mapUrl(l),editor:p,className:"edui-for-snapscreen",title:u,buttons:[{className:"edui-okbutton",label:p.getLang("ok"),editor:p,onclick:function(){i.close(true)}},{className:"edui-cancelbutton",label:p.getLang("cancel"),editor:p,onclick:function(){i.close(false)}}]});i.render();p.ui._dialogs.snapscreenDialog=i}p.addListener("selectionchange",function(){r.setDisabled(p.queryCommandState("snapscreen")==-1)});return r};k.fontfamily=function(u,x,z){x=u.options.fontfamily||[];z=u.options.labelMap.fontfamily||u.getLang("labelMap.fontfamily")||"";if(!x.length){return}for(var r=0,p,l=[];p=x[r];r++){var y=u.getLang("fontfamily")[p.name]||"";(function(i,A){l.push({label:i,value:A,theme:u.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+o.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})})(p.label||y,p.val)}var v=new k.Combox({editor:u,items:l,onselect:function(A,i){u.execCommand("FontFamily",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:z,initValue:z,className:"edui-for-fontfamily",indexByValue:function(C){if(C){for(var B=0,A;A=this.items[B];B++){if(A.value.indexOf(C)!=-1){return B}}}return -1}});k.buttons.fontfamily=v;u.addListener("selectionchange",function(A,i,D){if(!D){var C=u.queryCommandState("FontFamily");if(C==-1){v.setDisabled(true)}else{v.setDisabled(false);var B=u.queryCommandValue("FontFamily");B&&(B=B.replace(/['"]/g,"").split(",")[0]);v.setValue(B)}}});return v};k.fontsize=function(u,x,y){y=u.options.labelMap.fontsize||u.getLang("labelMap.fontsize")||"";x=x||u.options.fontsize||[];if(!x.length){return}var l=[];for(var r=0;r<x.length;r++){var p=x[r]+"px";l.push({label:p,value:p,theme:u.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var v=new k.Combox({editor:u,items:l,title:y,initValue:y,onselect:function(z,i){u.execCommand("FontSize",this.items[i].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});k.buttons.fontsize=v;u.addListener("selectionchange",function(z,i,B){if(!B){var A=u.queryCommandState("FontSize");if(A==-1){v.setDisabled(true)}else{v.setDisabled(false);v.setValue(u.queryCommandValue("FontSize"))}}});return v};k.paragraph=function(r,v,x){x=r.options.labelMap.paragraph||r.getLang("labelMap.paragraph")||"";v=r.options.paragraph||[];if(o.isEmptyObject(v)){return}var l=[];for(var p in v){l.push({value:p,label:v[p]||r.getLang("paragraph")[p],theme:r.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}var u=new k.Combox({editor:r,items:l,title:x,initValue:x,className:"edui-for-paragraph",onselect:function(y,i){r.execCommand("Paragraph",this.items[i].value)},onbuttonclick:function(){this.showPopup()}});k.buttons.paragraph=u;r.addListener("selectionchange",function(z,y,C){if(!C){var B=r.queryCommandState("Paragraph");if(B==-1){u.setDisabled(true)}else{u.setDisabled(false);var A=r.queryCommandValue("Paragraph");var i=u.indexByValue(A);if(i!=-1){u.setValue(A)}else{u.setValue(u.initValue)}}}});return u};k.customstyle=function(v){var y=v.options.customstyle||[],z=v.options.labelMap.customstyle||v.getLang("labelMap.customstyle")||"";if(!y.length){return}var u=v.getLang("customstyle");for(var r=0,l=[],p;p=y[r++];){(function(A){var i={};i.label=A.label?A.label:u[A.name];i.style=A.style;i.className=A.className;i.tag=A.tag;l.push({label:i.label,value:i,theme:v.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+i.tag+" "+(i.className?' class="'+i.className+'"':"")+(i.style?' style="'+i.style+'"':"")+">"+i.label+"</"+i.tag+"></div>"}})})(p)}var x=new k.Combox({editor:v,items:l,title:z,initValue:z,className:"edui-for-customstyle",onselect:function(A,i){v.execCommand("customstyle",this.items[i].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(C){for(var A=0,B;B=this.items[A++];){if(B.label==C){return A-1}}return -1}});k.buttons.customstyle=x;v.addListener("selectionchange",function(B,A,E){if(!E){var D=v.queryCommandState("customstyle");if(D==-1){x.setDisabled(true)}else{x.setDisabled(false);var C=v.queryCommandValue("customstyle");var i=x.indexByValue(C);if(i!=-1){x.setValue(C)}else{x.setValue(x.initValue)}}}});return x};k.inserttable=function(l,i,r){r=l.options.labelMap.inserttable||l.getLang("labelMap.inserttable")||"";var p=new k.TableButton({editor:l,title:r,className:"edui-for-inserttable",onpicktable:function(u,x,v){l.execCommand("InsertTable",{numRows:v,numCols:x,border:1})},onbuttonclick:function(){this.showPopup()}});k.buttons.inserttable=p;l.addListener("selectionchange",function(){p.setDisabled(l.queryCommandState("inserttable")==-1)});return p};k.lineheight=function(u){var x=u.options.lineheight||[];if(!x.length){return}for(var r=0,p,l=[];p=x[r++];){l.push({label:p,value:p,theme:u.options.theme,onclick:function(){u.execCommand("lineheight",this.value)}})}var v=new k.MenuButton({editor:u,className:"edui-for-lineheight",title:u.options.labelMap.lineheight||u.getLang("labelMap.lineheight")||"",items:l,onbuttonclick:function(){var i=u.queryCommandValue("LineHeight")||this.value;u.execCommand("LineHeight",i)}});k.buttons.lineheight=v;u.addListener("selectionchange",function(){var y=u.queryCommandState("LineHeight");if(y==-1){v.setDisabled(true)}else{v.setDisabled(false);var i=u.queryCommandValue("LineHeight");i&&v.setValue((i+"").replace(/cm/,""));v.setChecked(y)}});return v};var c=["top","bottom"];for(var a=0,m;m=c[a++];){(function(i){k["rowspacing"+i]=function(u){var x=u.options["rowspacing"+i]||[];if(!x.length){return null}for(var r=0,p,l=[];p=x[r++];){l.push({label:p,value:p,theme:u.options.theme,onclick:function(){u.execCommand("rowspacing",this.value,i)}})}var v=new k.MenuButton({editor:u,className:"edui-for-rowspacing"+i,title:u.options.labelMap["rowspacing"+i]||u.getLang("labelMap.rowspacing"+i)||"",items:l,onbuttonclick:function(){var y=u.queryCommandValue("rowspacing",i)||this.value;u.execCommand("rowspacing",y,i)}});k.buttons[i]=v;u.addListener("selectionchange",function(){var z=u.queryCommandState("rowspacing",i);if(z==-1){v.setDisabled(true)}else{v.setDisabled(false);var y=u.queryCommandValue("rowspacing",i);y&&v.setValue((y+"").replace(/%/,""));v.setChecked(z)}});return v}})(m)}var s=["insertorderedlist","insertunorderedlist"];for(var d=0,q;q=s[d++];){(function(i){k[i]=function(r){var v=r.options[i],x=function(){r.execCommand(i,this.value)},l=[];for(var p in v){l.push({label:v[p]||r.getLang()[i][p]||"",value:p,theme:r.options.theme,onclick:x})}var u=new k.MenuButton({editor:r,className:"edui-for-"+i,title:r.getLang("labelMap."+i)||"",items:l,onbuttonclick:function(){var y=r.queryCommandValue(i)||this.value;r.execCommand(i,y)}});k.buttons[i]=u;r.addListener("selectionchange",function(){var z=r.queryCommandState(i);if(z==-1){u.setDisabled(true)}else{u.setDisabled(false);var y=r.queryCommandValue(i);u.setValue(y);u.setChecked(z)}});return u}})(q)}k.fullscreen=function(i,p){p=i.options.labelMap.fullscreen||i.getLang("labelMap.fullscreen")||"";var l=new k.Button({className:"edui-for-fullscreen",title:p,theme:i.options.theme,onclick:function(){if(i.ui){i.ui.setFullScreen(!i.ui.isFullScreen())}this.setChecked(i.ui.isFullScreen())}});k.buttons.fullscreen=l;i.addListener("selectionchange",function(){var r=i.queryCommandState("fullscreen");l.setDisabled(r==-1);l.setChecked(i.ui.isFullScreen())});return l};k.emotion=function(l,i){var p=new k.MultiMenuPop({title:l.options.labelMap.emotion||l.getLang("labelMap.emotion")||"",editor:l,className:"edui-for-emotion",iframeUrl:l.ui.mapUrl(i||(l.options.iframeUrlMap||{})["emotion"]||f.emotion)});k.buttons.emotion=p;l.addListener("selectionchange",function(){p.setDisabled(l.queryCommandState("emotion")==-1)});return p};k.autotypeset=function(i){var l=new k.AutoTypeSetButton({editor:i,title:i.options.labelMap.autotypeset||i.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){i.execCommand("autotypeset")}});k.buttons.autotypeset=l;i.addListener("selectionchange",function(){l.setDisabled(i.queryCommandState("autotypeset")==-1)});return l}})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.uiUtils,f=baidu.editor.ui.UIBase,a=baidu.editor.dom.domUtils;var e=[];function c(h){this.initOptions(h);this.initEditorUI()}c.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var j=this.editor,k=this;j.addListener("ready",function(){j.getDialog=function(p){return j.ui._dialogs[p+"Dialog"]};a.on(j.window,"scroll",function(p){baidu.editor.ui.Popup.postHide(p)});j.ui._actualFrameWidth=j.options.initialFrameWidth;if(j.options.elementPathEnabled){j.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+j.getLang("elementPathTip")+":</div>"}if(j.options.wordCount){function o(){l(j,k);a.un(j.document,"click",arguments.callee)}a.on(j.document,"click",o);j.ui.getDom("wordcount").innerHTML=j.getLang("wordCountTip")}j.ui._scale();if(j.options.scaleEnabled){if(j.autoHeightEnabled){j.disableAutoHeight()}k.enableScale()}else{k.disableScale()}if(!j.options.elementPathEnabled&&!j.options.wordCount&&!j.options.scaleEnabled){j.ui.getDom("elementpath").style.display="none";j.ui.getDom("wordcount").style.display="none";j.ui.getDom("scale").style.display="none"}if(!j.selection.isFocus()){return}j.fireEvent("selectionchange",false,true)});j.addListener("mousedown",function(p,o){var q=o.target||o.srcElement;baidu.editor.ui.Popup.postHide(o,q)});j.addListener("delcells",function(){if(UE.ui.edittip){new UE.ui.edittip(j)}j.getDialog("edittip").open()});var i,m=false,n;j.addListener("afterpaste",function(){if(j.queryCommandState("pasteplain")){return}i=new baidu.editor.ui.Popup({content:new baidu.editor.ui.PastePicker({editor:j}),editor:j,className:"edui-wordpastepop"});i.render();m=true});j.addListener("afterinserthtml",function(){clearTimeout(n);n=setTimeout(function(){if(i&&(m||j.ui._isTransfer)){var p=a.createElement(j.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),o=j.selection.getRange();o.insertNode(p);i.showAnchor(p);a.remove(p);delete j.ui._isTransfer;m=false}},200)});j.addListener("contextmenu",function(p,o){baidu.editor.ui.Popup.postHide(o)});j.addListener("keydown",function(p,o){if(i){i.dispose(o)}var q=o.keyCode||o.which;if(o.altKey&&q==90){UE.ui.buttons.fullscreen.onclick()}});j.addListener("wordcount",function(o){l(this,k)});function l(r,u){r.setOpt({wordCount:true,maximumWords:10000,wordCountMsg:r.options.wordCountMsg||r.getLang("wordCountMsg"),wordOverFlowMsg:r.options.wordOverFlowMsg||r.getLang("wordOverFlowMsg")});var p=r.options,o=p.maximumWords,v=p.wordCountMsg,t=p.wordOverFlowMsg,q=u.getDom("wordcount");if(!p.wordCount){return}var s=r.getContentLength(true);if(s>o){q.innerHTML=t;r.fireEvent("wordcountoverflow")}else{q.innerHTML=v.replace("{#leave}",o-s).replace("{#count}",s)}}j.addListener("selectionchange",function(){if(j.options.elementPathEnabled){k[(j.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]()}if(j.options.scaleEnabled){k[(j.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()}});var h=new baidu.editor.ui.Popup({editor:j,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();j.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(o){this.hide();j.ui._dialogs[o]&&j.ui._dialogs[o].open()},_onImgSetFloat:function(o){this.hide();j.execCommand("imagefloat",o)},_setIframeAlign:function(o){var p=h.anchorEl;var q=p.cloneNode(true);switch(o){case -2:q.setAttribute("align","");break;case -1:q.setAttribute("align","left");break;case 1:q.setAttribute("align","right");break}p.parentNode.insertBefore(q,p);a.remove(p);h.anchorEl=q;h.showAnchor(h.anchorEl)},_updateIframe:function(){j._iframe=h.anchorEl;j.ui._dialogs.insertframeDialog.open();h.hide()},_onRemoveButtonClick:function(o){j.execCommand(o);this.hide()},queryAutoHide:function(o){if(o&&o.ownerDocument==j.document){if(o.tagName.toLowerCase()=="img"||a.findParentByTagName(o,"a",true)){return o!==h.anchorEl}}return baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,o)}});h.render();if(j.options.imagePopup){j.addListener("mouseover",function(q,o){o=o||window.event;var r=o.target||o.srcElement;if(j.ui._dialogs.insertframeDialog&&/iframe/ig.test(r.tagName)){var p=h.formatHtml("<nobr>"+j.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+j.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+j.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+j.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+j.getLang("modify")+"</span></nobr>");if(p){h.getDom("content").innerHTML=p;h.anchorEl=r;h.showAnchor(h.anchorEl)}else{h.hide()}}});j.addListener("selectionchange",function(z,r){if(!r){return}var v="",x="",u=j.selection.getRange().getClosedNode(),p=j.ui._dialogs;if(u&&u.tagName=="IMG"){var q="insertimageDialog";if(u.className.indexOf("edui-faked-video")!=-1){q="insertvideoDialog"}if(u.className.indexOf("edui-faked-webapp")!=-1){q="webappDialog"}if(u.src.indexOf("http://api.map.baidu.com")!=-1){q="mapDialog"}if(u.className.indexOf("edui-faked-music")!=-1){q="musicDialog"}if(u.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1){q="gmapDialog"}if(u.getAttribute("anchorname")){q="anchorDialog";v=h.formatHtml("<nobr>"+j.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+j.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+j.getLang("delete")+"</span></nobr>")}if(u.getAttribute("word_img")){j.word_img=[u.getAttribute("word_img")];q="wordimageDialog"}if(!p[q]){return}x="<nobr>"+j.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+j.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+j.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+j.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+j.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+q+'\');" class="edui-clickable">'+j.getLang("modify")+"</span></nobr>";!v&&(v=h.formatHtml(x))}if(j.ui._dialogs.linkDialog){var y=j.queryCommandValue("link");var o;if(y&&(o=(y.getAttribute("data_ue_src")||y.getAttribute("href",2)))){var s=o;if(o.length>30){s=o.substring(0,20)+"..."}if(v){v+='<div style="height:5px;"></div>'}v+=h.formatHtml("<nobr>"+j.getLang("anthorMsg")+': <a target="_blank" href="'+o+'" title="'+o+'" >'+s+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+j.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+j.getLang("clear")+"</span></nobr>");h.showAnchor(y)}}if(v){h.getDom("content").innerHTML=v;h.anchorEl=u||y;h.showAnchor(h.anchorEl)}else{h.hide()}})}},_initToolbars:function(){var p=this.editor;var r=this.toolbars||[];var l=[];for(var o=0;o<r.length;o++){var q=r[o];var m=new baidu.editor.ui.Toolbar({theme:p.options.theme});for(var n=0;n<q.length;n++){var h=q[n];var k=null;if(typeof h=="string"){h=h.toLowerCase();if(h=="|"){h="Separator"}if(baidu.editor.ui[h]){k=new baidu.editor.ui[h](p)}if(h=="fullscreen"){if(l&&l[0]){l[0].items.splice(0,0,k)}else{k&&m.items.splice(0,0,k)}continue}}else{k=h}if(k&&k.id){m.add(k)}}l[o]=m}this.toolbars=l},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img");this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){var j=[];for(var h=0;h<this.toolbars.length;h++){j.push(this.toolbars[h].renderHtml())}return j.join("")},setFullScreen:function(m){var l=this.editor,j=l.container.parentNode.parentNode;if(this._fullscreen!=m){this._fullscreen=m;this.editor.fireEvent("beforefullscreenchange",m);if(baidu.editor.browser.gecko){var i=l.selection.getRange().createBookmark()}if(m){while(j.tagName!="BODY"){var h=baidu.editor.dom.domUtils.getComputedStyle(j,"position");e.push(h);j.style.position="static";j=j.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(this._bakAutoHeight){l.autoHeightEnabled=false;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden";this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;this._updateFullScreen()}else{while(j.tagName!="BODY"){j.style.position=e.shift();j=j.parentNode}this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){l.autoHeightEnabled=true;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;window.scrollTo(0,this._bakScrollTop)}if(baidu.editor.browser.gecko){var k=document.createElement("input");document.body.appendChild(k);l.body.contentEditable=false;setTimeout(function(){k.focus();setTimeout(function(){l.body.contentEditable=true;l.selection.getRange().moveToBookmark(i).select(true);baidu.editor.dom.domUtils.remove(k);m&&window.scroll(0,0)},0)},0)}this.editor.fireEvent("fullscreenchanged",m);this.triggerLayout()}},_updateFullScreen:function(){if(this._fullscreen){var h=d.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+h.width+"px;height:"+h.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);d.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(h.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0))}},_updateElementPath:function(){var h=this.getDom("elementpath"),l;if(this.elementPathEnabled&&(l=this.editor.queryCommandValue("elementpath"))){var m=[];for(var k=0,j;j=l[k];k++){m[k]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+k+'&quot;);">'+j+"</span>")}h.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+m.join(" &gt; ")+"</div>"}else{h.style.display="none"}},disableElementPath:function(){var h=this.getDom("elementpath");h.innerHTML="";h.style.display="none";this.elementPathEnabled=false},enableElementPath:function(){var h=this.getDom("elementpath");h.style.display="";this.elementPathEnabled=true;this._updateElementPath()},_scale:function(){var C=document,l=this.editor,A=l.container,j=l.document,n=this.getDom("toolbarbox"),o=this.getDom("bottombar"),B=this.getDom("scale"),y=this.getDom("scalelayer");var r=false,z=null,m=0,v=l.options.minFrameWidth,i=0,h=0,u=0,k=0;function q(){z=a.getXY(A);if(!m){m=l.options.minFrameHeight+n.offsetHeight+o.offsetHeight}y.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+A.offsetWidth+"px;height:"+A.offsetHeight+"px;z-index:"+(l.options.zIndex+1);a.on(C,"mousemove",s);a.on(j,"mouseup",p);a.on(C,"mouseup",p)}var x=this;this.editor.addListener("fullscreenchanged",function(F,D){if(D){x.disableScale()}else{if(x.editor.options.scaleEnabled){x.enableScale();var E=x.editor.document.createElement("span");x.editor.body.appendChild(E);x.editor.body.style.height=Math.max(a.getXY(E).y,x.editor.iframe.offsetHeight-20)+"px";a.remove(E)}}});function s(D){t();var E=D||window.event;i=E.pageX||(C.documentElement.scrollLeft+E.clientX);h=E.pageY||(C.documentElement.scrollTop+E.clientY);u=i-z.x;k=h-z.y;if(u>=v){r=true;y.style.width=u+"px"}if(k>=m){r=true;y.style.height=k+"px"}}function p(){if(r){r=false;l.ui._actualFrameWidth=y.offsetWidth-2;A.style.width=l.ui._actualFrameWidth+"px";l.setHeight(y.offsetHeight-o.offsetHeight-n.offsetHeight-2)}if(y){y.style.display="none"}t();a.un(C,"mousemove",s);a.un(j,"mouseup",p);a.un(C,"mouseup",p)}function t(){if(browser.ie){C.selection.clear()}else{window.getSelection().removeAllRanges()}}this.enableScale=function(){if(l.queryCommandState("source")==1){return}B.style.display="";this.scaleEnabled=true;a.on(B,"mousedown",q)};this.disableScale=function(){B.style.display="none";this.scaleEnabled=false;a.un(B,"mousedown",q)}},isFullScreen:function(){return this._fullscreen},postRender:function(){f.prototype.postRender.call(this);for(var k=0;k<this.toolbars.length;k++){this.toolbars[k].postRender()}var l=this;var j,h=baidu.editor.dom.domUtils,m=function(){clearTimeout(j);j=setTimeout(function(){l._updateFullScreen()})};h.on(window,"resize",m);l.addListener("destroy",function(){h.un(window,"resize",m);clearTimeout(j)})},showToolbarMsg:function(j,i){this.getDom("toolbarmsg_label").innerHTML=j;this.getDom("toolbarmsg").style.display="";if(!i){var h=this.getDom("upload_dialog");h.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(h){return h?h.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var h=this.getDom();if(h.style.zoom=="1"){h.style.zoom="100%"}else{h.style.zoom="1"}}};b.inherits(c,baidu.editor.ui.UIBase);var g={};UE.ui.Editor=function(h){var j=new baidu.editor.Editor(h);j.options.editor=j;b.loadFile(document,{href:j.options.themePath+j.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var i=j.render;j.render=function(k){if(k.constructor===String){j.key=k;g[k]=j}b.domReady(function(){j.langIsReady?l():j.addListener("langReady",l);function l(){j.setOpt({labelMap:j.options.labelMap||j.getLang("labelMap")});new c(j.options);if(k){if(k.constructor===String){k=document.getElementById(k)}k&&k.getAttribute("name")&&(j.options.textarea=k.getAttribute("name"));if(k&&/script|textarea/ig.test(k.tagName)){var o=document.createElement("div");k.parentNode.insertBefore(o,k);var m=k.value||k.innerHTML;j.options.initialContent=/^[\t\r\n ]*$/.test(m)?j.options.initialContent:m.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");k.className&&(o.className=k.className);k.style.cssText&&(o.style.cssText=k.style.cssText);if(/textarea/i.test(k.tagName)){j.textarea=k;j.textarea.style.display="none"}else{k.parentNode.removeChild(k);k.id&&(o.id=k.id)}k=o;k.innerHTML=""}}a.addClass(k,"edui-"+j.options.theme);j.ui.render(k);var n=j.ui.getDom("iframeholder");j.container=j.ui.getDom();var p=j.options.initialFrameWidth;if(!/%/g.test(p)){p+="px"}j.container.style.cssText="z-index:"+j.options.zIndex+";width:"+p;i.call(j,n)}})};return j};UE.getEditor=function(j,h){var i=g[j];if(!i){i=g[j]=new UE.ui.Editor(h);i.render(j)}return i};UE.delEditor=function(i){var h;if(h=g[i]){h.key&&h.destroy();delete g[i]}}})();(function(){var c=baidu.editor.utils,d=baidu.editor.ui.Popup,b=baidu.editor.ui.SplitButton,a=baidu.editor.ui.MultiMenuPop=function(e){this.initOptions(e);this.initMultiMenu()};a.prototype={initMultiMenu:function(){var e=this;this.popup=new d({content:"",editor:e.editor,iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>';e.editor.container.style.zIndex&&(this.getDom().style.zIndex=e.editor.container.style.zIndex*1+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};c.inherits(a,b)})();UE.plugins.undo=function(){var i=this,m=i.options.maxUndoCount||20,h=i.options.maxInputCount||20,d=new RegExp(domUtils.fillChar+"|</hr>","gi");function f(q,p){if(q.length!=p.length){return 0}for(var o=0,n=q.length;o<n;o++){if(q[o]!=p[o]){return 0}}return 1}function j(o,n){if(o.collapsed!=n.collapsed){return 0}if(!f(o.startAddress,n.startAddress)||!f(o.endAddress,n.endAddress)){return 0}return 1}function k(n){var o=/\b(?:href|src|name)="[^"]*?"/gi;return n.replace(o,"").replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(q,p,r){return p.toLowerCase()+"="+r.replace(/['"]/g,"").toLowerCase()}).replace(/(<[\w\-]+)|([\w\-]+>)/gi,function(q,p,r){return(p||r).toLowerCase()})}function b(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){var q=this.getScene(),o=this.list[this.index],n=k(o.content),p=k(q.content);if(n!=p){this.save()}if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0)}}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index)}}this.restore(++this.index)}};this.restore=function(){var n=this.list[this.index];i.document.body.innerHTML=n.content.replace(d,"");if(browser.ie){utils.each(domUtils.getElementsByTagName(i.document,"td th caption p"),function(o){if(domUtils.isEmptyNode(o)){domUtils.fillNode(i.document,o)}})}new dom.Range(i.document).moveToAddress(n.address).select();this.update();this.clearKey();i.fireEvent("reset",true)};this.getScene=function(){var o=i.selection.getRange(),p=o.createAddress(),r=o.createAddress(false,true);i.fireEvent("beforegetscene");var n=i.body.innerHTML.replace(d,"");browser.ie&&(n=n.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">"));i.fireEvent("aftergetscene");try{o.moveToAddress(p).select(true)}catch(q){}return{address:r,content:n}};this.save=function(p){var o=this.getScene(),n=this.list[this.index];if(n&&n.content==o.content&&(p?1:j(n.address,o.address))){return}this.list=this.list.slice(0,this.index+1);this.list.push(o);if(this.list.length>m){this.list.shift()}this.index=this.list.length-1;this.clearKey();this.update()};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1]};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey()};this.clearKey=function(){e=0;a=null}}i.undoManger=new b();function g(){this.undoManger.save()}i.addListener("saveScene",function(){i.undoManger.save()});i.addListener("beforeexeccommand",g);i.addListener("afterexeccommand",g);i.addListener("reset",function(o,n){if(!n){i.undoManger.reset()}});i.commands.redo=i.commands.undo={execCommand:function(n){i.undoManger[n]()},queryCommandState:function(n){return i.undoManger["has"+(n.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var l={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},e=0,a;var c=false;i.addListener("ready",function(){domUtils.on(i.body,"compositionstart",function(){c=true});domUtils.on(i.body,"compositionend",function(){c=false})});i.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});i.addListener("keydown",function(o,n){var p=n.keyCode||n.which;if(!l[p]&&!n.ctrlKey&&!n.metaKey&&!n.shiftKey&&!n.altKey){if(c){return}if(i.undoManger.list.length==0||((p==8||p==46)&&a!=p)){i.fireEvent("contentchange");i.undoManger.save(true);a=p;return}if(i.undoManger.list.length==2&&i.undoManger.index==0&&e==0){i.undoManger.list.splice(1,1);i.undoManger.update()}a=p;e++;if(e>=h||i.undoManger.mousedown){if(i.selection.getRange().collapsed){i.fireEvent("contentchange")}i.undoManger.save();i.undoManger.mousedown=false}}});i.addListener("mousedown",function(){i.undoManger.mousedown=true})};UE.plugins.basestyle=function(){var d={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},c=function(f,e){return domUtils.filterNodeList(f.selection.getStartElementPath(),e)},b=this;b.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"});for(var a in d){(function(f,e){b.commands[f]={execCommand:function(h){var g=b.selection.getRange(),k=c(this,e);if(g.collapsed){if(k){var j=b.document.createTextNode("");g.insertNode(j).removeInlineStyle(e);g.setStartBefore(j);domUtils.remove(j)}else{var i=g.document.createElement(e[0]);if(h=="superscript"||h=="subscript"){j=b.document.createTextNode("");g.insertNode(j).removeInlineStyle(["sub","sup"]).setStartBefore(j).collapse(true)}g.insertNode(i).setStart(i,0)}g.collapse(true)}else{if(h=="superscript"||h=="subscript"){if(!k||k.tagName.toLowerCase()!=h){g.removeInlineStyle(["sub","sup"])}}k?g.removeInlineStyle(e):g.applyInlineStyle(e[0])}g.select()},queryCommandState:function(){return c(this,e)?1:0}}})(a,d[a])}};UE.plugins.removeformat=function(){var a=this;a.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});a.commands.removeformat={execCommand:function(m,o,b,k,l){var g=new RegExp("^(?:"+(o||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),f=b?[]:(k||this.options.removeFormatAttributes).split(","),h=new dom.Range(this.document),i,e,j,c=function(p){return p.nodeType==1};function d(s){if(s.nodeType==3||s.tagName.toLowerCase()!="span"){return 0}if(browser.ie){var q=s.attributes;if(q.length){for(var r=0,p=q.length;r<p;r++){if(q[r].specified){return 0}}return 1}}return !s.attributes.length}function n(v){var p=v.createBookmark();if(v.collapsed){v.enlarge(true)}if(!l){var q=domUtils.findParentByTagName(v.startContainer,"a",true);if(q){v.setStartBefore(q)}q=domUtils.findParentByTagName(v.endContainer,"a",true);if(q){v.setEndAfter(q)}}i=v.createBookmark();r=i.start;while((j=r.parentNode)&&!domUtils.isBlockElm(j)){domUtils.breakParent(r,j);domUtils.clearEmptySibling(r)}if(i.end){r=i.end;while((j=r.parentNode)&&!domUtils.isBlockElm(j)){domUtils.breakParent(r,j);domUtils.clearEmptySibling(r)}var x=domUtils.getNextDomNode(i.start,false,c),u;while(x){if(x==i.end){break}u=domUtils.getNextDomNode(x,true,c);if(!dtd.$empty[x.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(x)){if(g.test(x.tagName)){if(b){domUtils.removeStyle(x,b);if(d(x)&&b!="text-decoration"){domUtils.remove(x,true)}}else{domUtils.remove(x,true)}}else{if(!dtd.$tableContent[x.tagName]&&!dtd.$list[x.tagName]){domUtils.removeAttributes(x,f);if(d(x)){domUtils.remove(x,true)}}}}x=u}}var y=i.start.parentNode;if(domUtils.isBlockElm(y)&&!dtd.$tableContent[y.tagName]&&!dtd.$list[y.tagName]){domUtils.removeAttributes(y,f)}y=i.end.parentNode;if(i.end&&domUtils.isBlockElm(y)&&!dtd.$tableContent[y.tagName]&&!dtd.$list[y.tagName]){domUtils.removeAttributes(y,f)}v.moveToBookmark(i).moveToBookmark(p);var r=v.startContainer,t,s=v.collapsed;while(r.nodeType==1&&domUtils.isEmptyNode(r)&&dtd.$removeEmpty[r.tagName]){t=r.parentNode;v.setStartBefore(r);if(v.startContainer===v.endContainer){v.endOffset--}domUtils.remove(r);r=t}if(!s){r=v.endContainer;while(r.nodeType==1&&domUtils.isEmptyNode(r)&&dtd.$removeEmpty[r.tagName]){t=r.parentNode;v.setEndBefore(r);domUtils.remove(r);r=t}}}h=this.selection.getRange();n(h);h.select()}}};UE.plugins.font=function(){var a=this,c={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"};a.setOpt({fontfamily:[{name:"songti",val:"\u5b8b\u4f53,SimSun"},{name:"yahei",val:"\u5fae\u8f6f\u96c5\u9ed1,Microsoft YaHei"},{name:"kaiti",val:"\u6977\u4f53,\u6977\u4f53_GB2312, SimKai"},{name:"heiti",val:"\u9ed1\u4f53, SimHei"},{name:"lishu",val:"\u96b6\u4e66, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});for(var b in c){(function(e,d){UE.commands[e]={execCommand:function(g,j){j=j||(this.queryCommandState(g)?"none":g=="underline"?"underline":"line-through");var i=this,f=this.selection.getRange(),l;if(j=="default"){if(f.collapsed){l=i.document.createTextNode("font");f.insertNode(l).select()}i.execCommand("removeFormat","span,a",d);if(l){f.setStartBefore(l).setCursor();domUtils.remove(l)}}else{if(!f.collapsed){if((e=="underline"||e=="strikethrough")&&i.queryCommandValue(e)){i.execCommand("removeFormat","span,a",d)}f=i.selection.getRange();f.applyInlineStyle("span",{style:d+":"+j}).select()}else{var h=domUtils.findParentByTagName(f.startContainer,"span",true);l=i.document.createTextNode("font");if(h&&!h.children.length&&!h[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){f.insertNode(l);if(e=="underline"||e=="strikethrough"){f.selectNode(l).select();i.execCommand("removeFormat","span,a",d,null);h=domUtils.findParentByTagName(l,"span",true);f.setStartBefore(l)}h.style.cssText+=";"+d+":"+j;f.collapse(true).select()}else{f.insertNode(l);f.selectNode(l).select();h=f.document.createElement("span");if(e=="underline"||e=="strikethrough"){if(domUtils.findParentByTagName(l,"a",true)){f.setStartBefore(l).setCursor();domUtils.remove(l);return}i.execCommand("removeFormat","span,a",d)}h.style.cssText=d+":"+j;l.parentNode.insertBefore(h,l);if(!browser.ie||browser.ie&&browser.version==9){var k=h.parentNode;while(!domUtils.isBlockElm(k)){if(k.tagName=="SPAN"){h.style.cssText=k.style.cssText+";"+h.style.cssText}k=k.parentNode}}if(opera){setTimeout(function(){f.setStart(h,0).setCursor()})}else{f.setStart(h,0).setCursor()}}domUtils.remove(l)}}return true},queryCommandValue:function(g){var f=this.selection.getStart();if(g=="underline"||g=="strikethrough"){var h=f,i;while(h&&!domUtils.isBlockElm(h)&&!domUtils.isBody(h)){if(h.nodeType==1){i=domUtils.getComputedStyle(h,d);if(i!="none"){return i}}h=h.parentNode}return"none"}return domUtils.getComputedStyle(f,d)},queryCommandState:function(f){if(!(f=="underline"||f=="strikethrough")){return 0}return this.queryCommandValue(f)==(f=="underline"?"underline":"line-through")}}})(b,c[b])}};UE.plugins.justify=function(){var c=this,d=domUtils.isBlockElm,b={left:1,right:1,center:1,justify:1},a=function(h,e){var k=h.createBookmark(),n=function(p){return p.nodeType==1?p.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(p):!domUtils.isWhitespace(p)};h.enlarge(true);var o=h.createBookmark(),j=domUtils.getNextDomNode(o.start,false,n),l=h.cloneRange(),g;while(j&&!(domUtils.getPosition(j,o.end)&domUtils.POSITION_FOLLOWING)){if(j.nodeType==3||!d(j)){l.setStartBefore(j);while(j&&j!==o.end&&!d(j)){g=j;j=domUtils.getNextDomNode(j,false,null,function(p){return !d(p)})}l.setEndAfter(g);var i=l.getCommonAncestor();if(!domUtils.isBody(i)&&d(i)){domUtils.setStyles(i,utils.isString(e)?{"text-align":e}:e);j=i}else{var f=h.document.createElement("p");domUtils.setStyles(f,utils.isString(e)?{"text-align":e}:e);var m=l.extractContents();f.appendChild(m);l.insertNode(f);j=f}j=domUtils.getNextDomNode(j,false,n)}else{j=domUtils.getNextDomNode(j,true,n)}}return h.moveToBookmark(o).moveToBookmark(k)};UE.commands.justify={execCommand:function(g,h){var f=this.selection.getRange(),e;if(f.collapsed){e=this.document.createTextNode("p");f.insertNode(e)}a(f,h);if(e){f.setStartBefore(e).collapse(true);domUtils.remove(e)}f.select();return true},queryCommandValue:function(){var e=this.selection.getStart(),f=domUtils.getComputedStyle(e,"text-align");return b[f]?f:"left"},queryCommandState:function(){var f=this.selection.getStart(),e=f&&domUtils.findParentByTagName(f,["td","th","caption"],true);return e?-1:0}}};UE.plugins.formatmatch=function(){var c=this,d=[],b,a=0;c.addListener("reset",function(){d=[];a=0});function e(k,m){if(browser.webkit){var j=m.target.tagName=="IMG"?m.target:null}function f(o){if(n){o.selectNode(n)}return o.applyInlineStyle(d[d.length-1].tagName,null,d)}c.undoManger&&c.undoManger.save();var i=c.selection.getRange(),l=j||i.getClosedNode();if(b&&l&&l.tagName=="IMG"){l.style.cssText+=";float:"+(b.style.cssFloat||b.style.styleFloat||"none")+";display:"+(b.style.display||"inline");b=null}else{if(!b){var h=i.collapsed;if(h){var n=c.document.createTextNode("match");i.insertNode(n).select()}c.__hasEnterExecCommand=true;var g=c.options.removeFormatAttributes;c.options.removeFormatAttributes="";c.execCommand("removeformat");c.options.removeFormatAttributes=g;c.__hasEnterExecCommand=false;i=c.selection.getRange();if(d.length){f(i)}if(n){i.setStartBefore(n).collapse(true)}i.select();n&&domUtils.remove(n)}}c.undoManger&&c.undoManger.save();c.removeListener("mouseup",e);a=0}c.commands.formatmatch={execCommand:function(g){if(a){a=0;d=[];c.removeListener("mouseup",e);return}var f=c.selection.getRange();b=f.getClosedNode();if(!b||b.tagName!="IMG"){f.collapse(true).shrinkBoundary();var k=f.startContainer;d=domUtils.findParents(k,true,function(i){return !domUtils.isBlockElm(i)&&i.nodeType==1});for(var j=0,h;h=d[j];j++){if(h.tagName=="A"){d.splice(j,1);break}}}c.addListener("mouseup",e);a=1},queryCommandState:function(){return a},notNeedUndo:1}};UE.plugins.pagebreak=function(){var d=this,b=["td"];function a(f){if(domUtils.isEmptyBlock(f)){var g=f.firstChild,e;while(g&&g.nodeType==1&&domUtils.isEmptyBlock(g)){e=g;g=g.firstChild}!e&&(e=f);domUtils.fillNode(d.document,e)}}d.ready(function(){utils.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",d.document)});function c(e){return e&&e.nodeType==1&&e.tagName=="HR"&&e.className=="pagebreak"}d.commands.pagebreak={execCommand:function(){var j=d.selection.getRange(),m=d.document.createElement("hr");domUtils.setAttributes(m,{"class":"pagebreak",noshade:"noshade",size:"5"});domUtils.unSelectable(m);var g=domUtils.findParentByTagName(j.startContainer,b,true),l=[],k;if(g){switch(g.tagName){case"TD":k=g.parentNode;if(!k.previousSibling){var n=domUtils.findParentByTagName(k,"table");n.parentNode.insertBefore(m,n);l=domUtils.findParents(m,true)}else{k.parentNode.insertBefore(m,k);l=domUtils.findParents(m)}k=l[1];if(m!==k){domUtils.breakParent(m,k)}d.fireEvent("afteradjusttable",d.document)}}else{if(!j.collapsed){j.deleteContents();var f=j.startContainer;while(!domUtils.isBody(f)&&domUtils.isBlockElm(f)&&domUtils.isEmptyNode(f)){j.setStartBefore(f).collapse(true);domUtils.remove(f);f=j.startContainer}}j.insertNode(m);var k=m.parentNode,i;while(!domUtils.isBody(k)){domUtils.breakParent(m,k);i=m.nextSibling;if(i&&domUtils.isEmptyBlock(i)){domUtils.remove(i)}k=m.parentNode}i=m.nextSibling;var h=m.previousSibling;if(c(h)){domUtils.remove(h)}else{h&&a(h)}if(!i){var e=d.document.createElement("p");m.parentNode.appendChild(e);domUtils.fillNode(d.document,e);j.setStart(e,0).collapse(true)}else{if(c(i)){domUtils.remove(i)}else{a(i)}j.setEndAfter(m).collapse(false)}j.select(true)}}}};UE.commands.inserthtml={execCommand:function(h,k,b){var n=this,l,a;if(!k){return}l=n.selection.getRange();a=l.document.createElement("div");a.style.display="inline";var p=n.serialize;if(!b&&p){var e=p.parseHTML(k);e=p.transformInput(e);e=p.filter(e);k=p.toHTML(e)}a.innerHTML=utils.trim(k);if(!l.collapsed){var d=l.startContainer;if(domUtils.isFillChar(d)){l.setStartBefore(d)}d=l.endContainer;if(domUtils.isFillChar(d)){l.setEndAfter(d)}l.txtToElmBoundary();if(l.endContainer&&l.endContainer.nodeType==1){d=l.endContainer.childNodes[l.endOffset];if(d&&domUtils.isBr(d)){l.setEndAfter(d)}}if(l.startOffset==0){d=l.startContainer;if(domUtils.isBoundaryNode(d,"firstChild")){d=l.endContainer;if(l.endOffset==(d.nodeType==3?d.nodeValue.length:d.childNodes.length)&&domUtils.isBoundaryNode(d,"lastChild")){n.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";l.setStart(n.body.firstChild,0).collapse(true)}}}!l.collapsed&&l.deleteContents();if(l.startContainer.nodeType==1){var c=l.startContainer.childNodes[l.startOffset],f;if(c&&domUtils.isBlockElm(c)&&(f=c.previousSibling)&&domUtils.isBlockElm(f)){l.setEnd(f,f.childNodes.length).collapse();while(c.firstChild){f.appendChild(c.firstChild)}domUtils.remove(c)}}}var c,o,f,i,m=0,g;if(l.inFillChar()){c=l.startContainer;l.setStartBefore(c).collapse(true);domUtils.remove(c)}while(c=a.firstChild){l.insertNode(c);g=c.nextSibling;if(!m&&c.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(c)){o=domUtils.findParent(c,function(q){return domUtils.isBlockElm(q)});if(o&&o.tagName.toLowerCase()!="body"&&!(dtd[o.tagName][c.nodeName]&&c.parentNode===o)){if(!dtd[o.tagName][c.nodeName]){f=o}else{i=c.parentNode;while(i!==o){f=i;i=i.parentNode}}domUtils.breakParent(c,f||i);var f=c.previousSibling;domUtils.trimWhiteTextNode(f);if(!f.childNodes.length){domUtils.remove(f)}if(!browser.ie&&(j=c.nextSibling)&&domUtils.isBlockElm(j)&&j.lastChild&&!domUtils.isBr(j.lastChild)){j.appendChild(n.document.createElement("br"))}m=1}}var j=c.nextSibling;if(!a.firstChild&&j&&domUtils.isBlockElm(j)){l.setStart(j,0).collapse(true);break}l.setEndAfter(c).collapse()}c=l.startContainer;if(g&&domUtils.isBr(g)){domUtils.remove(g)}if(domUtils.isBlockElm(c)&&domUtils.isEmptyNode(c)){if(g=c.nextSibling){domUtils.remove(c);if(g.nodeType==1&&dtd.$block[g.tagName]){l.setStart(g,0).collapse(true).shrinkBoundary()}}else{c.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}}l.select(true);setTimeout(function(){l=n.selection.getRange();l.scrollToView(n.autoHeightEnabled,n.autoHeightEnabled?domUtils.getXY(n.iframe).y:0);n.fireEvent("afterinserthtml")},200)}};UE.commands.imagefloat={execCommand:function(a,g){var i=this,f=i.selection.getRange();if(!f.collapsed){var d=f.getClosedNode();if(d&&d.tagName=="IMG"){switch(g){case"left":case"right":case"none":var h=d.parentNode,b,c,e;while(dtd.$inline[h.tagName]||h.tagName=="A"){h=h.parentNode}b=h;if(b.tagName=="P"&&domUtils.getStyle(b,"text-align")=="center"){if(!domUtils.isBody(b)&&domUtils.getChildCount(b,function(j){return !domUtils.isBr(j)&&!domUtils.isWhitespace(j)})==1){c=b.previousSibling;e=b.nextSibling;if(c&&e&&c.nodeType==1&&e.nodeType==1&&c.tagName==e.tagName&&domUtils.isBlockElm(c)){c.appendChild(b.firstChild);while(e.firstChild){c.appendChild(e.firstChild)}domUtils.remove(b);domUtils.remove(e)}else{domUtils.setStyle(b,"text-align","")}}f.selectNode(d).select()}domUtils.setStyle(d,"float",g=="none"?"":g);if(g=="none"){domUtils.removeAttributes(d,"align")}break;case"center":if(i.queryCommandValue("imagefloat")!="center"){h=d.parentNode;domUtils.setStyle(d,"float","");domUtils.removeAttributes(d,"align");b=d;while(h&&domUtils.getChildCount(h,function(j){return !domUtils.isBr(j)&&!domUtils.isWhitespace(j)})==1&&(dtd.$inline[h.tagName]||h.tagName=="A")){b=h;h=h.parentNode}f.setStartBefore(b).setCursor(false);h=i.document.createElement("div");h.appendChild(b);domUtils.setStyle(b,"float","");i.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+h.innerHTML+"</p>");b=i.document.getElementById("_img_parent_tmp");b.removeAttribute("id");b=b.firstChild;f.selectNode(b).select();e=b.parentNode.nextSibling;if(e&&domUtils.isEmptyNode(e)){domUtils.remove(e)}}break}}}},queryCommandValue:function(){var a=this.selection.getRange(),b,c;if(a.collapsed){return"none"}b=a.getClosedNode();if(b&&b.nodeType==1&&b.tagName=="IMG"){c=b.getAttribute("align")||domUtils.getComputedStyle(b,"float");if(c=="none"){c=domUtils.getComputedStyle(b.parentNode,"text-align")=="center"?"center":c}return{left:1,right:1,center:1}[c]?c:"none"}return"none"},queryCommandState:function(){var a=this.selection.getRange(),b;if(a.collapsed){return -1}b=a.getClosedNode();if(b&&b.nodeType==1&&b.tagName=="IMG"){return 0}return -1}};UE.commands.insertimage={execCommand:function(b,a){a=utils.isArray(a)?a:[a];if(!a.length){return}var j=this,g=j.selection.getRange(),d=g.getClosedNode();if(d&&/img/i.test(d.tagName)&&d.className!="edui-faked-video"&&!d.getAttribute("word_img")){var e=a.shift();var k=e.floatStyle;delete e.floatStyle;domUtils.setAttributes(d,e);j.execCommand("imagefloat",k);if(a.length>0){g.setStartAfter(d).setCursor(false,true);j.execCommand("insertimage",a)}}else{var f=[],h="",l;l=a[0];if(a.length==1){h='<img src="'+l.src+'" '+(l.data_ue_src?' data_ue_src="'+l.data_ue_src+'" ':"")+(l.width?'width="'+l.width+'" ':"")+(l.height?' height="'+l.height+'" ':"")+(l.floatStyle=="left"||l.floatStyle=="right"?' style="float:'+l.floatStyle+';"':"")+(l.title&&l.title!=""?' title="'+l.title+'"':"")+(l.border&&l.border!="0"?' border="'+l.border+'"':"")+(l.alt&&l.alt!=""?' alt="'+l.alt+'"':"")+(l.hspace&&l.hspace!="0"?' hspace = "'+l.hspace+'"':"")+(l.vspace&&l.vspace!="0"?' vspace = "'+l.vspace+'"':"")+"/>";if(l.floatStyle=="center"){h='<p style="text-align: center">'+h+"</p>"}f.push(h)}else{for(var c=0;l=a[c++];){h="<p "+(l.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+l.src+'" '+(l.width?'width="'+l.width+'" ':"")+(l.data_ue_src?' data_ue_src="'+l.data_ue_src+'" ':"")+(l.height?' height="'+l.height+'" ':"")+' style="'+(l.floatStyle&&l.floatStyle!="center"?"float:"+l.floatStyle+";":"")+(l.border||"")+'" '+(l.title?' title="'+l.title+'"':"")+" /></p>";f.push(h)}}j.execCommand("insertHtml",f.join(""))}}};UE.plugins.video=function(){var c=this,d;function b(f,h,e,j,g,i){return !g?(i?("<p "+(j&&j!="none"?(j=="center"?' style="text-align:center;" ':' style="float:"'+j):"")+">"):"")+'<img align="'+j+'" width="'+h+'" height="'+e+'" _url="'+f+'" class="edui-faked-video" src="'+c.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+c.options.UEDITOR_HOME_URL+'themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;" />'+(i?"</p>":""):'<embed type="application/x-shockwave-flash" class="edui-faked-video" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+f+'" width="'+h+'" height="'+e+'" align="'+j+'"'+(j&&j!="none"?' style= "'+(j=="center"?"display:block;":" float: "+j)+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >'}function a(j){var g,e=domUtils.getElementsByTagName(c.document,!j?"embed":"img");for(var f=0,h;h=e[f++];){if(h.className!="edui-faked-video"){continue}g=c.document.createElement("div");var k=domUtils.getComputedStyle(h,"float");k=k=="none"?(h.getAttribute("align")||""):k;g.innerHTML=b(j?h.getAttribute("_url"):h.getAttribute("src"),h.width,h.height,k,j);h.parentNode.replaceChild(g.firstChild,h)}}c.addListener("beforegetcontent",function(){a(true)});c.addListener("aftersetcontent",function(){a(false)});c.addListener("aftergetcontent",function(e){if(e=="aftergetcontent"&&c.queryCommandState("source")){return}a(false)});c.commands.insertvideo={execCommand:function(h,k){k=utils.isArray(k)?k:[k];var g=[];for(var f=0,j,e=k.length;f<e;f++){j=k[f];g.push(b(j.url,j.width||420,j.height||280,j.align||"none",false,true))}c.execCommand("inserthtml",g.join(""))},queryCommandState:function(){var f=c.selection.getRange().getClosedNode(),e=f&&(f.className=="edui-faked-video");return e?1:0}}};UE.commands.horizontal={execCommand:function(b){var d=this;if(d.queryCommandState(b)!==-1){d.execCommand("insertHtml","<hr>");var a=d.selection.getRange(),e=a.startContainer;if(e.nodeType==1&&!e.childNodes[a.startOffset]){var c;if(c=e.childNodes[a.startOffset-1]){if(c.nodeType==1&&c.tagName=="HR"){if(d.options.enterTag=="p"){c=d.document.createElement("p");a.insertNode(c);a.setStart(c,0).setCursor()}else{c=d.document.createElement("br");a.insertNode(c);a.setStartBefore(c).setCursor()}}}}return true}},queryCommandState:function(){return domUtils.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}};UE.plugins.highlightcode=function(){var d=this;if(!/highlightcode/i.test(d.options.toolbars.join(""))){return}d.commands.highlightcode={execCommand:function(h,i,g){var f=this.selection.getRange(),l=domUtils.findParentByTagName(f.startContainer,"table",true),e=domUtils.findParentByTagName(f.endContainer,"table",true);if(l&&e&&l===e&&domUtils.hasClass(l,"syntaxhighlighter")){if(l.nextSibling){f.setStart(l.nextSibling,0)}else{if(l.previousSibling){f.setStartAtLast(l.previousSibling)}else{var k=d.document.createElement("p");domUtils.fillNode(d.document,k);l.parentNode.insertBefore(k,l);f.setStart(k,0)}}f.setCursor(false,true);domUtils.remove(l)}if(i&&g){d.execCommand("inserthtml",'<pre id="highlightcode_id" class="brush: '+g+';toolbar:false;">'+utils.unhtml(i)+"</pre>",true);var j=d.document.getElementById("highlightcode_id");if(j){domUtils.removeAttributes(j,"id");d.window.SyntaxHighlighter.highlight(j)}}},queryCommandState:function(){return a.call(this)}};function a(){try{var g=this.selection.getRange(),i,f;g.adjustmentBoundary();i=domUtils.findParent(g.startContainer,function(e){return e.nodeType==1&&e.tagName=="TABLE"&&domUtils.hasClass(e,"syntaxhighlighter")},true);f=domUtils.findParent(g.endContainer,function(e){return e.nodeType==1&&e.tagName=="TABLE"&&domUtils.hasClass(e,"syntaxhighlighter")},true);return i&&f&&i==f?1:0}catch(h){return 0}}d.notNeedHighlightQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,highlightcode:1};var c=d.queryCommandState;d.queryCommandState=function(e){if(!d.notNeedHighlightQuery[e.toLowerCase()]&&a.call(this)==1){return -1}return c.apply(this,arguments)};d.addListener("beforeselectionchange afterselectionchange",function(e){d.highlight=/^b/.test(e)?d.queryCommandState("highlightcode"):0});d.addListener("ready",function(){if(typeof d.XRegExp=="undefined"){utils.loadFile(d.document,{id:"syntaxhighlighter_js",src:d.options.highlightJsUrl||d.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCore.js",tag:"script",type:"text/javascript",defer:"defer"},function(){b.call(d)})}if(!d.document.getElementById("syntaxhighlighter_css")){utils.loadFile(d.document,{id:"syntaxhighlighter_css",tag:"link",rel:"stylesheet",type:"text/css",href:d.options.highlightCssUrl||d.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCoreDefault.css"})}});d.addListener("beforegetcontent beforegetscene",function(){utils.each(domUtils.getElementsByTagName(d.body,"table","syntaxhighlighter"),function(f){var h=[],e="";utils.each(f.getElementsByTagName("code"),function(i){if(e!==i.parentNode){e=i.parentNode;h.push(utils.trim(e[browser.ie?"innerText":"textContent"]))}});var g=domUtils.createElement(d.document,"pre",{"class":"brush: "+f.className.replace(/\s+/g," ").split(" ")[1]+";toolbar:false;"});g.appendChild(d.document.createTextNode(h.join("\n")));f.parentNode.replaceChild(g,f)})});d.addListener("aftergetcontent aftersetcontent aftergetscene",b);d.addListener("excludetable excludeNodeinautotype",function(e,f){if(f&&domUtils.findParent(f,function(g){return domUtils.hasClass(g,"syntaxhighlighter")},true)){return true}});function b(){var e=this;if(!e.window||!e.window.SyntaxHighlighter){return}utils.each(domUtils.getElementsByTagName(e.document,"pre"),function(f){if(domUtils.hasClass(f,"brush")){e.window.SyntaxHighlighter.highlight(f)}})}d.addListener("getAllHtml",function(l,h){var e="";for(var g=0,f,k=domUtils.getElementsByTagName(d.document,"table");f=k[g++];){if(domUtils.hasClass(f,"syntaxhighlighter")){e="<script type=\"text/javascript\">window.onload = function(){SyntaxHighlighter.highlight();setTimeout(function(){    var tables = document.getElementsByTagName('table');   for(var t= 0,ti;ti=tables[t++];){       if(/SyntaxHighlighter/i.test(ti.className)){           var tds = ti.getElementsByTagName('td');           for(var i=0,li,ri;li=tds[0].childNodes[i];i++){               ri = tds[1].firstChild.childNodes[i];               if(ri){                  ri.style.height = li.style.height = ri.offsetHeight + 'px';               }           }       }   }},100)}<\/script>";break}}if(!e){var j;if(j=d.document.getElementById("syntaxhighlighter_css")){domUtils.remove(j)}if(j=d.document.getElementById("syntaxhighlighter_js")){domUtils.remove(j)}}e&&h.push(e)})};UE.plugins.list=function(){var f=this,b={TD:1,PRE:1,BLOCKQUOTE:1};var g={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};f.setOpt({insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:3});var a=f.options.listiconpath;for(var h in g){if(!f.options.insertorderedlist.hasOwnProperty(h)&&!f.options.insertunorderedlist.hasOwnProperty(h)){delete g[h]}}f.ready(function(){var l=[];for(var k in g){if(k=="dash"||k=="dot"){l.push("li.list-"+g[k]+"{background-image:url("+a+g[k]+".gif)}");l.push("ul.custom_"+k+"{list-style:none;}ul.custom_"+k+" li{background-position:0 3px;background-repeat:no-repeat}")}else{for(var j=0;j<99;j++){l.push("li.list-"+g[k]+j+"{background-image:url("+a+"list-"+g[k]+j+".gif)}")}l.push("ol.custom_"+k+"{list-style:none;}ol.custom_"+k+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(k){case"cn":l.push("li.list-"+k+"-paddingleft-1{padding-left:25px}");l.push("li.list-"+k+"-paddingleft-2{padding-left:40px}");l.push("li.list-"+k+"-paddingleft-3{padding-left:55px}");break;case"cn1":l.push("li.list-"+k+"-paddingleft-1{padding-left:30px}");l.push("li.list-"+k+"-paddingleft-2{padding-left:40px}");l.push("li.list-"+k+"-paddingleft-3{padding-left:55px}");break;case"cn2":l.push("li.list-"+k+"-paddingleft-1{padding-left:40px}");l.push("li.list-"+k+"-paddingleft-2{padding-left:55px}");l.push("li.list-"+k+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":l.push("li.list-"+k+"-paddingleft-1{padding-left:25px}");break;case"num2":l.push("li.list-"+k+"-paddingleft-1{padding-left:35px}");l.push("li.list-"+k+"-paddingleft-2{padding-left:40px}");break;case"dash":l.push("li.list-"+k+"-paddingleft{padding-left:35px}");break;case"dot":l.push("li.list-"+k+"-paddingleft{padding-left:20px}")}}l.push(".list-paddingleft-1{padding-left:0}");l.push(".list-paddingleft-2{padding-left:"+f.options.listDefaultPaddingLeft+"px}");l.push(".list-paddingleft-3{padding-left:"+f.options.listDefaultPaddingLeft*2+"px}");utils.cssRule("list","ol,ul{margin:0;pading:0;"+(browser.ie?"":"width:95%")+"}li{clear:both;}"+l.join("\n"),f.document)});function e(k){var j=k.className;if(domUtils.hasClass(k,/custom_/)){return j.match(/custom_(\w+)/)[1]}return""}f.addListener("contentchange",function(){utils.each(domUtils.getElementsByTagName(f.document,"ol ul"),function(m){if(!domUtils.inDoc(m,f.document)){return}var j=0,l=2,k=m.parentNode;if(domUtils.hasClass(m,/custom_/)){if(!(/[ou]l/i.test(k.tagName)&&domUtils.hasClass(k,/custom_/))){l=1}}else{if(/[ou]l/i.test(k.tagName)&&domUtils.hasClass(k,/custom_/)){l=3}}style=domUtils.getStyle(m,"list-style-type");m.style.cssText=style?"list-style-type:"+style:"";m.className=utils.trim(m.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+l;utils.each(domUtils.getElementsByTagName(m,"li"),function(n){n.style.cssText&&(n.style.cssText="");if(!n.firstChild){domUtils.remove(n);return}if(n.parentNode!==m){return}j++;if(domUtils.hasClass(m,/custom_/)){var p=1,o=e(m);if(m.tagName=="OL"){if(o){switch(o){case"cn":case"cn1":case"cn2":if(j>10&&(j%10==0||j>10&&j<20)){p=2}else{if(j>20){p=3}}break;case"num2":if(j>9){p=2}}}n.className="list-"+g[o]+j+" list-"+o+"-paddingleft-"+p}else{n.className="list-"+g[o]+" list-"+o+"-paddingleft"}}else{n.className=n.className.replace(/list-[\w\-]+/gi,"")}var q=n.getAttribute("class");if(q!==null&&!q.replace(/\s/g,"")){domUtils.removeAttributes(n,"class")}});d(m,m.tagName.toLowerCase(),e(m)||domUtils.getStyle(m,"list-style-type"),true)})});function d(o,k,n,m){var l=o.nextSibling;if(l&&l.nodeType==1&&l.tagName.toLowerCase()==k&&(e(l)||domUtils.getStyle(l,"list-style-type")||(k=="ol"?"decimal":"disc"))==n){domUtils.moveChild(l,o);if(l.childNodes.length==0){domUtils.remove(l)}}if(l&&domUtils.isFillChar(l)){domUtils.remove(l)}var j=o.previousSibling;if(j&&j.nodeType==1&&j.tagName.toLowerCase()==k&&(e(j)||domUtils.getStyle(j,"list-style-type")||(k=="ol"?"decimal":"disc"))==n){domUtils.moveChild(o,j)}if(j&&domUtils.isFillChar(j)){domUtils.remove(j)}!m&&domUtils.isEmptyBlock(o)&&domUtils.remove(o)}function i(k,j){if(g[j]){k.className="custom_"+j}try{domUtils.setStyle(k,"list-style-type",j)}catch(l){}}function c(k){var j=k.previousSibling;if(j&&domUtils.isEmptyBlock(j)){domUtils.remove(j)}j=k.nextSibling;if(j&&domUtils.isEmptyBlock(j)){domUtils.remove(j)}}f.addListener("keydown",function(t,A){function o(){A.preventDefault?A.preventDefault():(A.returnValue=false);f.fireEvent("contentchange");f.undoManger&&f.undoManger.save()}function s(p,C){while(p&&!domUtils.isBody(p)){if(C(p)){return null}if(p.nodeType==1&&/[ou]l/i.test(p.tagName)){return p}p=p.parentNode}return null}var B=A.keyCode||A.which;if(B==13&&!A.shiftKey){var r=f.selection.getRange(),k=s(r.startContainer,function(p){return p.tagName=="TABLE"}),n=r.collapsed?k:s(r.endContainer,function(p){return p.tagName=="TABLE"});if(k&&n&&k===n){if(!r.collapsed){k=domUtils.findParentByTagName(r.startContainer,"li",true);n=domUtils.findParentByTagName(r.endContainer,"li",true);if(k&&n&&k===n){r.deleteContents();y=domUtils.findParentByTagName(r.startContainer,"li",true);if(y&&domUtils.isEmptyBlock(y)){m=y.previousSibling;next=y.nextSibling;j=f.document.createElement("p");domUtils.fillNode(f.document,j);v=y.parentNode;if(m&&next){r.setStart(next,0).collapse(true).select(true);domUtils.remove(y)}else{if(!m&&!next||!m){v.parentNode.insertBefore(j,v)}else{y.parentNode.parentNode.insertBefore(j,v.nextSibling)}domUtils.remove(y);if(!v.firstChild){domUtils.remove(v)}r.setStart(j,0).setCursor()}o();return}}else{var z=r.cloneRange(),l=z.collapse(false).createBookmark();r.deleteContents();z.moveToBookmark(l);var y=domUtils.findParentByTagName(z.startContainer,"li",true);c(y);z.select();o();return}}y=domUtils.findParentByTagName(r.startContainer,"li",true);if(y){if(domUtils.isEmptyBlock(y)){l=r.createBookmark();var v=y.parentNode;if(y!==v.lastChild){domUtils.breakParent(y,v);c(y)}else{v.parentNode.insertBefore(y,v.nextSibling);if(domUtils.isEmptyNode(v)){domUtils.remove(v)}}if(!dtd.$list[y.parentNode.tagName]){if(!domUtils.isBlockElm(y.firstChild)){j=f.document.createElement("p");y.parentNode.insertBefore(j,y);while(y.firstChild){j.appendChild(y.firstChild)}domUtils.remove(y)}else{domUtils.remove(y,true)}}r.moveToBookmark(l).select()}else{var q=y.firstChild;if(!q||!domUtils.isBlockElm(q)){var j=f.document.createElement("p");!y.firstChild&&domUtils.fillNode(f.document,j);while(y.firstChild){j.appendChild(y.firstChild)}y.appendChild(j);q=j}var u=f.document.createElement("span");r.insertNode(u);domUtils.breakParent(u,y);var x=u.nextSibling;q=x.firstChild;if(!q){j=f.document.createElement("p");domUtils.fillNode(f.document,j);x.appendChild(j);q=j}if(domUtils.isEmptyNode(q)){q.innerHTML="";domUtils.fillNode(f.document,q)}r.setStart(q,0).collapse(true).shrinkBoundary().select();domUtils.remove(u);var m=x.previousSibling;if(m&&domUtils.isEmptyBlock(m)){m.innerHTML="<p></p>";domUtils.fillNode(f.document,m.firstChild)}}o()}}}if(B==8){r=f.selection.getRange();if(r.collapsed&&domUtils.isStartInblock(r)){z=r.cloneRange().trimBoundary();y=domUtils.findParentByTagName(r.startContainer,"li",true);if(y&&domUtils.isStartInblock(z)){k=domUtils.findParentByTagName(r.startContainer,"p",true);if(k&&k!==y.firstChild){var v=domUtils.findParentByTagName(k,["ol","ul"]);domUtils.breakParent(k,v);c(k);f.fireEvent("contentchange");r.setStart(k,0).setCursor(false,true);f.fireEvent("saveScene");domUtils.preventDefault(A);return}if(y&&(m=y.previousSibling)){if(B==46&&y.childNodes.length){return}if(dtd.$list[m.tagName]){m=m.lastChild}f.undoManger&&f.undoManger.save();q=y.firstChild;if(domUtils.isBlockElm(q)){if(domUtils.isEmptyNode(q)){m.appendChild(q);r.setStart(q,0).setCursor(false,true);while(y.firstChild){m.appendChild(y.firstChild)}}else{u=f.document.createElement("span");r.insertNode(u);if(domUtils.isEmptyBlock(m)){m.innerHTML=""}domUtils.moveChild(y,m);r.setStartBefore(u).collapse(true).select(true);domUtils.remove(u)}}else{if(domUtils.isEmptyNode(y)){var j=f.document.createElement("p");m.appendChild(j);r.setStart(j,0).setCursor()}else{r.setEnd(m,m.childNodes.length).collapse().select(true);while(y.firstChild){m.appendChild(y.firstChild)}}}domUtils.remove(y);f.fireEvent("contentchange");f.fireEvent("saveScene");domUtils.preventDefault(A);return}if(y&&!y.previousSibling){var v=y.parentNode;var l=r.createBookmark();if(domUtils.isTagNode(v.parentNode,"ol ul")){v.parentNode.insertBefore(y,v);if(domUtils.isEmptyNode(v)){domUtils.remove(v)}}else{while(y.firstChild){v.parentNode.insertBefore(y.firstChild,v)}domUtils.remove(y);if(domUtils.isEmptyNode(v)){domUtils.remove(v)}}r.moveToBookmark(l).setCursor(false,true);f.fireEvent("contentchange");f.fireEvent("saveScene");domUtils.preventDefault(A);return}}}}});f.addListener("tabkeydown",function(){function v(B){var A=[];for(var C in B){A.push(C)}return A}var o=f.selection.getRange(),t={OL:v(f.options.insertorderedlist),UL:v(f.options.insertunorderedlist)};function x(A){if(f.options.maxListLevel!=-1){var C=A.parentNode,B=0;while(/[ou]l/i.test(C.tagName)){B++;C=C.parentNode}if(B>=f.options.maxListLevel){return true}}}var y=domUtils.findParentByTagName(o.startContainer,"li",true);if(y){var m;if(o.collapsed){if(x(y)){return true}var l=y.parentNode,s=f.document.createElement(l.tagName),p=utils.indexOf(t[s.tagName],e(l)||domUtils.getComputedStyle(l,"list-style-type"));p=p+1==t[s.tagName].length?0:p+1;var k=t[s.tagName][p];i(s,k);if(domUtils.isStartInblock(o)){f.fireEvent("saveScene");m=o.createBookmark();l.insertBefore(s,y);s.appendChild(y);d(s,s.tagName.toLowerCase(),k);f.fireEvent("contentchange");o.moveToBookmark(m).select(true);return true}}else{f.fireEvent("saveScene");m=o.createBookmark();for(var n=0,j,u=domUtils.findParents(y),z;z=u[n++];){if(domUtils.isTagNode(z,"ol ul")){j=z;break}}var r=y;if(m.end){while(r&&!(domUtils.getPosition(r,m.end)&domUtils.POSITION_FOLLOWING)){if(x(r)){r=domUtils.getNextDomNode(r,false,null,function(A){return A!==j});continue}var l=r.parentNode,s=f.document.createElement(l.tagName),p=utils.indexOf(t[s.tagName],e(l)||domUtils.getComputedStyle(l,"list-style-type"));var q=p+1==t[s.tagName].length?0:p+1;var k=t[s.tagName][q];i(s,k);l.insertBefore(s,r);while(r&&!(domUtils.getPosition(r,m.end)&domUtils.POSITION_FOLLOWING)){y=r.nextSibling;s.appendChild(r);if(!y||domUtils.isTagNode(y,"ol ul")){if(y){while(y=y.firstChild){if(y.tagName=="LI"){break}}}else{y=domUtils.getNextDomNode(r,false,null,function(A){return A!==j})}break}r=y}d(s,s.tagName.toLowerCase(),k);r=y}}f.fireEvent("contentchange");o.moveToBookmark(m).select();return true}}});f.commands.insertorderedlist=f.commands.insertunorderedlist={execCommand:function(n,G){if(!G){G=n.toLowerCase()=="insertorderedlist"?"decimal":"disc"}var O=this,z=this.selection.getRange(),A=function(p){return p.nodeType==1?p.tagName.toLowerCase()!="br":!domUtils.isWhitespace(p)},Q=n.toLowerCase()=="insertorderedlist"?"ol":"ul",m=O.document.createDocumentFragment();z.adjustmentBoundary().shrinkBoundary();var s=z.createBookmark(true),q=domUtils.findParentByTagName(O.document.getElementById(s.start),"li"),D=0,o=domUtils.findParentByTagName(O.document.getElementById(s.end),"li"),E=0,M,v,H,J;if(q||o){q&&(M=q.parentNode);if(!s.end){o=q}o&&(v=o.parentNode);if(M===v){while(q!==o){J=q;q=q.nextSibling;if(!domUtils.isBlockElm(J.firstChild)){var B=O.document.createElement("p");while(J.firstChild){B.appendChild(J.firstChild)}J.appendChild(B)}m.appendChild(J)}J=O.document.createElement("span");M.insertBefore(J,o);if(!domUtils.isBlockElm(o.firstChild)){B=O.document.createElement("p");while(o.firstChild){B.appendChild(o.firstChild)}o.appendChild(B)}m.appendChild(o);domUtils.breakParent(J,M);if(domUtils.isEmptyNode(J.previousSibling)){domUtils.remove(J.previousSibling)}if(domUtils.isEmptyNode(J.nextSibling)){domUtils.remove(J.nextSibling)}var r=e(M)||domUtils.getComputedStyle(M,"list-style-type")||(n.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(M.tagName.toLowerCase()==Q&&r==G){for(var F=0,x,t=O.document.createDocumentFragment();x=m.childNodes[F++];){if(domUtils.isTagNode(x,"ol ul")){utils.each(domUtils.getElementsByTagName(x,"li"),function(p){while(p.firstChild){t.appendChild(p.firstChild)}})}else{while(x.firstChild){t.appendChild(x.firstChild)}}}J.parentNode.insertBefore(t,J)}else{H=O.document.createElement(Q);i(H,G);H.appendChild(m);J.parentNode.insertBefore(H,J)}domUtils.remove(J);H&&d(H,Q,G);z.moveToBookmark(s).select();return}if(q){while(q){J=q.nextSibling;if(domUtils.isTagNode(q,"ol ul")){m.appendChild(q)}else{var k=O.document.createDocumentFragment(),L=0;while(q.firstChild){if(domUtils.isBlockElm(q.firstChild)){L=1}k.appendChild(q.firstChild)}if(!L){var P=O.document.createElement("p");P.appendChild(k);m.appendChild(P)}else{m.appendChild(k)}domUtils.remove(q)}q=J}M.parentNode.insertBefore(m,M.nextSibling);if(domUtils.isEmptyNode(M)){z.setStartBefore(M);domUtils.remove(M)}else{z.setStartAfter(M)}D=1}if(o&&domUtils.inDoc(v,O.document)){q=v.firstChild;while(q&&q!==o){J=q.nextSibling;if(domUtils.isTagNode(q,"ol ul")){m.appendChild(q)}else{k=O.document.createDocumentFragment();L=0;while(q.firstChild){if(domUtils.isBlockElm(q.firstChild)){L=1}k.appendChild(q.firstChild)}if(!L){P=O.document.createElement("p");P.appendChild(k);m.appendChild(P)}else{m.appendChild(k)}domUtils.remove(q)}q=J}var j=domUtils.createElement(O.document,"div",{tmpDiv:1});domUtils.moveChild(o,j);m.appendChild(j);domUtils.remove(o);v.parentNode.insertBefore(m,v);z.setEndBefore(v);if(domUtils.isEmptyNode(v)){domUtils.remove(v)}E=1}}if(!D){z.setStartBefore(O.document.getElementById(s.start))}if(s.end&&!E){z.setEndAfter(O.document.getElementById(s.end))}z.enlarge(true,function(p){return b[p.tagName]});m=O.document.createDocumentFragment();var l=z.createBookmark(),C=domUtils.getNextDomNode(l.start,false,A),N=z.cloneRange(),I,u=domUtils.isBlockElm;while(C&&C!==l.end&&(domUtils.getPosition(C,l.end)&domUtils.POSITION_PRECEDING)){if(C.nodeType==3||dtd.li[C.tagName]){if(C.nodeType==1&&dtd.$list[C.tagName]){while(C.firstChild){m.appendChild(C.firstChild)}I=domUtils.getNextDomNode(C,false,A);domUtils.remove(C);C=I;continue}I=C;N.setStartBefore(C);while(C&&C!==l.end&&(!u(C)||domUtils.isBookmarkNode(C))){I=C;C=domUtils.getNextDomNode(C,false,null,function(p){return !b[p.tagName]})}if(C&&u(C)){J=domUtils.getNextDomNode(I,false,A);if(J&&domUtils.isBookmarkNode(J)){C=domUtils.getNextDomNode(J,false,A);I=J}}N.setEndAfter(I);C=domUtils.getNextDomNode(I,false,A);var y=z.document.createElement("li");y.appendChild(N.extractContents());if(domUtils.isEmptyNode(y)){var I=z.document.createElement("p");while(y.firstChild){I.appendChild(y.firstChild)}y.appendChild(I)}m.appendChild(y)}else{C=domUtils.getNextDomNode(C,true,A)}}z.moveToBookmark(l).collapse(true);H=O.document.createElement(Q);i(H,G);H.appendChild(m);z.insertNode(H);d(H,Q,G,true);for(var F=0,x,K=domUtils.getElementsByTagName(H,"div");x=K[F++];){if(x.getAttribute("tmpDiv")){domUtils.remove(x,true)}}z.moveToBookmark(s).select()},queryCommandState:function(j){return domUtils.filterNodeList(this.selection.getStartElementPath(),j.toLowerCase()=="insertorderedlist"?"ol":"ul")?1:0},queryCommandValue:function(k){var j=domUtils.filterNodeList(this.selection.getStartElementPath(),k.toLowerCase()=="insertorderedlist"?"ol":"ul");return j?e(j)||domUtils.getComputedStyle(j,"list-style-type"):null}}};(function(){function a(d){var e=d.startContainer,c=d.endContainer;if(e=domUtils.findParentByTagName(e,"a",true)){d.setStartBefore(e)}if(c=domUtils.findParentByTagName(c,"a",true)){d.setEndAfter(c)}}UE.commands.unlink={execCommand:function(){var c=this.selection.getRange(),d;if(c.collapsed&&!domUtils.findParentByTagName(c.startContainer,"a",true)){return}d=c.createBookmark();a(c);c.removeInlineStyle("a").moveToBookmark(d).select()},queryCommandState:function(){return !this.highlight&&this.queryCommandValue("link")?0:-1}};function b(d,e,g){var h=d.cloneRange(),f=g.queryCommandValue("link");a(d=d.adjustmentBoundary());var j=d.startContainer;if(j.nodeType==1&&f){j=j.childNodes[d.startOffset];if(j&&j.nodeType==1&&j.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(j[browser.ie?"innerText":"textContent"])){j[browser.ie?"innerText":"textContent"]=utils.html(e.textValue||e.href)}}if(!h.collapsed||f){d.removeInlineStyle("a");h=d.cloneRange()}if(h.collapsed){var c=d.document.createElement("a"),i="";if(e.textValue){i=utils.html(e.textValue);delete e.textValue}else{i=utils.html(e.href)}domUtils.setAttributes(c,e);j=domUtils.findParentByTagName(h.startContainer,"a",true);if(j&&domUtils.isInNodeEndBoundary(h,j)){d.setStartAfter(j).collapse(true)}c[browser.ie?"innerText":"textContent"]=i;d.insertNode(c).selectNode(c)}else{d.applyInlineStyle("a",e)}}UE.commands.link={execCommand:function(d,e){var c;e.data_ue_src&&(e.data_ue_src=utils.unhtml(e.data_ue_src,/[<">]/g));e.href&&(e.href=utils.unhtml(e.href,/[<">]/g));e.textValue&&(e.textValue=utils.unhtml(e.textValue,/[<">]/g));b(c=this.selection.getRange(),e,this);c.collapse().select(true)},queryCommandValue:function(){var j=this.selection.getRange(),e;if(j.collapsed){e=j.startContainer;e=e.nodeType==1?e:e.parentNode;if(e&&(e=domUtils.findParentByTagName(e,"a",true))&&!domUtils.isInNodeEndBoundary(j,e)){return e}}else{j.shrinkBoundary();var d=j.startContainer.nodeType==3||!j.startContainer.childNodes[j.startOffset]?j.startContainer:j.startContainer.childNodes[j.startOffset],g=j.endContainer.nodeType==3||j.endOffset==0?j.endContainer:j.endContainer.childNodes[j.endOffset-1],k=j.getCommonAncestor();e=domUtils.findParentByTagName(k,"a",true);if(!e&&k.nodeType==1){var f=k.getElementsByTagName("a"),c,l;for(var h=0,m;m=f[h++];){c=domUtils.getPosition(m,d),l=domUtils.getPosition(m,g);if((c&domUtils.POSITION_FOLLOWING||c&domUtils.POSITION_CONTAINS)&&(l&domUtils.POSITION_PRECEDING||l&domUtils.POSITION_CONTAINS)){e=m;break}}}return e}},queryCommandState:function(){var d=this.selection.getRange().getClosedNode(),c=d&&(d.className=="edui-faked-video");return c?-1:0}}})();UE.plugins.selectall=function(){var a=this;a.commands.selectall={execCommand:function(){var e=this,c=e.body,d=e.selection.getRange();d.selectNodeContents(c);if(domUtils.isEmptyBlock(c)){if(browser.opera&&c.firstChild&&c.firstChild.nodeType==1){d.setStartAtFirst(c.firstChild)}d.collapse(true)}d.select(true)},notNeedUndo:1};function b(e,c){var d;while(!domUtils.isBody(e)){d=e;e=e.parentNode;if(d!==e[c]){return false}}return true}a.addListener("keydown",function(f,d){var c=a.selection.getRange();if(!c.collapsed&&!(d.ctrlKey||d.metaKey||d.shiftKey||d.altKey)){var e=c.startContainer;if(domUtils.isFillChar(e)){c.setStartBefore(e)}e=c.endContainer;if(domUtils.isFillChar(e)){c.setEndAfter(e)}c.txtToElmBoundary();if(c.startOffset==0){e=c.startContainer;if(b(e,"firstChild")){e=c.endContainer;if(c.endOffset==c.endContainer.childNodes.length&&b(e,"lastChild")){a.fireEvent("saveScene");a.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";c.setStart(a.body.firstChild,0).setCursor(false,true);a.fireEvent("saveScene");browser.ie&&a._selectionChange();return}}}}});a.addshortcutkey({selectAll:"ctrl+65"})};UE.commands.cleardoc={execCommand:function(c){var d=this,b=d.options.enterTag,a=d.selection.getRange();if(b=="br"){d.body.innerHTML="<br/>";a.setStart(d.body,0).setCursor()}else{d.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";a.setStart(d.body.firstChild,0).setCursor(false,true)}d.fireEvent("clearDoc")}};UE.commands.preview={execCommand:function(){var a=window.open("","_blank",""),b=a.document;b.open();b.write('<html><head><script src="'+this.options.UEDITOR_HOME_URL+"uparse.js\"><\/script><script>setTimeout(function(){uParse('div',{    'highlightJsUrl':'"+this.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCore.js',    'highlightCssUrl':'"+this.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCoreDefault.css'})},300)<\/script></head><body><div>"+this.getContent(null,null,true)+"</div></body></html>");b.close()},notNeedUndo:1};UE.plugins.serialize=function(){var a=browser.ie,i=browser.version;function h(p){return/pt/.test(p)?p.replace(/([\d.]+)pt/g,function(q){return Math.round(parseFloat(q)*96/72)+"px"}):p}var k=this,b=k.options.autoClearEmptyNode,e=dtd.$empty,n=function(){var r=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,p=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,s={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},v={script:1,style:1},q={li:{"$":"ul",ul:1,ol:1},dd:{"$":"dl",dl:1},dt:{"$":"dl",dl:1},option:{"$":"select",select:1},td:{"$":"tr",tr:1},th:{"$":"tr",tr:1},tr:{"$":"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{"$":"table",table:1,colgroup:1},thead:{"$":"table",table:1},tfoot:{"$":"table",table:1},col:{"$":"colgroup",colgroup:1}};var t={table:"td",tbody:"td",thead:"td",tfoot:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};function u(A,E){var B,C=0,y,J;r.exec("");while((B=r.exec(A))){var H=B.index;if(H>C){var K=A.slice(C,H);if(J){J.push(K)}else{E.onText(K)}}C=r.lastIndex;if((y=B[1])){y=y.toLowerCase();if(J&&y==J._tag_name){E.onCDATA(J.join(""));J=null}if(!J){E.onTagClose(y);continue}}if(J){J.push(B[0]);continue}if((y=B[3])){if(/="/.test(y)){continue}y=y.toLowerCase();var I=B[4],x,z={},G=I&&I.slice(-1)=="/";if(I){p.exec("");while((x=p.exec(I))){var F=x[1].toLowerCase(),D=x[2]||x[3]||x[4]||"";if(!D&&s[F]){D=F}if(F=="style"){if(a&&i<=6){D=D.replace(/(?!;)\s*([\w-]+):/g,function(L,M){return M.toLowerCase()+":"})}}if(D){z[F]=D.replace(/:\s*/g,":")}}}E.onTagOpen(y,z,G);if(!J&&v[y]){J=[];J._tag_name=y}continue}if((y=B[2])){E.onComment(y)}}if(A.length>C){E.onText(A.slice(C,A.length))}}return function(A,B){var y={type:"fragment",parent:null,children:[]};var z=y;function D(E){E.parent=z;z.children.push(E)}function C(F,E){var G=F;if(q[G.tag]){while(q[z.tag]&&q[z.tag][G.tag]){z=z.parent}if(z.tag==G.tag){z=z.parent}while(q[G.tag]){if(q[G.tag][z.tag]){break}G=G.parent={type:"element",tag:q[G.tag]["$"],attributes:{},children:[G]}}}if(B){while(dtd[G.tag]&&!(z.tag=="span"?utils.extend(dtd.strong,{a:1,A:1}):(dtd[z.tag]||dtd.div))[G.tag]){if(x(z)){continue}if(!z.parent){break}z=z.parent}}G.parent=z;z.children.push(G);if(E){z=F}if(F.attributes.style){F.attributes.style=F.attributes.style.toLowerCase()}return F}function x(E){var F;if(!E.children.length&&(F=t[E.tag])){C({type:"element",tag:F,attributes:{},children:[]},true);return true}return false}u(A,{onText:function(E){while(!(dtd[z.tag]||dtd.div)["#"]){if(x(z)){continue}z=z.parent}D({type:"text",data:E})},onComment:function(E){D({type:"comment",data:E})},onCDATA:function(E){while(!(dtd[z.tag]||dtd.div)["#"]){if(x(z)){continue}z=z.parent}D({type:"cdata",data:E})},onTagOpen:function(E,G,F){F=F||e[E];C({type:"element",tag:E,attributes:G,closed:F,children:[]},!F)},onTagClose:function(E){var F=z;while(F&&E!=F.tag){F=F.parent}if(F){for(var G=z;G!==F.parent;G=G.parent){x(G)}z=F.parent}else{if(!(dtd.$removeEmpty[E]||dtd.$removeEmptyBlock[E]||E=="embed")){F={type:"element",tag:E,attributes:{},children:[]};C(F,true);x(F);z=F.parent}}}});while(z!==y){x(z);z=z.parent}return y}}();var l=function(){var q={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function p(r){return q[r]}return function(r){r=r+"";return r?r.replace(/[<>"']/g,p):""}}();var f=function(){function q(A,z){var y=A.children;var B=[];for(var x=0,v;v=y[x];x++){B.push(f(v,z))}return B.join("")}function s(x){var z=[];for(var v in x){var y=x[v];if(v=="style"){y=h(y);if(/rgba?\s*\([^)]*\)/.test(y)){y=y.replace(/rgba?\s*\(([^)]*)\)/g,function(A){return utils.fixColor("color",A)})}x[v]=utils.optCss(y.replace(/windowtext/g,"#000")).replace(/white-space[^;]+;/g,"");if(!x[v]){continue}}z.push(v+'="'+l(x[v])+'"')}return z.join(" ")}function p(x,v){return v?x.data.replace(/&nbsp;/g," "):l(x.data).replace(/ /g,"&nbsp;")}var u={li:"p",h1:"p",h2:"p",h3:"p",h4:"p",h5:"p",h6:"p",tr:"p",br:"br",div:"p",p:"p"};var r={table:1,tbody:1,ol:1,ul:1,dt:1};function t(A,z){if(A.type=="element"&&!A.children.length&&(dtd.$removeEmpty[A.tag])&&A.tag!="a"&&utils.isEmptyObject(A.attributes)&&b){return y}var v=A.tag;if(z&&v=="td"){if(!y){y=""}y+=q(A,z)+"&nbsp;&nbsp;&nbsp;"}else{var x=s(A.attributes);var y=z&&r[v]?"":"<"+(z&&u[v]!==undefined?u[v]:v)+(x?" "+x:"")+(e[v]?" />":">");if(!e[v]){if(v=="p"&&!A.children.length){y+=browser.ie?"&nbsp;":"<br/>"}y+=q(A,z);y+=(z&&r[v]?"":"</"+(z&&u[v]!==undefined?u[v]:v)+">")}}return y}return function(x,v){if(x.type=="fragment"){return q(x,v)}else{if(x.type=="element"){return t(x,v)}else{if(x.type=="text"||x.type=="cdata"){return p(x,dtd.$notTransContent[x.parent.tag])}else{if(x.type=="comment"){return"<!--"+x.data+"-->"}}}}return""}}();var o={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"};function j(s,t){var v=[0,10,12,16,18,24,32,48],u,y=utils.indexOf;switch(s.tag){case"script":s.tag="div";s.attributes._ue_org_tagName="script";s.attributes._ue_div_script=1;s.attributes._ue_script_data=s.children[0]?encodeURIComponent(s.children[0].data):"";s.attributes._ue_custom_node_=1;s.children=[];break;case"style":s.tag="div";s.attributes._ue_div_style=1;s.attributes._ue_org_tagName="style";s.attributes._ue_style_data=s.children[0]?encodeURIComponent(s.children[0].data):"";s.attributes._ue_custom_node_=1;s.children=[];break;case"img":if(s.attributes.src&&/^data:/.test(s.attributes.src)){return{type:"fragment",children:[]}}if(s.attributes.src&&/^(?:file)/.test(s.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(s.attributes.src)){return{type:"fragment",children:[]}}s.attributes.word_img=s.attributes.src;s.attributes.src=k.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";var x=parseInt(s.attributes.width)<128||parseInt(s.attributes.height)<43;s.attributes.style="background:url("+(x?k.options.themePath+k.options.theme+"/images/word.gif":k.options.langPath+k.options.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd";t&&(t.flag=1)}if(browser.ie&&browser.version<7){s.attributes.orgSrc=s.attributes.src}s.attributes.data_ue_src=s.attributes.data_ue_src||s.attributes.src;break;case"li":var q=s.children[0];if(!q||q.type!="element"||q.tag!="p"&&dtd.p[q.tag]){var r={type:"element",tag:"p",attributes:{},parent:s};r.children=q?s.children:[browser.ie?{type:"text",data:domUtils.fillChar,parent:r}:{type:"element",tag:"br",attributes:{},closed:true,children:[],parent:r}];s.children=[r]}break;case"table":case"td":d(s);break;case"a":if(s.attributes.anchorname){s.tag="img";s.attributes={"class":"anchorclass",anchorname:s.attributes.name};s.closed=1}s.attributes.href&&(s.attributes.data_ue_src=s.attributes.href);break;case"b":s.tag=s.name="strong";break;case"i":s.tag=s.name="em";break;case"u":s.tag=s.name="span";s.attributes.style=(s.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":s.tag=s.name="span";s.attributes.style=(s.attributes.style||"")+";text-decoration:line-through;";if(s.children.length==1){q=s.children[0];if(q.tag==s.tag){s.attributes.style+=";"+q.attributes.style;s.children=q.children}}break;case"span":var p=s.attributes.style;if(p){if(!s.attributes.style||browser.webkit&&p=="white-space:nowrap;"){delete s.attributes.style}}if(browser.gecko&&browser.version<=10902&&s.parent){var z=s.parent;if(z.tag=="span"&&z.attributes&&z.attributes.style){s.attributes.style=z.attributes.style+";"+s.attributes.style}}if(utils.isEmptyObject(s.attributes)&&b){s.type="fragment"}break;case"font":s.tag=s.name="span";u=s.attributes;s.attributes={style:(u.size?"font-size:"+(v[u.size]||12)+"px":"")+";"+(u.color?"color:"+u.color:"")+";"+(u.face?"font-family:"+u.face:"")+";"+(u.style||"")};while(s.parent.tag==s.tag&&s.parent.children.length==1){s.attributes.style&&(s.parent.attributes.style?(s.parent.attributes.style+=";"+s.attributes.style):(s.parent.attributes.style=s.attributes.style));s.parent.children=s.children;s=s.parent}break;case"p":if(s.attributes.align){s.attributes.style=(s.attributes.style||"")+";text-align:"+s.attributes.align+";";delete s.attributes.align}}return s}function d(q){if(a&&q.attributes.style){var p=q.attributes.style;q.attributes.style=p.replace(/;\s*/g,";");q.attributes.style=q.attributes.style.replace(/^\s*|\s*$/,"")}}function m(p){switch(p.tag){case"div":if(p.attributes._ue_div_script){p.tag="script";p.children=[{type:"cdata",data:p.attributes._ue_script_data?decodeURIComponent(p.attributes._ue_script_data):"",parent:p}];delete p.attributes._ue_div_script;delete p.attributes._ue_script_data;delete p.attributes._ue_custom_node_;delete p.attributes._ue_org_tagName}if(p.attributes._ue_div_style){p.tag="style";p.children=[{type:"cdata",data:p.attributes._ue_style_data?decodeURIComponent(p.attributes._ue_style_data):"",parent:p}];delete p.attributes._ue_div_style;delete p.attributes._ue_style_data;delete p.attributes._ue_custom_node_;delete p.attributes._ue_org_tagName}break;case"table":!p.attributes.style&&delete p.attributes.style;if(a&&p.attributes.style){d(p)}break;case"td":case"th":if(/display\s*:\s*none/i.test(p.attributes.style)){return{type:"fragment",children:[]}}if(a&&!p.children.length){var q={type:"text",data:domUtils.fillChar,parent:p};p.children[0]=q}if(a&&p.attributes.style){d(p)}break;case"img":if(p.attributes.anchorname){p.tag="a";p.attributes={name:p.attributes.anchorname,anchorname:1};p.closed=null}else{if(p.attributes.data_ue_src){p.attributes.src=p.attributes.data_ue_src;delete p.attributes.data_ue_src}}break;case"a":if(p.attributes.data_ue_src){p.attributes.href=p.attributes.data_ue_src;delete p.attributes.data_ue_src}}return p}function g(v,u,p){if(!v.children||!v.children.length){return v}var t=v.children;for(var s=0;s<t.length;s++){var r=u(t[s],p);if(r.type=="fragment"){var q=[s,1];q.push.apply(q,r.children);t.splice.apply(t,q);if(!t.length){v={type:"fragment",children:[]}}s--}else{t[s]=r}}return v}function c(p){this.rules=p}c.prototype={rules:null,filter:function(r,u,t){u=u||this.rules;var q=u&&u.whiteList;var p=u&&u.blackList;function s(A,z){A.name=A.type=="element"?A.tag:o[A.type];if(z==null){return g(A,s,A)}if(p&&(p[A.name]||(A.attributes&&A.attributes._ue_org_tagName&&p[A.attributes._ue_org_tagName]))){t&&(t.flag=1);return{type:"fragment",children:[]}}if(q){if(A.type=="element"){if(z.type=="fragment"?q[A.name]:q[A.name]&&q[z.name][A.name]){var y;if((y=q[A.name].$)){var B=A.attributes;var x={};for(var v in y){if(B[v]){x[v]=B[v]}}A.attributes=x}}else{t&&(t.flag=1);A.type="fragment";A.name=z.name}}else{}}if(p||q){g(A,s,A)}return A}return s(r,null)},transformInput:function(q,p){function r(s){s=j(s,p);s=g(s,r,s);if(k.options.pageBreakTag&&s.type=="text"&&s.data.replace(/\s/g,"")==k.options.pageBreakTag){s.type="element";s.name=s.tag="hr";delete s.data;s.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"};s.children=[]}if(s.type=="text"&&!dtd.$notTransContent[s.parent.tag]){s.data=s.data.replace(/[\r\t\n]*/g,"")}return s}return r(q)},transformOutput:function(p){function q(r){if(r.tag=="hr"&&r.attributes["class"]=="pagebreak"){delete r.tag;r.type="text";r.data=k.options.pageBreakTag;delete r.children}r=m(r);r=g(r,q,r);return r}return q(p)},toHTML:f,parseHTML:n,word:UE.filterWord};k.serialize=new c(k.options.serialize||{});UE.serialize=new c({})};(function(){function c(f){f=f||{};this.indentChar=f.indentChar||"    ";this.breakChar=f.breakChar||"\n";this.selfClosingEnd=f.selfClosingEnd||" />"}var e=function(){var g={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function f(h){return g[h]}return function(h){h=h+"";return h?h.replace(/[<>"']/g,f):""}}();var d=utils.extend({a:1,A:1},dtd.$inline,true);function b(g){var h=[];for(var f in g){h.push(f+'="'+e(g[f])+'"')}return h.join(" ")}c.prototype={format:function(f){var g=UE.serialize.parseHTML(f);this.buff=[];this.indents="";this.indenting=1;this.visitNode(g);return this.buff.join("")},visitNode:function(g){if(g.type=="fragment"){this.visitChildren(g.children)}else{if(g.type=="element"){var f=dtd.$empty[g.tag];this.visitTag(g.tag,g.attributes,f);this.visitChildren(g.children);if(!f){this.visitEndTag(g.tag)}}else{if(g.type=="comment"){this.visitComment(g.data)}else{this.visitText(g.data,dtd.$notTransContent[g.parent.tag])}}}},visitChildren:function(g){for(var f=0;f<g.length;f++){this.visitNode(g[f])}},visitTag:function(f,h,g){if(this.indenting){this.indent()}else{if(!d[f]){this.newline();this.indent()}}this.buff.push("<",f);var i=b(h);if(i){this.buff.push(" ",i)}if(g){this.buff.push(this.selfClosingEnd);if(f=="br"){this.newline()}}else{this.buff.push(">");this.indents+=this.indentChar}if(!d[f]){this.newline()}},indent:function(){this.buff.push(this.indents);this.indenting=0},newline:function(){this.buff.push(this.breakChar);this.indenting=1},visitEndTag:function(f){this.indents=this.indents.slice(0,-this.indentChar.length);if(this.indenting){this.indent()}else{if(!d[f]){this.newline();this.indent()}}this.buff.push("</",f,">")},visitText:function(g,f){if(this.indenting){this.indent()}g=g.replace(/&nbsp;/g," ");this.buff.push(g)},visitComment:function(f){if(this.indenting){this.indent()}this.buff.push("<!--",f,"-->")}};var a={textarea:function(h,g){var f=g.ownerDocument.createElement("textarea");f.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";if(browser.ie&&browser.version<8){f.style.width=g.offsetWidth+"px";f.style.height=g.offsetHeight+"px";g.onresize=function(){f.style.width=g.offsetWidth+"px";f.style.height=g.offsetHeight+"px"}}g.appendChild(f);return{setContent:function(i){f.value=i},getContent:function(){return f.value},select:function(){var i;if(browser.ie){i=f.createTextRange();i.collapse(true);i.select()}else{f.setSelectionRange(0,0);f.focus()}},dispose:function(){g.removeChild(f);g.onresize=null;f=null;g=null}}},codemirror:function(h,g){var f=window.CodeMirror(g,{mode:"text/html",tabMode:"indent",lineNumbers:true,lineWrapping:true});var i=f.getWrapperElement();i.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';f.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";f.refresh();return{getCodeMirror:function(){return f},setContent:function(j){f.setValue(j)},getContent:function(){return f.getValue()},select:function(){f.focus()},dispose:function(){g.removeChild(i);i=null;f=null}}}};UE.plugins.source=function(){var k=this;var f=this.options;var m=new c(f.source);var j=false;var n;f.sourceEditor=browser.ie?"textarea":(f.sourceEditor||"codemirror");k.setOpt({sourceEditorFirst:false});function g(p){return a[f.sourceEditor=="codemirror"&&window.CodeMirror?"codemirror":"textarea"](k,p)}var o;var l=k.getContent,i;k.commands.source={execCommand:function(){j=!j;if(j){i=k.selection.getRange().createAddress(false,true);k.undoManger&&k.undoManger.save(true);if(browser.gecko){k.body.contentEditable=false}o=k.iframe.style.cssText;k.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";var r=m.format(k.hasContents()?k.getContent():"");n=g(k.iframe.parentNode);n.setContent(r);setTimeout(function(){n.select();k.addListener("fullscreenchanged",function(){try{n.getCodeMirror().refresh()}catch(u){}})});k.getContent=function(){var u=n.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";return u.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><")}}else{k.iframe.style.cssText=o;var p=n.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";p=p.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");k.setContent(p);n.dispose();n=null;k.getContent=l;var t=k.body.firstChild;if(!t){k.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";t=k.body.firstChild}k.undoManger&&k.undoManger.save(true);if(browser.gecko){var q=document.createElement("input");q.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(q);k.body.contentEditable=false;setTimeout(function(){domUtils.setViewportOffset(q,{left:-32768,top:0});q.focus();setTimeout(function(){k.body.contentEditable=true;k.selection.getRange().moveToAddress(i).select();domUtils.remove(q)})})}else{try{k.selection.getRange().moveToAddress(i).select()}catch(s){}}}this.fireEvent("sourcemodechanged",j)},queryCommandState:function(){return j|0},notNeedUndo:1};var h=k.queryCommandState;k.queryCommandState=function(p){p=p.toLowerCase();if(j){return p in {source:1,fullscreen:1}?1:-1}return h.apply(this,arguments)};if(f.sourceEditor=="codemirror"){k.addListener("ready",function(){utils.loadFile(document,{src:f.codeMirrorJsUrl||f.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){if(f.sourceEditorFirst){setTimeout(function(){k.execCommand("source")},0)}});utils.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:f.codeMirrorCssUrl||f.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}}})();UE.plugins.autofloat=function(){var r=this,s=r.getLang();r.setOpt({topOffset:0});var m=r.options.autoFloatEnabled!==false,k=r.options.topOffset;if(!m){return}var f=UE.ui.uiUtils,g=browser.ie&&browser.version<=6,l=browser.quirks;function a(t){if(!t.ui){alert(s.autofloatMsg);return 0}return 1}function h(){var t=document.body.style;t.backgroundImage='url("about:blank")';t.backgroundAttachment="fixed"}var i,n=document.createElement("div"),d,c,q,o=true;function j(){var u=domUtils.getXY(d),t=domUtils.getComputedStyle(d,"position"),v=domUtils.getComputedStyle(d,"left");d.style.width=d.offsetWidth+"px";d.style.zIndex=r.options.zIndex*1+1;d.parentNode.insertBefore(n,d);if(g||(l&&browser.ie)){if(d.style.position!="absolute"){d.style.position="absolute"}d.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-c+k+"px"}else{if(browser.ie7Compat&&o){o=false;d.style.left=domUtils.getXY(d).x-document.documentElement.getBoundingClientRect().left+2+"px"}if(d.style.position!="fixed"){d.style.position="fixed";d.style.top=k+"px";((t=="absolute"||t=="relative")&&parseFloat(v))&&(d.style.left=u.x+"px")}}}function e(){o=true;if(n.parentNode){n.parentNode.removeChild(n)}d.style.cssText=i}function b(){var t=q(r.container);if(t.top<0&&t.bottom-d.offsetHeight>0){j()}else{e()}}var p=utils.defer(function(){b()},browser.ie?200:100,true);r.addListener("destroy",function(){domUtils.un(window,["scroll","resize"],b);r.removeListener("keydown",p)});r.addListener("ready",function(){if(a(r)){q=f.getClientRect;d=r.ui.getDom("toolbarbox");c=q(d).top;i=d.style.cssText;n.style.height=d.offsetHeight+"px";if(g){h()}domUtils.on(window,["scroll","resize"],b);r.addListener("keydown",p);r.addListener("beforefullscreenchange",function(v,u){if(u){e()}});r.addListener("fullscreenchanged",function(v,u){if(!u){b()}});r.addListener("sourcemodechanged",function(v,u){setTimeout(function(){b()},0)});r.addListener("clearDoc",function(){setTimeout(function(){b()},0)})}})};UE.plugins.autoheight=function(){var h=this;h.autoHeightEnabled=h.options.autoHeightEnabled!==false;if(!h.autoHeightEnabled){return}var f,i,d,g=0,j=h.options,b,a;function c(){var k=this;clearTimeout(a);if(e){return}a=setTimeout(function(){if(k.queryCommandState&&k.queryCommandState("source")!=1){if(!i){i=k.document.createElement("span");i.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;";i.innerHTML="."}d=i.cloneNode(true);k.body.appendChild(d);b=Math.max(domUtils.getXY(d).y+d.offsetHeight,Math.max(j.minFrameHeight,j.initialFrameHeight));if(b!=g){k.setHeight(b);g=b}domUtils.remove(d)}},50)}var e;h.addListener("fullscreenchanged",function(l,k){e=k});h.addListener("destroy",function(){h.removeListener("contentchange",c);h.removeListener("afterinserthtml",c);h.removeListener("keyup",c);h.removeListener("mouseup",c)});h.enableAutoHeight=function(){if(!h.autoHeightEnabled){return}var k=h.document;h.autoHeightEnabled=true;f=k.body.style.overflowY;k.body.style.overflowY="hidden";h.addListener("contentchange",c);h.addListener("afterinserthtml",c);h.addListener("keyup",c);h.addListener("mouseup",c);setTimeout(function(){c.call(this)},browser.gecko?100:0);h.fireEvent("autoheightchanged",h.autoHeightEnabled)};h.disableAutoHeight=function(){h.body.style.overflowY=f||"";h.removeListener("contentchange",c);h.removeListener("keyup",c);h.removeListener("mouseup",c);h.autoHeightEnabled=false;h.fireEvent("autoheightchanged",h.autoHeightEnabled)};h.addListener("ready",function(){h.enableAutoHeight();var k;domUtils.on(browser.ie?h.body:h.document,browser.webkit?"dragover":"drop",function(){clearTimeout(k);k=setTimeout(function(){c.call(this)},100)})})};UE.plugins.wordcount=function(){var a=this;a.addListener("contentchange",function(){a.fireEvent("wordcount")});var b;a.addListener("keyup",function(){clearTimeout(b);var c=this;b=setTimeout(function(){c.fireEvent("wordcount")},200)})};UE.commands.insertparagraph={execCommand:function(b,e){var d=this,a=d.selection.getRange(),g=a.startContainer,c;while(g){if(domUtils.isBody(g)){break}c=g;g=g.parentNode}if(c){var f=d.document.createElement("p");if(e){c.parentNode.insertBefore(f,c)}else{c.parentNode.insertBefore(f,c.nextSibling)}domUtils.fillNode(d.document,f);a.setStart(f,0).setCursor(false,true)}}};